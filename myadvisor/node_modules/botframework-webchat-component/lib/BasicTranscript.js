"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _reactScrollToBottom = require("react-scroll-to-bottom");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _mathRandom = _interopRequireDefault(require("math-random"));

var _react = _interopRequireWildcard(require("react"));

var _BasicTypingIndicator = _interopRequireDefault(require("./BasicTypingIndicator"));

var _Fade = _interopRequireDefault(require("./Utils/Fade"));

var _FocusRedirector = _interopRequireDefault(require("./Utils/FocusRedirector"));

var _getActivityUniqueId = _interopRequireDefault(require("./Utils/getActivityUniqueId"));

var _getTabIndex = _interopRequireDefault(require("./Utils/TypeFocusSink/getTabIndex"));

var _inputtableKey = _interopRequireDefault(require("./Utils/TypeFocusSink/inputtableKey"));

var _intersectionOf = _interopRequireDefault(require("./Utils/intersectionOf"));

var _isZeroOrPositive = _interopRequireDefault(require("./Utils/isZeroOrPositive"));

var _removeInline = _interopRequireDefault(require("./Utils/removeInline"));

var _ScreenReaderActivity = _interopRequireDefault(require("./ScreenReaderActivity"));

var _ScreenReaderText = _interopRequireDefault(require("./ScreenReaderText"));

var _ScrollToEndButton = _interopRequireDefault(require("./Activity/ScrollToEndButton"));

var _Speak = _interopRequireDefault(require("./Activity/Speak"));

var _tabbableElements = _interopRequireDefault(require("./Utils/tabbableElements"));

var _useAcknowledgedActivity = _interopRequireDefault(require("./hooks/internal/useAcknowledgedActivity"));

var _useDispatchScrollPosition = _interopRequireDefault(require("./hooks/internal/useDispatchScrollPosition"));

var _useDispatchTranscriptFocus = _interopRequireDefault(require("./hooks/internal/useDispatchTranscriptFocus"));

var _useFocus = _interopRequireDefault(require("./hooks/useFocus"));

var _useMemoize = _interopRequireDefault(require("./hooks/internal/useMemoize"));

var _useRegisterFocusTranscript = _interopRequireDefault(require("./hooks/internal/useRegisterFocusTranscript"));

var _useRegisterScrollRelative = _interopRequireDefault(require("./hooks/internal/useRegisterScrollRelative"));

var _useRegisterScrollTo = _interopRequireDefault(require("./hooks/internal/useRegisterScrollTo"));

var _useRegisterScrollToEnd = _interopRequireDefault(require("./hooks/internal/useRegisterScrollToEnd"));

var _useStyleSet5 = _interopRequireDefault(require("./hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("./hooks/internal/useStyleToEmotionObject"));

var _useUniqueId = _interopRequireDefault(require("./hooks/internal/useUniqueId"));

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }

function _nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _iterableToArray(iter) { if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter); }

function _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useActivities = _botframeworkWebchatApi.hooks.useActivities,
    useCreateActivityRenderer = _botframeworkWebchatApi.hooks.useCreateActivityRenderer,
    useCreateActivityStatusRenderer = _botframeworkWebchatApi.hooks.useCreateActivityStatusRenderer,
    useCreateAvatarRenderer = _botframeworkWebchatApi.hooks.useCreateAvatarRenderer,
    useDirection = _botframeworkWebchatApi.hooks.useDirection,
    useGroupActivities = _botframeworkWebchatApi.hooks.useGroupActivities,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__basic-transcript': {
    display: 'flex',
    flexDirection: 'column',
    overflow: 'hidden',
    // Make sure to set "position: relative" here to form another stacking context for the scroll-to-end button.
    // Stacking context help isolating elements that use "z-index" from global pollution.
    // https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context
    position: 'relative',
    '& .webchat__basic-transcript__filler': {
      flex: 1
    },
    '& .webchat__basic-transcript__scrollable': {
      display: 'flex',
      flexDirection: 'column',
      overflowX: 'hidden',
      WebkitOverflowScrolling: 'touch'
    },
    '& .webchat__basic-transcript__transcript': {
      listStyleType: 'none'
    }
  }
};

function validateAllActivitiesTagged(activities, bins) {
  return activities.every(function (activity) {
    return bins.some(function (bin) {
      return bin.includes(activity);
    });
  });
}

var InternalTranscript = function InternalTranscript(_ref) {
  var activityElementsRef = _ref.activityElementsRef,
      className = _ref.className;

  var _useStyleSet = (0, _useStyleSet5.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      basicTranscriptStyleSet = _useStyleSet2[0].basicTranscript;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      _useStyleOptions2$ = _useStyleOptions2[0],
      bubbleFromUserNubOffset = _useStyleOptions2$.bubbleFromUserNubOffset,
      bubbleNubOffset = _useStyleOptions2$.bubbleNubOffset,
      groupTimestamp = _useStyleOptions2$.groupTimestamp,
      internalLiveRegionFadeAfter = _useStyleOptions2$.internalLiveRegionFadeAfter,
      showAvatarInGroup = _useStyleOptions2$.showAvatarInGroup;

  var _useState = (0, _react.useState)(),
      _useState2 = _slicedToArray(_useState, 2),
      focusedActivityKey = _useState2[0],
      setFocusedActivityKey = _useState2[1];

  var _useActivities = useActivities(),
      _useActivities2 = _slicedToArray(_useActivities, 1),
      activities = _useActivities2[0];

  var _useDirection = useDirection(),
      _useDirection2 = _slicedToArray(_useDirection, 1),
      direction = _useDirection2[0];

  var createActivityRenderer = useCreateActivityRenderer();
  var createActivityStatusRenderer = useCreateActivityStatusRenderer();
  var createAvatarRenderer = useCreateAvatarRenderer();
  var focus = (0, _useFocus.default)();
  var groupActivities = useGroupActivities();
  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var rootElementRef = (0, _react.useRef)();
  var terminatorRef = (0, _react.useRef)();
  var activityInteractiveAlt = localize('ACTIVITY_INTERACTIVE_LABEL_ALT');
  var terminatorText = localize('TRANSCRIPT_TERMINATOR_TEXT');
  var transcriptAriaLabel = localize('TRANSCRIPT_ARIA_LABEL_ALT');
  var transcriptRoleDescription = localize('TRANSCRIPT_ARIA_ROLE_ALT');
  var hideAllTimestamps = groupTimestamp === false; // Gets renderer for every activity.
  // Activities that are not visible will return a falsy renderer.
  // Converted from createActivityRenderer({ activity, nextVisibleActivity }) to createActivityRenderer(activity, nextVisibleActivity).
  // This is for the memoization function to cache the arguments. Memoizer can only cache literal arguments.

  var createActivityRendererWithLiteralArgs = (0, _react.useCallback)(function (activity, nextVisibleActivity) {
    return createActivityRenderer({
      activity: activity,
      nextVisibleActivity: nextVisibleActivity
    });
  }, [createActivityRenderer]); // Create a memoized context of the createActivityRenderer function.

  var activitiesWithRenderer = (0, _useMemoize.default)(createActivityRendererWithLiteralArgs, function (createActivityRendererWithLiteralArgsMemoized) {
    // All calls to createActivityRendererWithLiteralArgsMemoized() in this function will be memoized (LRU = 1).
    // In the next render cycle, calls to createActivityRendererWithLiteralArgsMemoized() might return the memoized result instead.
    // This is an improvement to React useMemo(), because it only allows 1 memoization.
    // useMemoize() allows any number of memoization.
    var activitiesWithRenderer = [];
    var nextVisibleActivity;

    for (var index = activities.length - 1; index >= 0; index--) {
      var activity = activities[index];
      var renderActivity = createActivityRendererWithLiteralArgsMemoized(activity, nextVisibleActivity);

      if (renderActivity) {
        activitiesWithRenderer.splice(0, 0, {
          activity: activity,
          renderActivity: renderActivity
        });
        nextVisibleActivity = activity;
      }
    }

    return activitiesWithRenderer;
  }, [activities]);
  var visibleActivities = (0, _react.useMemo)(function () {
    return activitiesWithRenderer.map(function (_ref2) {
      var activity = _ref2.activity;
      return activity;
    });
  }, [activitiesWithRenderer]); // Tag activities based on types.
  // The default implementation tag into 2 types: sender and status.

  var _useMemo = (0, _react.useMemo)(function () {
    var _groupActivities = groupActivities({
      activities: visibleActivities
    }),
        activitiesGroupBySender = _groupActivities.sender,
        activitiesGroupByStatus = _groupActivities.status;

    if (!validateAllActivitiesTagged(visibleActivities, activitiesGroupBySender)) {
      console.warn('botframework-webchat: Not every activities are grouped in the "sender" property. Please fix "groupActivitiesMiddleware" and group every activities.');
    }

    if (!validateAllActivitiesTagged(visibleActivities, activitiesGroupByStatus)) {
      console.warn('botframework-webchat: Not every activities are grouped in the "status" property. Please fix "groupActivitiesMiddleware" and group every activities.');
    }

    return {
      activitiesGroupBySender: activitiesGroupBySender,
      activitiesGroupByStatus: activitiesGroupByStatus
    };
  }, [groupActivities, visibleActivities]),
      activitiesGroupBySender = _useMemo.activitiesGroupBySender,
      activitiesGroupByStatus = _useMemo.activitiesGroupByStatus; // Create a tree of activities with 2 dimensions: sender, followed by status.


  var activityTree = (0, _react.useMemo)(function () {
    var visibleActivitiesPendingGrouping = _toConsumableArray(visibleActivities);

    var activityTree = [];

    var _loop = function _loop() {
      var _visibleActivitiesPen = _slicedToArray(visibleActivitiesPendingGrouping, 1),
          activity = _visibleActivitiesPen[0];

      var senderTree = [];
      var activitiesWithSameSender = activitiesGroupBySender.find(function (activities) {
        return activities.includes(activity);
      });
      activityTree.push(senderTree);
      activitiesWithSameSender.forEach(function (activity) {
        var activitiesWithSameStatus = activitiesGroupByStatus.find(function (activities) {
          return activities.includes(activity);
        });
        var activitiesWithSameSenderAndStatus = (0, _intersectionOf.default)(visibleActivitiesPendingGrouping, activitiesWithSameSender, activitiesWithSameStatus);

        if (activitiesWithSameSenderAndStatus.length) {
          senderTree.push(activitiesWithSameSenderAndStatus);

          _removeInline.default.apply(void 0, [visibleActivitiesPendingGrouping].concat(_toConsumableArray(activitiesWithSameSenderAndStatus)));
        }
      });
    };

    while (visibleActivitiesPendingGrouping.length) {
      _loop();
    } // Assertion: All activities in visibleActivities, must be assigned to the activityTree


    if (!visibleActivities.every(function (activity) {
      return activityTree.some(function (activitiesWithSameSender) {
        return activitiesWithSameSender.some(function (activitiesWithSameSenderAndStatus) {
          return activitiesWithSameSenderAndStatus.includes(activity);
        });
      });
    })) {
      console.warn('botframework-webchat internal: Not all visible activities are grouped in the activityTree.', {
        visibleActivities: visibleActivities,
        activityTree: activityTree
      });
    }

    return activityTree;
  }, [activitiesGroupBySender, activitiesGroupByStatus, visibleActivities]); // Flatten the tree back into an array with information related to rendering.

  var renderingElements = (0, _react.useMemo)(function () {
    var renderingElements = [];
    var topSideBotNub = (0, _isZeroOrPositive.default)(bubbleNubOffset);
    var topSideUserNub = (0, _isZeroOrPositive.default)(bubbleFromUserNubOffset);
    activityTree.forEach(function (activitiesWithSameSender) {
      var _activitiesWithSameSe = _slicedToArray(activitiesWithSameSender, 1),
          _activitiesWithSameSe2 = _slicedToArray(_activitiesWithSameSe[0], 1),
          firstActivity = _activitiesWithSameSe2[0];

      var renderAvatar = createAvatarRenderer({
        activity: firstActivity
      });
      activitiesWithSameSender.forEach(function (activitiesWithSameSenderAndStatus, indexWithinSenderGroup) {
        var firstInSenderGroup = !indexWithinSenderGroup;
        var lastInSenderGroup = indexWithinSenderGroup === activitiesWithSameSender.length - 1;
        activitiesWithSameSenderAndStatus.forEach(function (activity, indexWithinSenderAndStatusGroup) {
          // We only show the timestamp at the end of the sender group. But we always show the "Send failed, retry" prompt.
          var renderActivityStatus = createActivityStatusRenderer({
            activity: activity
          });
          var firstInSenderAndStatusGroup = !indexWithinSenderAndStatusGroup;
          var lastInSenderAndStatusGroup = indexWithinSenderAndStatusGroup === activitiesWithSameSenderAndStatus.length - 1;

          var _activitiesWithRender = activitiesWithRenderer.find(function (entry) {
            return entry.activity === activity;
          }),
              renderActivity = _activitiesWithRender.renderActivity;

          var key = (0, _getActivityUniqueId.default)(activity) || renderingElements.length;
          var _activity$channelData = activity.channelData;
          _activity$channelData = _activity$channelData === void 0 ? {} : _activity$channelData;
          var _activity$channelData2 = _activity$channelData.messageBack;
          _activity$channelData2 = _activity$channelData2 === void 0 ? {} : _activity$channelData2;
          var messageBackDisplayText = _activity$channelData2.displayText,
              role = activity.from.role,
              text = activity.text;
          var topSideNub = role === 'user' ? topSideUserNub : topSideBotNub;
          var showCallout; // Depending on the "showAvatarInGroup" setting, the avatar will render in different positions.

          if (showAvatarInGroup === 'sender') {
            if (topSideNub) {
              showCallout = firstInSenderGroup && firstInSenderAndStatusGroup;
            } else {
              showCallout = lastInSenderGroup && lastInSenderAndStatusGroup;
            }
          } else if (showAvatarInGroup === 'status') {
            if (topSideNub) {
              showCallout = firstInSenderAndStatusGroup;
            } else {
              showCallout = lastInSenderAndStatusGroup;
            }
          } else {
            showCallout = true;
          }

          var focusActivity = function focusActivity() {
            setFocusedActivityKey((0, _getActivityUniqueId.default)(activity)); // IE11 need to manually focus on the transcript.

            var rootElement = rootElementRef.current;
            rootElement && rootElement.focus();
          };

          renderingElements.push({
            activity: activity,
            // After the element is mounted, set it to activityElementsRef.
            callbackRef: function callbackRef(activityElement) {
              var entry = activityElementsRef.current.find(function (_ref3) {
                var activityID = _ref3.activityID;
                return activityID === activity.id;
              });

              if (entry) {
                entry.element = activityElement;
              }
            },
            // Calling this function will put the focus on the transcript and the activity.
            focusActivity: focusActivity,
            // When a child of the activity receives focus, notify the transcript to set the aria-activedescendant to this activity.
            handleFocus: function handleFocus() {
              setFocusedActivityKey((0, _getActivityUniqueId.default)(activity));
            },
            handleKeyDown: function handleKeyDown(event) {
              if (event.key === 'Escape') {
                event.preventDefault();
                event.stopPropagation();
                setFocusedActivityKey((0, _getActivityUniqueId.default)(activity));
                var current = rootElementRef.current;
                current && current.focus();
              }
            },
            // For accessibility: when the user press up/down arrow keys, we put a visual focus indicator around the focused activity.
            // We should do the same for mouse, that is why we have the click handler here.
            // We are doing it in event capture phase to prevent other components from stopping event propagation to us.
            handleMouseDownCapture: function handleMouseDownCapture(_ref4) {
              var target = _ref4.target;
              var tabIndex = (0, _getTabIndex.default)(target);

              if (typeof tabIndex !== 'number' || tabIndex < 0 || target.getAttribute('aria-disabled') === 'true') {
                focusActivity();
              }
            },
            // "hideTimestamp" is a render-time parameter for renderActivityStatus().
            // If true, it will hide the timestamp, but it will continue to show the
            // retry prompt. And show the screen reader version of the timestamp.
            hideTimestamp: hideAllTimestamps || indexWithinSenderAndStatusGroup !== activitiesWithSameSenderAndStatus.length - 1,
            key: key,
            // When "liveRegionKey" changes, it will show up in the live region momentarily.
            liveRegionKey: key + '|' + (messageBackDisplayText || text),
            renderActivity: renderActivity,
            renderActivityStatus: renderActivityStatus,
            renderAvatar: renderAvatar,
            role: role,
            // TODO: [P2] #2858 We should use core/definitions/speakingActivity for this predicate instead
            shouldSpeak: activity.channelData && activity.channelData.speak,
            showCallout: showCallout
          });
        });
      });
    });
    var activityElements = activityElementsRef.current; // Update activityElementRef with new sets of activity, while retaining the existing referencing element if exists.

    activityElementsRef.current = renderingElements.map(function (_ref5) {
      var activity = _ref5.activity,
          id = _ref5.activity.id,
          elementId = _ref5.elementId,
          key = _ref5.key;
      var existingEntry = activityElements.find(function (entry) {
        return entry.key === key;
      });
      return {
        activity: activity,
        activityID: id,
        ariaLabelID: existingEntry ? existingEntry.ariaLabelID : "webchat__basic-transcript__activity-label-".concat((0, _mathRandom.default)().toString(36).substr(2, 5)),
        element: existingEntry && existingEntry.element,
        elementId: elementId,
        key: key
      };
    }); // There must be one focused (a.k.a. aria-activedescendant) designated. We default it to the last one.

    if (!renderingElements.find(function (_ref6) {
      var focused = _ref6.focused;
      return focused;
    })) {
      var lastElement = renderingElements[renderingElements.length - 1];

      if (lastElement) {
        lastElement.focused = true;
      }
    }

    return renderingElements;
  }, [activitiesWithRenderer, activityElementsRef, activityTree, bubbleFromUserNubOffset, bubbleNubOffset, createActivityStatusRenderer, createAvatarRenderer, hideAllTimestamps, rootElementRef, showAvatarInGroup]);
  var renderingActivities = (0, _react.useMemo)(function () {
    return renderingElements.map(function (_ref7) {
      var activity = _ref7.activity;
      return activity;
    });
  }, [renderingElements]);
  var scrollToBottomScrollTo = (0, _reactScrollToBottom.useScrollTo)();
  var scrollToBottomScrollToEnd = (0, _reactScrollToBottom.useScrollToEnd)();
  var scrollTo = (0, _react.useCallback)(function (position) {
    var _ref8 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        _ref8$behavior = _ref8.behavior,
        behavior = _ref8$behavior === void 0 ? 'auto' : _ref8$behavior;

    if (!position) {
      throw new Error('botframework-webchat: First argument passed to "useScrollTo" must be a ScrollPosition object.');
    }

    var activityID = position.activityID,
        scrollTop = position.scrollTop;

    if (typeof scrollTop !== 'undefined') {
      scrollToBottomScrollTo(scrollTop, {
        behavior: behavior
      });
    } else if (typeof activityID !== 'undefined') {
      var rootElement = rootElementRef.current;

      var _ref9 = activityElementsRef.current.find(function (entry) {
        return entry.activityID === activityID;
      }) || {},
          activityElement = _ref9.element;

      var scrollableElement = rootElement.querySelector('.webchat__basic-transcript__scrollable');

      if (scrollableElement && activityElement) {
        var _activityElement$getC = activityElement.getClientRects(),
            _activityElement$getC2 = _slicedToArray(_activityElement$getC, 1),
            _activityElement$getC3 = _activityElement$getC2[0],
            activityElementHeight = _activityElement$getC3.height,
            activityElementY = _activityElement$getC3.y;

        var _scrollableElement$ge = scrollableElement.getClientRects(),
            _scrollableElement$ge2 = _slicedToArray(_scrollableElement$ge, 1),
            scrollableHeight = _scrollableElement$ge2[0].height;

        var activityElementOffsetTop = activityElementY + scrollableElement.scrollTop;

        var _scrollTop = Math.min(activityElementOffsetTop, activityElementOffsetTop - scrollableHeight + activityElementHeight);

        scrollToBottomScrollTo(_scrollTop, {
          behavior: behavior
        });
      }
    }
  }, [activityElementsRef, rootElementRef, scrollToBottomScrollTo]);
  var scrollRelative = (0, _react.useCallback)(function (direction) {
    var _ref10 = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},
        displacement = _ref10.displacement;

    var rootElement = rootElementRef.current;

    if (!rootElement) {
      return;
    }

    var scrollable = rootElement.querySelector('.webchat__basic-transcript__scrollable');
    var nextScrollTop;

    if (typeof displacement === 'number') {
      nextScrollTop = scrollable.scrollTop + (direction === 'down' ? 1 : -1) * displacement;
    } else {
      nextScrollTop = scrollable.scrollTop + (direction === 'down' ? 1 : -1) * scrollable.offsetHeight;
    }

    scrollTo({
      scrollTop: Math.max(0, Math.min(scrollable.scrollHeight - scrollable.offsetHeight, nextScrollTop))
    }, {
      behavior: 'smooth'
    });
  }, [rootElementRef, scrollTo]); // Since there could be multiple instances of <BasicTranscript> inside the <Composer>, when the developer calls `scrollXXX`, we need to call it on all instances.
  // We call `useRegisterScrollXXX` to register a callback function, the `useScrollXXX` will multiplex the call into each instance of <BasicTranscript>.

  (0, _useRegisterScrollTo.default)(scrollTo);
  (0, _useRegisterScrollToEnd.default)(scrollToBottomScrollToEnd);
  (0, _useRegisterScrollRelative.default)(scrollRelative);
  var dispatchScrollPosition = (0, _useDispatchScrollPosition.default)();
  var patchedDispatchScrollPosition = (0, _react.useMemo)(function () {
    if (!dispatchScrollPosition) {
      return;
    }

    return function (_ref11) {
      var scrollTop = _ref11.scrollTop;
      var rootElement = rootElementRef.current;

      if (!rootElement) {
        return;
      }

      var scrollableElement = rootElement.querySelector('.webchat__basic-transcript__scrollable');

      var _scrollableElement$ge3 = scrollableElement.getClientRects(),
          _scrollableElement$ge4 = _slicedToArray(_scrollableElement$ge3, 1),
          _scrollableElement$ge5 = _scrollableElement$ge4[0];

      _scrollableElement$ge5 = _scrollableElement$ge5 === void 0 ? {} : _scrollableElement$ge5;
      var offsetHeight = _scrollableElement$ge5.height; // Find the activity just above scroll view bottom.
      // If the scroll view is already on top, get the first activity.

      var entry = scrollableElement.scrollTop ? _toConsumableArray(activityElementsRef.current).reverse().find(function (_ref12) {
        var element = _ref12.element;

        if (!element) {
          return false;
        }

        var _element$getClientRec = element.getClientRects(),
            _element$getClientRec2 = _slicedToArray(_element$getClientRec, 1),
            _element$getClientRec3 = _element$getClientRec2[0];

        _element$getClientRec3 = _element$getClientRec3 === void 0 ? {} : _element$getClientRec3;
        var y = _element$getClientRec3.y;
        return y < offsetHeight;
      }) : activityElementsRef.current[0];

      var _ref13 = entry || {},
          activityID = _ref13.activityID;

      dispatchScrollPosition(_objectSpread(_objectSpread({}, activityID ? {
        activityID: activityID
      } : {}), {}, {
        scrollTop: scrollTop
      }));
    };
  }, [activityElementsRef, dispatchScrollPosition, rootElementRef]);
  (0, _reactScrollToBottom.useObserveScrollPosition)(patchedDispatchScrollPosition);

  var _useAcknowledgedActiv = (0, _useAcknowledgedActivity.default)(),
      _useAcknowledgedActiv2 = _slicedToArray(_useAcknowledgedActiv, 1),
      lastInteractedActivity = _useAcknowledgedActiv2[0];

  var indexOfLastInteractedActivity = activities.indexOf(lastInteractedActivity); // Create a new ID for aria-activedescendant every time the active descendant change.
  // In our design, the transcript will only have 1 focused activity and it has an ID. Other blurred activities will not have ID assigned.
  // This help with performance.
  // But browser usually do noop if the value of aria-activedescendant doesn't change.
  // That means, if we assign the same ID to another element, browser will do noop.
  // We need to generate a new ID so the browser see there is a change in aria-activedescendant value and perform accordingly.

  var activeDescendantElementId = (0, _react.useMemo)(function () {
    return focusedActivityKey && "webchat__basic-transcript__active-descendant-".concat((0, _mathRandom.default)().toString(36).substr(2, 5));
  }, [focusedActivityKey]);
  var scrollActiveDescendantIntoView = (0, _react.useCallback)(function () {
    var activeDescendant = activeDescendantElementId && document.getElementById(activeDescendantElementId); // Don't scroll active descendant into view if the focus is already inside it.
    // Otherwise, given the focus is on the send box, clicking on any <input> inside the Adaptive Cards may cause the view to move.
    // This UX is not desirable because click should not cause scroll.

    if (activeDescendant && !activeDescendant.contains(document.activeElement)) {
      // Checks if scrollIntoView support options or not.
      // - https://github.com/Modernizr/Modernizr/issues/1568#issuecomment-419457972
      // - https://stackoverflow.com/questions/46919627/is-it-possible-to-test-for-scrollintoview-browser-compatibility
      if ('scrollBehavior' in document.documentElement.style) {
        activeDescendant.scrollIntoView({
          block: 'nearest'
        });
      } else {
        // This is for browser that does not support options passed to scrollIntoView(), possibly IE11.
        var scrollableElement = rootElementRef.current.querySelector('.webchat__basic-transcript__scrollable');
        var scrollTopAtTopSide = activeDescendant.offsetTop;
        var scrollTopAtBottomSide = activeDescendant.offsetTop + activeDescendant.offsetHeight;

        if (scrollTopAtTopSide < scrollableElement.scrollTop) {
          scrollableElement.scrollTop = scrollTopAtTopSide;
        } else if (scrollTopAtBottomSide > scrollableElement.scrollTop + scrollableElement.offsetHeight) {
          scrollableElement.scrollTop = scrollTopAtBottomSide - scrollableElement.offsetHeight;
        }
      }
    }
  }, [activeDescendantElementId, rootElementRef]);
  var handleTranscriptFocus = (0, _react.useCallback)(function (event) {
    var currentTarget = event.currentTarget,
        target = event.target; // When focus is placed on the transcript, scroll active descendant into the view.

    currentTarget === target && scrollActiveDescendantIntoView();
  }, [scrollActiveDescendantIntoView]); // After new aria-activedescendant is assigned, we will need to scroll it into view.
  // User agent will scroll automatically for focusing element, but not for aria-activedescendant.
  // We need to do the scrolling manually.

  (0, _react.useEffect)(function () {
    return scrollActiveDescendantIntoView();
  }, [scrollActiveDescendantIntoView]); // If any activities has changed, reset the active descendant.

  (0, _react.useEffect)(function () {
    return setFocusedActivityKey(undefined);
  }, [activities, setFocusedActivityKey]);
  var focusRelativeActivity = (0, _react.useCallback)(function (delta) {
    if (isNaN(delta) || !renderingElements.length) {
      return setFocusedActivityKey(undefined);
    }

    var index = renderingElements.findIndex(function (_ref14) {
      var key = _ref14.key;
      return key === focusedActivityKey;
    });
    var nextIndex = ~index ? Math.max(0, Math.min(renderingElements.length - 1, index + delta)) : renderingElements.length - 1;
    var nextFocusedActivity = renderingElements[nextIndex];
    setFocusedActivityKey(nextFocusedActivity.key);
    rootElementRef.current && rootElementRef.current.focus();
  }, [focusedActivityKey, renderingElements, rootElementRef, setFocusedActivityKey]);
  var handleTranscriptKeyDown = (0, _react.useCallback)(function (event) {
    var target = event.target;
    var fromEndOfTranscriptIndicator = target === terminatorRef.current;
    var fromTranscript = target === event.currentTarget;

    if (!fromEndOfTranscriptIndicator && !fromTranscript) {
      return;
    }

    var handled = true;

    switch (event.key) {
      case 'ArrowDown':
        focusRelativeActivity(fromEndOfTranscriptIndicator ? 0 : 1);
        break;

      case 'ArrowUp':
        focusRelativeActivity(fromEndOfTranscriptIndicator ? 0 : -1);
        break;

      case 'End':
        focusRelativeActivity(Infinity);
        break;

      case 'Enter':
        if (!fromEndOfTranscriptIndicator) {
          var focusedActivityEntry = renderingElements.find(function (_ref15) {
            var key = _ref15.key;
            return key === focusedActivityKey;
          });

          if (focusedActivityEntry) {
            var _ref16 = activityElementsRef.current.find(function (_ref17) {
              var activity = _ref17.activity;
              return activity === focusedActivityEntry.activity;
            }) || {},
                focusedActivityElement = _ref16.element;

            if (focusedActivityElement) {
              var _tabbableElements$fil = (0, _tabbableElements.default)(focusedActivityElement).filter(function (_ref18) {
                var className = _ref18.className;
                return className !== 'webchat__basic-transcript__activity-sentinel';
              }),
                  _tabbableElements$fil2 = _slicedToArray(_tabbableElements$fil, 1),
                  firstTabbableElement = _tabbableElements$fil2[0];

              firstTabbableElement && firstTabbableElement.focus();
            }
          }
        }

        break;

      case 'Escape':
        focus('sendBoxWithoutKeyboard');
        break;

      case 'Home':
        focusRelativeActivity(-Infinity);
        break;

      default:
        handled = false;
        break;
    }

    if (handled) {
      event.preventDefault(); // If a custom HTML control wants to handle up/down arrow, we will prevent them from listening to this event to prevent bugs due to handling arrow keys twice.

      event.stopPropagation();
    }
  }, [focusedActivityKey, activityElementsRef, focusRelativeActivity, focus, terminatorRef, renderingElements]);
  var labelId = (0, _useUniqueId.default)('webchat__basic-transcript__label'); // If SHIFT-TAB from "End of transcript" indicator, if focusedActivityKey is not set (or no longer exists), set it the the bottommost activity.

  var setBottommostFocusedActivityKeyIfNeeded = (0, _react.useCallback)(function () {
    if (!~renderingElements.findIndex(function (_ref19) {
      var key = _ref19.key;
      return key === focusedActivityKey;
    })) {
      var _ref20 = renderingElements[renderingElements.length - 1] || {},
          lastActivityKey = _ref20.key;

      setFocusedActivityKey(lastActivityKey);
    }
  }, [focusedActivityKey, renderingElements, setFocusedActivityKey]);
  var handleTranscriptKeyDownCapture = (0, _react.useCallback)(function (event) {
    var altKey = event.altKey,
        ctrlKey = event.ctrlKey,
        key = event.key,
        metaKey = event.metaKey,
        target = event.target;

    if (altKey || ctrlKey && key !== 'v' || metaKey || !(0, _inputtableKey.default)(key) && key !== 'Backspace') {
      // Ignore if one of the utility key (except SHIFT) is pressed
      // E.g. CTRL-C on a link in one of the message should not jump to chat box
      // E.g. "A" or "Backspace" should jump to chat box
      return;
    } // Send keystrokes to send box if we are focusing on the transcript or terminator.


    if (target === event.currentTarget || target === terminatorRef.current) {
      event.stopPropagation();
      focus('sendBox');
    }
  }, [focus]);
  var focusTranscriptCallback = (0, _react.useCallback)(function () {
    return rootElementRef.current && rootElementRef.current.focus();
  }, [rootElementRef]);
  (0, _useRegisterFocusTranscript.default)(focusTranscriptCallback);
  var handleFocusActivity = (0, _react.useCallback)(function (key) {
    setFocusedActivityKey(key);
    rootElementRef.current && rootElementRef.current.focus();
  }, [setFocusedActivityKey]); // When the focusing activity has changed, dispatch an event to observers of "useObserveTranscriptFocus".

  var dispatchTranscriptFocus = (0, _useDispatchTranscriptFocus.default)();
  var focusedActivity = (0, _react.useMemo)(function () {
    var _ref21 = renderingElements.find(function (_ref22) {
      var key = _ref22.key;
      return key === focusedActivityKey;
    }) || {},
        activity = _ref21.activity;

    return activity;
  }, [focusedActivityKey, renderingElements]);
  (0, _react.useMemo)(function () {
    return dispatchTranscriptFocus && dispatchTranscriptFocus({
      activity: focusedActivity
    });
  }, [dispatchTranscriptFocus, focusedActivity]); // This is required by IE11.
  // When the user clicks on and empty space (a.k.a. filler) in an empty transcript, IE11 says the focus is on the <div className="filler">,
  // despite the fact there are no "tabIndex" attributes set on the filler.
  // We need to artificially send the focus back to the transcript.

  var handleFocusFiller = (0, _react.useCallback)(function () {
    var current = rootElementRef.current;
    current && current.focus();
  }, [rootElementRef]);
  return /*#__PURE__*/_react.default.createElement("div", {
    "aria-activedescendant": focusedActivityKey ? activeDescendantElementId : undefined,
    "aria-labelledby": labelId,
    className: (0, _classnames.default)('webchat__basic-transcript', basicTranscriptStyleSet + '', rootClassName, (className || '') + ''),
    dir: direction,
    onFocus: handleTranscriptFocus,
    onKeyDown: handleTranscriptKeyDown,
    onKeyDownCapture: handleTranscriptKeyDownCapture,
    ref: rootElementRef // "aria-activedescendant" will only works with a number of roles and it must be explicitly set.
    // https://www.w3.org/TR/wai-aria/#aria-activedescendant
    ,
    role: "group" // For up/down arrow key navigation across activities, this component must be included in the tab sequence.
    // Otherwise, "aria-activedescendant" will not be narrated when the user press up/down arrow keys.
    // https://www.w3.org/TR/wai-aria-practices-1.1/#kbd_focus_activedescendant
    ,
    tabIndex: 0
  }, /*#__PURE__*/_react.default.createElement(_ScreenReaderText.default, {
    id: labelId,
    text: transcriptAriaLabel
  }), /*#__PURE__*/_react.default.createElement("section", {
    "aria-atomic": false,
    "aria-live": "polite",
    "aria-relevant": "additions",
    "aria-roledescription": transcriptRoleDescription,
    role: "log"
  }, renderingElements.map(function (_ref23) {
    var activity = _ref23.activity,
        liveRegionKey = _ref23.liveRegionKey;
    return /*#__PURE__*/_react.default.createElement(_Fade.default, {
      fadeAfter: internalLiveRegionFadeAfter,
      key: liveRegionKey
    }, function () {
      return /*#__PURE__*/_react.default.createElement(_ScreenReaderActivity.default, {
        activity: activity
      });
    });
  })), /*#__PURE__*/_react.default.createElement(InternalTranscriptScrollable, {
    activities: renderingActivities,
    onFocusActivity: handleFocusActivity,
    onFocusFiller: handleFocusFiller,
    terminatorRef: terminatorRef
  }, renderingElements.map(function (_ref24, index) {
    var activity = _ref24.activity,
        callbackRef = _ref24.callbackRef,
        focusActivity = _ref24.focusActivity,
        handleFocus = _ref24.handleFocus,
        handleKeyDown = _ref24.handleKeyDown,
        handleMouseDownCapture = _ref24.handleMouseDownCapture,
        hideTimestamp = _ref24.hideTimestamp,
        key = _ref24.key,
        renderActivity = _ref24.renderActivity,
        renderActivityStatus = _ref24.renderActivityStatus,
        renderAvatar = _ref24.renderAvatar,
        role = _ref24.role,
        shouldSpeak = _ref24.shouldSpeak,
        showCallout = _ref24.showCallout;

    var _ref25 = activityElementsRef.current.find(function (entry) {
      return entry.activity === activity;
    }) || {},
        ariaLabelID = _ref25.ariaLabelID,
        element = _ref25.element;

    var activeDescendant = focusedActivityKey === key;
    var isContentInteractive = !!(element ? (0, _tabbableElements.default)(element.querySelector('.webchat__basic-transcript__activity-box')).length : 0);
    return /*#__PURE__*/_react.default.createElement("li", {
      "aria-labelledby": ariaLabelID,
      className: (0, _classnames.default)('webchat__basic-transcript__activity', {
        'webchat__basic-transcript__activity--acknowledged': index <= indexOfLastInteractedActivity,
        'webchat__basic-transcript__activity--from-bot': role !== 'user',
        'webchat__basic-transcript__activity--from-user': role === 'user'
      }) // Set "id" for valid for accessibility.

      /* eslint-disable-next-line react/forbid-dom-props */
      ,
      id: activeDescendant ? activeDescendantElementId : undefined,
      key: key,
      onFocus: handleFocus,
      onKeyDown: handleKeyDown,
      onMouseDownCapture: handleMouseDownCapture,
      ref: callbackRef
    }, /*#__PURE__*/_react.default.createElement(_ScreenReaderActivity.default, {
      activity: activity,
      id: ariaLabelID,
      renderAttachments: false
    }, !!isContentInteractive && /*#__PURE__*/_react.default.createElement("p", null, activityInteractiveAlt)), /*#__PURE__*/_react.default.createElement(_FocusRedirector.default, {
      className: "webchat__basic-transcript__activity-sentinel",
      onFocus: focusActivity,
      redirectRef: rootElementRef
    }), /*#__PURE__*/_react.default.createElement("div", {
      className: "webchat__basic-transcript__activity-box"
    }, renderActivity({
      hideTimestamp: hideTimestamp,
      renderActivityStatus: renderActivityStatus,
      renderAvatar: renderAvatar,
      showCallout: showCallout
    })), shouldSpeak && /*#__PURE__*/_react.default.createElement(_Speak.default, {
      activity: activity
    }), /*#__PURE__*/_react.default.createElement(_FocusRedirector.default, {
      className: "webchat__basic-transcript__activity-sentinel",
      onFocus: focusActivity,
      redirectRef: rootElementRef
    }), /*#__PURE__*/_react.default.createElement("div", {
      className: (0, _classnames.default)('webchat__basic-transcript__activity-indicator', {
        'webchat__basic-transcript__activity-indicator--first': !index,
        'webchat__basic-transcript__activity-indicator--focus': activeDescendant
      })
    }));
  })), !!renderingElements.length && /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_FocusRedirector.default, {
    className: "webchat__basic-transcript__sentinel",
    onFocus: setBottommostFocusedActivityKeyIfNeeded,
    redirectRef: rootElementRef
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__basic-transcript__terminator",
    ref: terminatorRef,
    tabIndex: 0
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__basic-transcript__terminator-body"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__basic-transcript__terminator-text"
  }, terminatorText)))), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__basic-transcript__focus-indicator"
  }));
};

InternalTranscript.defaultProps = {
  className: ''
};
InternalTranscript.propTypes = {
  activityElementsRef: _propTypes.default.shape({
    current: _propTypes.default.array.isRequired
  }).isRequired,
  className: _propTypes.default.string
};

var InternalScreenReaderTranscript = function InternalScreenReaderTranscript(_ref26) {
  var renderingElements = _ref26.renderingElements;
  var localize = useLocalizer();

  var _useStyleOptions3 = useStyleOptions(),
      _useStyleOptions4 = _slicedToArray(_useStyleOptions3, 1),
      internalLiveRegionFadeAfter = _useStyleOptions4[0];

  var transcriptRoleDescription = localize('TRANSCRIPT_ARIA_ROLE_ALT');
  return /*#__PURE__*/_react.default.createElement("section", {
    "aria-atomic": false,
    "aria-live": "polite",
    "aria-relevant": "additions",
    "aria-roledescription": transcriptRoleDescription,
    role: "log"
  }, renderingElements.map(function (_ref27) {
    var activity = _ref27.activity,
        liveRegionKey = _ref27.liveRegionKey;
    return /*#__PURE__*/_react.default.createElement(_Fade.default, {
      fadeAfter: internalLiveRegionFadeAfter,
      key: liveRegionKey
    }, function () {
      return /*#__PURE__*/_react.default.createElement(_ScreenReaderActivity.default, {
        activity: activity
      });
    });
  }));
};

InternalScreenReaderTranscript.propTypes = {
  renderingElements: _propTypes.default.arrayOf(_propTypes.default.shape({
    activity: _propTypes.default.any,
    liveRegionKey: _propTypes.default.string
  })).isRequired
}; // Separating high-frequency hooks to improve performance.

var InternalTranscriptScrollable = function InternalTranscriptScrollable(_ref28) {
  var activities = _ref28.activities,
      children = _ref28.children,
      onFocusActivity = _ref28.onFocusActivity,
      onFocusFiller = _ref28.onFocusFiller,
      terminatorRef = _ref28.terminatorRef;

  var _useStyleSet3 = (0, _useStyleSet5.default)(),
      _useStyleSet4 = _slicedToArray(_useStyleSet3, 1),
      activitiesStyleSet = _useStyleSet4[0].activities;

  var _useStyleOptions5 = useStyleOptions(),
      _useStyleOptions6 = _slicedToArray(_useStyleOptions5, 1),
      hideScrollToEndButton = _useStyleOptions6[0].hideScrollToEndButton;

  var _useAnimatingToEnd = (0, _reactScrollToBottom.useAnimatingToEnd)(),
      _useAnimatingToEnd2 = _slicedToArray(_useAnimatingToEnd, 1),
      animatingToEnd = _useAnimatingToEnd2[0];

  var _useSticky = (0, _reactScrollToBottom.useSticky)(),
      _useSticky2 = _slicedToArray(_useSticky, 1),
      sticky = _useSticky2[0];

  var lastVisibleActivityId = (0, _getActivityUniqueId.default)(activities[activities.length - 1] || {}); // Activity ID of the last visible activity in the list.

  var localize = useLocalizer();
  var scrollToEndButtonRef = (0, _react.useRef)();
  var lastReadActivityIdRef = (0, _react.useRef)(lastVisibleActivityId);
  var transcriptRoleDescription = localize('TRANSCRIPT_ARIA_ROLE_ALT');
  var allActivitiesRead = lastVisibleActivityId === lastReadActivityIdRef.current;
  var handleScrollToEndButtonClick = (0, _react.useCallback)(function () {
    // After the "New message" button is clicked, focus on the first unread activity.
    var index = activities.findIndex(function (_ref29) {
      var id = _ref29.id;
      return id === lastReadActivityIdRef.current;
    });

    if (~index) {
      var firstUnreadActivity = activities[index + 1];

      if (firstUnreadActivity) {
        return onFocusActivity((0, _getActivityUniqueId.default)(firstUnreadActivity));
      }
    }

    var current = terminatorRef.current;
    current && current.focus();
  }, [activities, lastReadActivityIdRef, onFocusActivity, terminatorRef]);

  if (sticky) {
    // If it is sticky, the user is at the bottom of the transcript, everything is read.
    // So mark the activity ID as read.
    lastReadActivityIdRef.current = lastVisibleActivityId;
  } // Finds where we should render the "New messages" button, in index. Returns -1 to hide the button.


  var renderSeparatorAfterIndex = (0, _react.useMemo)(function () {
    // Don't show the button if:
    // - All activities have been read
    // - Currently animating towards bottom
    //   - "New messages" button must not flash when: 1. Type "help", 2. Scroll to top, 3. Type "help" again, 4. Expect the "New messages" button not flashy
    // - Hidden by style options
    // - It is already at the bottom (sticky)
    // Any changes to this logic, verify:
    // - "New messages" button should persist while programmatically scrolling to mid-point of the transcript:
    //   1. Type "help"
    //   2. Type "proactive", then immediately scroll to top
    //      Expect: the "New messages" button should appear
    //   3. Run hook "useScrollTo({ scrollTop: 500 })"
    //      Expect: when the scroll is animating to 500px, the "New messages" button should kept on the screen
    // - "New messages" button must not flashy:
    //   1. Type "help"
    //   2. Scroll to top
    //      Expect: no "New messages" button is shown
    //   3. Type "help" again
    //      Expect: "New messages" button must not flash-appear
    if (allActivitiesRead || animatingToEnd || hideScrollToEndButton || sticky) {
      return -1;
    }

    return activities.findIndex(function (activity) {
      return (0, _getActivityUniqueId.default)(activity) === lastReadActivityIdRef.current;
    });
  }, [activities, allActivitiesRead, animatingToEnd, hideScrollToEndButton, lastReadActivityIdRef, sticky]);
  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, renderSeparatorAfterIndex !== -1 && /*#__PURE__*/_react.default.createElement(_ScrollToEndButton.default, {
    onClick: handleScrollToEndButtonClick,
    ref: scrollToEndButtonRef
  }), !!_react.default.Children.count(children) && /*#__PURE__*/_react.default.createElement(_FocusRedirector.default, {
    className: "webchat__basic-transcript__sentinel",
    redirectRef: terminatorRef
  }), /*#__PURE__*/_react.default.createElement(_reactScrollToBottom.Panel, {
    className: "webchat__basic-transcript__scrollable"
  }, /*#__PURE__*/_react.default.createElement("div", {
    "aria-hidden": true,
    className: "webchat__basic-transcript__filler",
    onFocus: onFocusFiller
  }), /*#__PURE__*/_react.default.createElement("ul", {
    "aria-roledescription": transcriptRoleDescription,
    className: (0, _classnames.default)(activitiesStyleSet + '', 'webchat__basic-transcript__transcript'),
    role: "list"
  }, children), /*#__PURE__*/_react.default.createElement(_BasicTypingIndicator.default, null)));
};

InternalTranscriptScrollable.propTypes = {
  activities: _propTypes.default.array.isRequired,
  children: _propTypes.default.any.isRequired,
  onFocusActivity: _propTypes.default.func.isRequired,
  onFocusFiller: _propTypes.default.func.isRequired,
  terminatorRef: _propTypes.default.any.isRequired
};

var SetScroller = function SetScroller(_ref30) {
  var activityElementsRef = _ref30.activityElementsRef,
      scrollerRef = _ref30.scrollerRef;

  var _useStyleOptions7 = useStyleOptions(),
      _useStyleOptions8 = _slicedToArray(_useStyleOptions7, 1),
      _useStyleOptions8$ = _useStyleOptions8[0],
      autoScrollSnapOnActivity = _useStyleOptions8$.autoScrollSnapOnActivity,
      autoScrollSnapOnActivityOffset = _useStyleOptions8$.autoScrollSnapOnActivityOffset,
      autoScrollSnapOnPage = _useStyleOptions8$.autoScrollSnapOnPage,
      autoScrollSnapOnPageOffset = _useStyleOptions8$.autoScrollSnapOnPageOffset;

  var _useAcknowledgedActiv3 = (0, _useAcknowledgedActivity.default)(),
      _useAcknowledgedActiv4 = _slicedToArray(_useAcknowledgedActiv3, 1),
      lastAcknowledgedActivity = _useAcknowledgedActiv4[0];

  var lastAcknowledgedActivityRef = (0, _react.useRef)(lastAcknowledgedActivity);
  lastAcknowledgedActivityRef.current = lastAcknowledgedActivity;
  scrollerRef.current = (0, _react.useCallback)(function (_ref31) {
    var offsetHeight = _ref31.offsetHeight,
        scrollTop = _ref31.scrollTop;
    var patchedAutoScrollSnapOnActivity = typeof autoScrollSnapOnActivity === 'number' ? Math.max(0, autoScrollSnapOnActivity) : autoScrollSnapOnActivity ? 1 : 0;
    var patchedAutoScrollSnapOnPage = typeof autoScrollSnapOnPage === 'number' ? Math.max(0, Math.min(1, autoScrollSnapOnPage)) : autoScrollSnapOnPage ? 1 : 0;
    var patchedAutoScrollSnapOnActivityOffset = typeof autoScrollSnapOnActivityOffset === 'number' ? autoScrollSnapOnActivityOffset : 0;
    var patchedAutoScrollSnapOnPageOffset = typeof autoScrollSnapOnPageOffset === 'number' ? autoScrollSnapOnPageOffset : 0;

    if (patchedAutoScrollSnapOnActivity || patchedAutoScrollSnapOnPage) {
      var _lastAcknowledgedActivity = lastAcknowledgedActivityRef.current;
      var values = [];

      if (patchedAutoScrollSnapOnActivity) {
        var _ref32 = activityElementsRef.current[activityElementsRef.current.findIndex(function (_ref33) {
          var activity = _ref33.activity;
          return activity === _lastAcknowledgedActivity;
        }) + patchedAutoScrollSnapOnActivity] || {},
            nthUnacknowledgedActivityElement = _ref32.element;

        if (nthUnacknowledgedActivityElement) {
          values.push(nthUnacknowledgedActivityElement.offsetTop + nthUnacknowledgedActivityElement.offsetHeight - offsetHeight - scrollTop + patchedAutoScrollSnapOnActivityOffset);
        }
      }

      if (patchedAutoScrollSnapOnPage) {
        var _ref34 = activityElementsRef.current[activityElementsRef.current.findIndex(function (_ref35) {
          var activity = _ref35.activity;
          return activity === _lastAcknowledgedActivity;
        }) + 1] || {},
            firstUnacknowledgedActivityElement = _ref34.element;

        if (firstUnacknowledgedActivityElement) {
          values.push(firstUnacknowledgedActivityElement.offsetTop - scrollTop - offsetHeight * (1 - patchedAutoScrollSnapOnPage) + patchedAutoScrollSnapOnPageOffset);
        }
      }

      return values.reduce(function (minValue, value) {
        return Math.min(minValue, value);
      }, Infinity);
    }

    return Infinity;
  }, [activityElementsRef, autoScrollSnapOnActivity, autoScrollSnapOnActivityOffset, autoScrollSnapOnPage, autoScrollSnapOnPageOffset, lastAcknowledgedActivityRef]);
  return false;
};

var BasicTranscript = function BasicTranscript(_ref36) {
  var className = _ref36.className;
  var activityElementsRef = (0, _react.useRef)([]);
  var scrollerRef = (0, _react.useRef)(function () {
    return Infinity;
  });
  var scroller = (0, _react.useCallback)(function () {
    return scrollerRef.current.apply(scrollerRef, arguments);
  }, [scrollerRef]);
  return /*#__PURE__*/_react.default.createElement(_reactScrollToBottom.Composer, {
    scroller: scroller
  }, /*#__PURE__*/_react.default.createElement(SetScroller, {
    activityElementsRef: activityElementsRef,
    scrollerRef: scrollerRef
  }), /*#__PURE__*/_react.default.createElement(InternalTranscript, {
    activityElementsRef: activityElementsRef,
    className: className
  }));
};

BasicTranscript.defaultProps = {
  className: ''
};
BasicTranscript.propTypes = {
  className: _propTypes.default.string
};
var _default = BasicTranscript;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9CYXNpY1RyYW5zY3JpcHQuanMiXSwibmFtZXMiOlsidXNlQWN0aXZpdGllcyIsImhvb2tzIiwidXNlQ3JlYXRlQWN0aXZpdHlSZW5kZXJlciIsInVzZUNyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXIiLCJ1c2VDcmVhdGVBdmF0YXJSZW5kZXJlciIsInVzZURpcmVjdGlvbiIsInVzZUdyb3VwQWN0aXZpdGllcyIsInVzZUxvY2FsaXplciIsInVzZVN0eWxlT3B0aW9ucyIsIlJPT1RfU1RZTEUiLCJkaXNwbGF5IiwiZmxleERpcmVjdGlvbiIsIm92ZXJmbG93IiwicG9zaXRpb24iLCJmbGV4Iiwib3ZlcmZsb3dYIiwiV2Via2l0T3ZlcmZsb3dTY3JvbGxpbmciLCJsaXN0U3R5bGVUeXBlIiwidmFsaWRhdGVBbGxBY3Rpdml0aWVzVGFnZ2VkIiwiYWN0aXZpdGllcyIsImJpbnMiLCJldmVyeSIsImFjdGl2aXR5Iiwic29tZSIsImJpbiIsImluY2x1ZGVzIiwiSW50ZXJuYWxUcmFuc2NyaXB0IiwiYWN0aXZpdHlFbGVtZW50c1JlZiIsImNsYXNzTmFtZSIsImJhc2ljVHJhbnNjcmlwdFN0eWxlU2V0IiwiYmFzaWNUcmFuc2NyaXB0IiwiYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQiLCJidWJibGVOdWJPZmZzZXQiLCJncm91cFRpbWVzdGFtcCIsImludGVybmFsTGl2ZVJlZ2lvbkZhZGVBZnRlciIsInNob3dBdmF0YXJJbkdyb3VwIiwiZm9jdXNlZEFjdGl2aXR5S2V5Iiwic2V0Rm9jdXNlZEFjdGl2aXR5S2V5IiwiZGlyZWN0aW9uIiwiY3JlYXRlQWN0aXZpdHlSZW5kZXJlciIsImNyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXIiLCJjcmVhdGVBdmF0YXJSZW5kZXJlciIsImZvY3VzIiwiZ3JvdXBBY3Rpdml0aWVzIiwibG9jYWxpemUiLCJyb290Q2xhc3NOYW1lIiwicm9vdEVsZW1lbnRSZWYiLCJ0ZXJtaW5hdG9yUmVmIiwiYWN0aXZpdHlJbnRlcmFjdGl2ZUFsdCIsInRlcm1pbmF0b3JUZXh0IiwidHJhbnNjcmlwdEFyaWFMYWJlbCIsInRyYW5zY3JpcHRSb2xlRGVzY3JpcHRpb24iLCJoaWRlQWxsVGltZXN0YW1wcyIsImNyZWF0ZUFjdGl2aXR5UmVuZGVyZXJXaXRoTGl0ZXJhbEFyZ3MiLCJuZXh0VmlzaWJsZUFjdGl2aXR5IiwiYWN0aXZpdGllc1dpdGhSZW5kZXJlciIsImNyZWF0ZUFjdGl2aXR5UmVuZGVyZXJXaXRoTGl0ZXJhbEFyZ3NNZW1vaXplZCIsImluZGV4IiwibGVuZ3RoIiwicmVuZGVyQWN0aXZpdHkiLCJzcGxpY2UiLCJ2aXNpYmxlQWN0aXZpdGllcyIsIm1hcCIsImFjdGl2aXRpZXNHcm91cEJ5U2VuZGVyIiwic2VuZGVyIiwiYWN0aXZpdGllc0dyb3VwQnlTdGF0dXMiLCJzdGF0dXMiLCJjb25zb2xlIiwid2FybiIsImFjdGl2aXR5VHJlZSIsInZpc2libGVBY3Rpdml0aWVzUGVuZGluZ0dyb3VwaW5nIiwic2VuZGVyVHJlZSIsImFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlciIsImZpbmQiLCJwdXNoIiwiZm9yRWFjaCIsImFjdGl2aXRpZXNXaXRoU2FtZVN0YXR1cyIsImFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlckFuZFN0YXR1cyIsInJlbW92ZUlubGluZSIsInJlbmRlcmluZ0VsZW1lbnRzIiwidG9wU2lkZUJvdE51YiIsInRvcFNpZGVVc2VyTnViIiwiZmlyc3RBY3Rpdml0eSIsInJlbmRlckF2YXRhciIsImluZGV4V2l0aGluU2VuZGVyR3JvdXAiLCJmaXJzdEluU2VuZGVyR3JvdXAiLCJsYXN0SW5TZW5kZXJHcm91cCIsImluZGV4V2l0aGluU2VuZGVyQW5kU3RhdHVzR3JvdXAiLCJyZW5kZXJBY3Rpdml0eVN0YXR1cyIsImZpcnN0SW5TZW5kZXJBbmRTdGF0dXNHcm91cCIsImxhc3RJblNlbmRlckFuZFN0YXR1c0dyb3VwIiwiZW50cnkiLCJrZXkiLCJjaGFubmVsRGF0YSIsIm1lc3NhZ2VCYWNrIiwibWVzc2FnZUJhY2tEaXNwbGF5VGV4dCIsImRpc3BsYXlUZXh0Iiwicm9sZSIsImZyb20iLCJ0ZXh0IiwidG9wU2lkZU51YiIsInNob3dDYWxsb3V0IiwiZm9jdXNBY3Rpdml0eSIsInJvb3RFbGVtZW50IiwiY3VycmVudCIsImNhbGxiYWNrUmVmIiwiYWN0aXZpdHlFbGVtZW50IiwiYWN0aXZpdHlJRCIsImlkIiwiZWxlbWVudCIsImhhbmRsZUZvY3VzIiwiaGFuZGxlS2V5RG93biIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJoYW5kbGVNb3VzZURvd25DYXB0dXJlIiwidGFyZ2V0IiwidGFiSW5kZXgiLCJnZXRBdHRyaWJ1dGUiLCJoaWRlVGltZXN0YW1wIiwibGl2ZVJlZ2lvbktleSIsInNob3VsZFNwZWFrIiwic3BlYWsiLCJhY3Rpdml0eUVsZW1lbnRzIiwiZWxlbWVudElkIiwiZXhpc3RpbmdFbnRyeSIsImFyaWFMYWJlbElEIiwidG9TdHJpbmciLCJzdWJzdHIiLCJmb2N1c2VkIiwibGFzdEVsZW1lbnQiLCJyZW5kZXJpbmdBY3Rpdml0aWVzIiwic2Nyb2xsVG9Cb3R0b21TY3JvbGxUbyIsInNjcm9sbFRvQm90dG9tU2Nyb2xsVG9FbmQiLCJzY3JvbGxUbyIsImJlaGF2aW9yIiwiRXJyb3IiLCJzY3JvbGxUb3AiLCJzY3JvbGxhYmxlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJnZXRDbGllbnRSZWN0cyIsImFjdGl2aXR5RWxlbWVudEhlaWdodCIsImhlaWdodCIsImFjdGl2aXR5RWxlbWVudFkiLCJ5Iiwic2Nyb2xsYWJsZUhlaWdodCIsImFjdGl2aXR5RWxlbWVudE9mZnNldFRvcCIsIk1hdGgiLCJtaW4iLCJzY3JvbGxSZWxhdGl2ZSIsImRpc3BsYWNlbWVudCIsInNjcm9sbGFibGUiLCJuZXh0U2Nyb2xsVG9wIiwib2Zmc2V0SGVpZ2h0IiwibWF4Iiwic2Nyb2xsSGVpZ2h0IiwiZGlzcGF0Y2hTY3JvbGxQb3NpdGlvbiIsInBhdGNoZWREaXNwYXRjaFNjcm9sbFBvc2l0aW9uIiwicmV2ZXJzZSIsImxhc3RJbnRlcmFjdGVkQWN0aXZpdHkiLCJpbmRleE9mTGFzdEludGVyYWN0ZWRBY3Rpdml0eSIsImluZGV4T2YiLCJhY3RpdmVEZXNjZW5kYW50RWxlbWVudElkIiwic2Nyb2xsQWN0aXZlRGVzY2VuZGFudEludG9WaWV3IiwiYWN0aXZlRGVzY2VuZGFudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJjb250YWlucyIsImFjdGl2ZUVsZW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsInNjcm9sbEludG9WaWV3IiwiYmxvY2siLCJzY3JvbGxUb3BBdFRvcFNpZGUiLCJvZmZzZXRUb3AiLCJzY3JvbGxUb3BBdEJvdHRvbVNpZGUiLCJoYW5kbGVUcmFuc2NyaXB0Rm9jdXMiLCJjdXJyZW50VGFyZ2V0IiwidW5kZWZpbmVkIiwiZm9jdXNSZWxhdGl2ZUFjdGl2aXR5IiwiZGVsdGEiLCJpc05hTiIsImZpbmRJbmRleCIsIm5leHRJbmRleCIsIm5leHRGb2N1c2VkQWN0aXZpdHkiLCJoYW5kbGVUcmFuc2NyaXB0S2V5RG93biIsImZyb21FbmRPZlRyYW5zY3JpcHRJbmRpY2F0b3IiLCJmcm9tVHJhbnNjcmlwdCIsImhhbmRsZWQiLCJJbmZpbml0eSIsImZvY3VzZWRBY3Rpdml0eUVudHJ5IiwiZm9jdXNlZEFjdGl2aXR5RWxlbWVudCIsImZpbHRlciIsImZpcnN0VGFiYmFibGVFbGVtZW50IiwibGFiZWxJZCIsInNldEJvdHRvbW1vc3RGb2N1c2VkQWN0aXZpdHlLZXlJZk5lZWRlZCIsImxhc3RBY3Rpdml0eUtleSIsImhhbmRsZVRyYW5zY3JpcHRLZXlEb3duQ2FwdHVyZSIsImFsdEtleSIsImN0cmxLZXkiLCJtZXRhS2V5IiwiZm9jdXNUcmFuc2NyaXB0Q2FsbGJhY2siLCJoYW5kbGVGb2N1c0FjdGl2aXR5IiwiZGlzcGF0Y2hUcmFuc2NyaXB0Rm9jdXMiLCJmb2N1c2VkQWN0aXZpdHkiLCJoYW5kbGVGb2N1c0ZpbGxlciIsImlzQ29udGVudEludGVyYWN0aXZlIiwiZGVmYXVsdFByb3BzIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwic2hhcGUiLCJhcnJheSIsImlzUmVxdWlyZWQiLCJzdHJpbmciLCJJbnRlcm5hbFNjcmVlblJlYWRlclRyYW5zY3JpcHQiLCJhcnJheU9mIiwiYW55IiwiSW50ZXJuYWxUcmFuc2NyaXB0U2Nyb2xsYWJsZSIsImNoaWxkcmVuIiwib25Gb2N1c0FjdGl2aXR5Iiwib25Gb2N1c0ZpbGxlciIsImFjdGl2aXRpZXNTdHlsZVNldCIsImhpZGVTY3JvbGxUb0VuZEJ1dHRvbiIsImFuaW1hdGluZ1RvRW5kIiwic3RpY2t5IiwibGFzdFZpc2libGVBY3Rpdml0eUlkIiwic2Nyb2xsVG9FbmRCdXR0b25SZWYiLCJsYXN0UmVhZEFjdGl2aXR5SWRSZWYiLCJhbGxBY3Rpdml0aWVzUmVhZCIsImhhbmRsZVNjcm9sbFRvRW5kQnV0dG9uQ2xpY2siLCJmaXJzdFVucmVhZEFjdGl2aXR5IiwicmVuZGVyU2VwYXJhdG9yQWZ0ZXJJbmRleCIsIlJlYWN0IiwiQ2hpbGRyZW4iLCJjb3VudCIsImZ1bmMiLCJTZXRTY3JvbGxlciIsInNjcm9sbGVyUmVmIiwiYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5IiwiYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5T2Zmc2V0IiwiYXV0b1Njcm9sbFNuYXBPblBhZ2UiLCJhdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCIsImxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eSIsImxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eVJlZiIsInBhdGNoZWRBdXRvU2Nyb2xsU25hcE9uQWN0aXZpdHkiLCJwYXRjaGVkQXV0b1Njcm9sbFNuYXBPblBhZ2UiLCJwYXRjaGVkQXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5T2Zmc2V0IiwicGF0Y2hlZEF1dG9TY3JvbGxTbmFwT25QYWdlT2Zmc2V0IiwidmFsdWVzIiwibnRoVW5hY2tub3dsZWRnZWRBY3Rpdml0eUVsZW1lbnQiLCJmaXJzdFVuYWNrbm93bGVkZ2VkQWN0aXZpdHlFbGVtZW50IiwicmVkdWNlIiwibWluVmFsdWUiLCJ2YWx1ZSIsIkJhc2ljVHJhbnNjcmlwdCIsInNjcm9sbGVyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFFQTs7QUFDQTs7QUFTQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztJQUdFQSxhLEdBUUVDLDZCLENBUkZELGE7SUFDQUUseUIsR0FPRUQsNkIsQ0FQRkMseUI7SUFDQUMsK0IsR0FNRUYsNkIsQ0FORkUsK0I7SUFDQUMsdUIsR0FLRUgsNkIsQ0FMRkcsdUI7SUFDQUMsWSxHQUlFSiw2QixDQUpGSSxZO0lBQ0FDLGtCLEdBR0VMLDZCLENBSEZLLGtCO0lBQ0FDLFksR0FFRU4sNkIsQ0FGRk0sWTtJQUNBQyxlLEdBQ0VQLDZCLENBREZPLGU7QUFHRixJQUFNQyxVQUFVLEdBQUc7QUFDakIsaUNBQStCO0FBQzdCQyxJQUFBQSxPQUFPLEVBQUUsTUFEb0I7QUFFN0JDLElBQUFBLGFBQWEsRUFBRSxRQUZjO0FBRzdCQyxJQUFBQSxRQUFRLEVBQUUsUUFIbUI7QUFJN0I7QUFDQTtBQUNBO0FBQ0FDLElBQUFBLFFBQVEsRUFBRSxVQVBtQjtBQVM3Qiw0Q0FBd0M7QUFDdENDLE1BQUFBLElBQUksRUFBRTtBQURnQyxLQVRYO0FBYTdCLGdEQUE0QztBQUMxQ0osTUFBQUEsT0FBTyxFQUFFLE1BRGlDO0FBRTFDQyxNQUFBQSxhQUFhLEVBQUUsUUFGMkI7QUFHMUNJLE1BQUFBLFNBQVMsRUFBRSxRQUgrQjtBQUkxQ0MsTUFBQUEsdUJBQXVCLEVBQUU7QUFKaUIsS0FiZjtBQW9CN0IsZ0RBQTRDO0FBQzFDQyxNQUFBQSxhQUFhLEVB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QUEsUUFBUSxFQUFFa0I7QUFBdkMsa0JBQ0UsNkJBQUMsV0FBRDtBQUFhLElBQUEsbUJBQW1CLEVBQUVwTyxtQkFBbEM7QUFBdUQsSUFBQSxXQUFXLEVBQUVrTjtBQUFwRSxJQURGLGVBRUUsNkJBQUMsa0JBQUQ7QUFBb0IsSUFBQSxtQkFBbUIsRUFBRWxOLG1CQUF6QztBQUE4RCxJQUFBLFNBQVMsRUFBRUM7QUFBekUsSUFGRixDQURGO0FBTUQsQ0FaRDs7QUFjQWtPLGVBQWUsQ0FBQy9DLFlBQWhCLEdBQStCO0FBQzdCbkwsRUFBQUEsU0FBUyxFQUFFO0FBRGtCLENBQS9CO0FBSUFrTyxlQUFlLENBQUM5QyxTQUFoQixHQUE0QjtBQUMxQnBMLEVBQUFBLFNBQVMsRUFBRXFMLG1CQUFVSTtBQURLLENBQTVCO2VBSWV5QyxlIiwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQgbm8tbWFnaWMtbnVtYmVyczogW1wiZXJyb3JcIiwgeyBcImlnbm9yZVwiOiBbLTEsIDAsIDEsIDIsIDUsIDM2XSB9XSAqL1xuXG5pbXBvcnQgeyBob29rcyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQge1xuICBDb21wb3NlciBhcyBSZWFjdFNjcm9sbFRvQm90dG9tQ29tcG9zZXIsXG4gIFBhbmVsIGFzIFJlYWN0U2Nyb2xsVG9Cb3R0b21QYW5lbCxcbiAgdXNlQW5pbWF0aW5nVG9FbmQsXG4gIHVzZU9ic2VydmVTY3JvbGxQb3NpdGlvbixcbiAgdXNlU2Nyb2xsVG8sXG4gIHVzZVNjcm9sbFRvRW5kLFxuICB1c2VTdGlja3lcbn0gZnJvbSAncmVhY3Qtc2Nyb2xsLXRvLWJvdHRvbSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgcmFuZG9tIGZyb20gJ21hdGgtcmFuZG9tJztcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgQmFzaWNUeXBpbmdJbmRpY2F0b3IgZnJvbSAnLi9CYXNpY1R5cGluZ0luZGljYXRvcic7XG5pbXBvcnQgRmFkZSBmcm9tICcuL1V0aWxzL0ZhZGUnO1xuaW1wb3J0IEZvY3VzUmVkaXJlY3RvciBmcm9tICcuL1V0aWxzL0ZvY3VzUmVkaXJlY3Rvcic7XG5pbXBvcnQgZ2V0QWN0aXZpdHlVbmlxdWVJZCBmcm9tICcuL1V0aWxzL2dldEFjdGl2aXR5VW5pcXVlSWQnO1xuaW1wb3J0IGdldFRhYkluZGV4IGZyb20gJy4vVXRpbHMvVHlwZUZvY3VzU2luay9nZXRUYWJJbmRleCc7XG5pbXBvcnQgaW5wdXR0YWJsZUtleSBmcm9tICcuL1V0aWxzL1R5cGVGb2N1c1NpbmsvaW5wdXR0YWJsZUtleSc7XG5pbXBvcnQgaW50ZXJzZWN0aW9uT2YgZnJvbSAnLi9VdGlscy9pbnRlcnNlY3Rpb25PZic7XG5pbXBvcnQgaXNaZXJvT3JQb3NpdGl2ZSBmcm9tICcuL1V0aWxzL2lzWmVyb09yUG9zaXRpdmUnO1xuaW1wb3J0IHJlbW92ZUlubGluZSBmcm9tICcuL1V0aWxzL3JlbW92ZUlubGluZSc7XG5pbXBvcnQgU2NyZWVuUmVhZGVyQWN0aXZpdHkgZnJvbSAnLi9TY3JlZW5SZWFkZXJBY3Rpdml0eSc7XG5pbXBvcnQgU2NyZWVuUmVhZGVyVGV4dCBmcm9tICcuL1NjcmVlblJlYWRlclRleHQnO1xuaW1wb3J0IFNjcm9sbFRvRW5kQnV0dG9uIGZyb20gJy4vQWN0aXZpdHkvU2Nyb2xsVG9FbmRCdXR0b24nO1xuaW1wb3J0IFNwZWFrQWN0aXZpdHkgZnJvbSAnLi9BY3Rpdml0eS9TcGVhayc7XG5pbXBvcnQgdGFiYmFibGVFbGVtZW50cyBmcm9tICcuL1V0aWxzL3RhYmJhYmxlRWxlbWVudHMnO1xuaW1wb3J0IHVzZUFja25vd2xlZGdlZEFjdGl2aXR5IGZyb20gJy4vaG9va3MvaW50ZXJuYWwvdXNlQWNrbm93bGVkZ2VkQWN0aXZpdHknO1xuaW1wb3J0IHVzZURpc3BhdGNoU2Nyb2xsUG9zaXRpb24gZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VEaXNwYXRjaFNjcm9sbFBvc2l0aW9uJztcbmltcG9ydCB1c2VEaXNwYXRjaFRyYW5zY3JpcHRGb2N1cyBmcm9tICcuL2hvb2tzL2ludGVybmFsL3VzZURpc3BhdGNoVHJhbnNjcmlwdEZvY3VzJztcbmltcG9ydCB1c2VGb2N1cyBmcm9tICcuL2hvb2tzL3VzZUZvY3VzJztcbmltcG9ydCB1c2VNZW1vaXplIGZyb20gJy4vaG9va3MvaW50ZXJuYWwvdXNlTWVtb2l6ZSc7XG5pbXBvcnQgdXNlUmVnaXN0ZXJGb2N1c1RyYW5zY3JpcHQgZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VSZWdpc3RlckZvY3VzVHJhbnNjcmlwdCc7XG5pbXBvcnQgdXNlUmVnaXN0ZXJTY3JvbGxSZWxhdGl2ZSBmcm9tICcuL2hvb2tzL2ludGVybmFsL3VzZVJlZ2lzdGVyU2Nyb2xsUmVsYXRpdmUnO1xuaW1wb3J0IHVzZVJlZ2lzdGVyU2Nyb2xsVG8gZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VSZWdpc3RlclNjcm9sbFRvJztcbmltcG9ydCB1c2VSZWdpc3RlclNjcm9sbFRvRW5kIGZyb20gJy4vaG9va3MvaW50ZXJuYWwvdXNlUmVnaXN0ZXJTY3JvbGxUb0VuZCc7XG5pbXBvcnQgdXNlU3R5bGVTZXQgZnJvbSAnLi9ob29rcy91c2VTdHlsZVNldCc7XG5pbXBvcnQgdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QgZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VTdHlsZVRvRW1vdGlvbk9iamVjdCc7XG5pbXBvcnQgdXNlVW5pcXVlSWQgZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VVbmlxdWVJZCc7XG5cbmNvbnN0IHtcbiAgdXNlQWN0aXZpdGllcyxcbiAgdXNlQ3JlYXRlQWN0aXZpdHlSZW5kZXJlcixcbiAgdXNlQ3JlYXRlQWN0aXZpdHlTdGF0dXNSZW5kZXJlcixcbiAgdXNlQ3JlYXRlQXZhdGFyUmVuZGVyZXIsXG4gIHVzZURpcmVjdGlvbixcbiAgdXNlR3JvdXBBY3Rpdml0aWVzLFxuICB1c2VMb2NhbGl6ZXIsXG4gIHVzZVN0eWxlT3B0aW9uc1xufSA9IGhvb2tzO1xuXG5jb25zdCBST09UX1NUWUxFID0ge1xuICAnJi53ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0Jzoge1xuICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgLy8gTWFrZSBzdXJlIHRvIHNldCBcInBvc2l0aW9uOiByZWxhdGl2ZVwiIGhlcmUgdG8gZm9ybSBhbm90aGVyIHN0YWNraW5nIGNvbnRleHQgZm9yIHRoZSBzY3JvbGwtdG8tZW5kIGJ1dHRvbi5cbiAgICAvLyBTdGFja2luZyBjb250ZXh0IGhlbHAgaXNvbGF0aW5nIGVsZW1lbnRzIHRoYXQgdXNlIFwiei1pbmRleFwiIGZyb20gZ2xvYmFsIHBvbGx1dGlvbi5cbiAgICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvQ1NTX1Bvc2l0aW9uaW5nL1VuZGVyc3RhbmRpbmdfel9pbmRleC9UaGVfc3RhY2tpbmdfY29udGV4dFxuICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLFxuXG4gICAgJyYgLndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2ZpbGxlcic6IHtcbiAgICAgIGZsZXg6IDFcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX3Njcm9sbGFibGUnOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICAgIG92ZXJmbG93WDogJ2hpZGRlbicsXG4gICAgICBXZWJraXRPdmVyZmxvd1Njcm9sbGluZzogJ3RvdWNoJ1xuICAgIH0sXG5cbiAgICAnJiAud2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fdHJhbnNjcmlwdCc6IHtcbiAgICAgIGxpc3RTdHlsZVR5cGU6ICdub25lJ1xuICAgIH1cbiAgfVxufTtcblxuZnVuY3Rpb24gdmFsaWRhdGVBbGxBY3Rpdml0aWVzVGFnZ2VkKGFjdGl2aXRpZXMsIGJpbnMpIHtcbiAgcmV0dXJuIGFjdGl2aXRpZXMuZXZlcnkoYWN0aXZpdHkgPT4gYmlucy5zb21lKGJpbiA9PiBiaW4uaW5jbHVkZXMoYWN0aXZpdHkpKSk7XG59XG5cbmNvbnN0IEludGVybmFsVHJhbnNjcmlwdCA9ICh7IGFjdGl2aXR5RWxlbWVudHNSZWYsIGNsYXNzTmFtZSB9KSA9PiB7XG4gIGNvbnN0IFt7IGJhc2ljVHJhbnNjcmlwdDogYmFzaWNUcmFuc2NyaXB0U3R5bGVTZXQgfV0gPSB1c2VTdHlsZVNldCgpO1xuICBjb25zdCBbXG4gICAgeyBidWJibGVGcm9tVXNlck51Yk9mZnNldCwgYnViYmxlTnViT2Zmc2V0LCBncm91cFRpbWVzdGFtcCwgaW50ZXJuYWxMaXZlUmVnaW9uRmFkZUFmdGVyLCBzaG93QXZhdGFySW5Hcm91cCB9XG4gIF0gPSB1c2VTdHlsZU9wdGlvbnMoKTtcbiAgY29uc3QgW2ZvY3VzZWRBY3Rpdml0eUtleSwgc2V0Rm9jdXNlZEFjdGl2aXR5S2V5XSA9IHVzZVN0YXRlKCk7XG4gIGNvbnN0IFthY3Rpdml0aWVzXSA9IHVzZUFjdGl2aXRpZXMoKTtcbiAgY29uc3QgW2RpcmVjdGlvbl0gPSB1c2VEaXJlY3Rpb24oKTtcbiAgY29uc3QgY3JlYXRlQWN0aXZpdHlSZW5kZXJlciA9IHVzZUNyZWF0ZUFjdGl2aXR5UmVuZGVyZXIoKTtcbiAgY29uc3QgY3JlYXRlQWN0aXZpdHlTdGF0dXNSZW5kZXJlciA9IHVzZUNyZWF0ZUFjdGl2aXR5U3RhdHVzUmVuZGVyZXIoKTtcbiAgY29uc3QgY3JlYXRlQXZhdGFyUmVuZGVyZXIgPSB1c2VDcmVhdGVBdmF0YXJSZW5kZXJlcigpO1xuICBjb25zdCBmb2N1cyA9IHVzZUZvY3VzKCk7XG4gIGNvbnN0IGdyb3VwQWN0aXZpdGllcyA9IHVzZUdyb3VwQWN0aXZpdGllcygpO1xuICBjb25zdCBsb2NhbGl6ZSA9IHVzZUxvY2FsaXplcigpO1xuICBjb25zdCByb290Q2xhc3NOYW1lID0gdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QoKShST09UX1NUWUxFKSArICcnO1xuICBjb25zdCByb290RWxlbWVudFJlZiA9IHVzZVJlZigpO1xuICBjb25zdCB0ZXJtaW5hdG9yUmVmID0gdXNlUmVmKCk7XG5cbiAgY29uc3QgYWN0aXZpdHlJbnRlcmFjdGl2ZUFsdCA9IGxvY2FsaXplKCdBQ1RJVklUWV9JTlRFUkFDVElWRV9MQUJFTF9BTFQnKTtcbiAgY29uc3QgdGVybWluYXRvclRleHQgPSBsb2NhbGl6ZSgnVFJBTlNDUklQVF9URVJNSU5BVE9SX1RFWFQnKTtcbiAgY29uc3QgdHJhbnNjcmlwdEFyaWFMYWJlbCA9IGxvY2FsaXplKCdUUkFOU0NSSVBUX0FSSUFfTEFCRUxfQUxUJyk7XG4gIGNvbnN0IHRyYW5zY3JpcHRSb2xlRGVzY3JpcHRpb24gPSBsb2NhbGl6ZSgnVFJBTlNDUklQVF9BUklBX1JPTEVfQUxUJyk7XG5cbiAgY29uc3QgaGlkZUFsbFRpbWVzdGFtcHMgPSBncm91cFRpbWVzdGFtcCA9PT0gZmFsc2U7XG5cbiAgLy8gR2V0cyByZW5kZXJlciBmb3IgZXZlcnkgYWN0aXZpdHkuXG4gIC8vIEFjdGl2aXRpZXMgdGhhdCBhcmUgbm90IHZpc2libGUgd2lsbCByZXR1cm4gYSBmYWxzeSByZW5kZXJlci5cblxuICAvLyBDb252ZXJ0ZWQgZnJvbSBjcmVhdGVBY3Rpdml0eVJlbmRlcmVyKHsgYWN0aXZpdHksIG5leHRWaXNpYmxlQWN0aXZpdHkgfSkgdG8gY3JlYXRlQWN0aXZpdHlSZW5kZXJlcihhY3Rpdml0eSwgbmV4dFZpc2libGVBY3Rpdml0eSkuXG4gIC8vIFRoaXMgaXMgZm9yIHRoZSBtZW1vaXphdGlvbiBmdW5jdGlvbiB0byBjYWNoZSB0aGUgYXJndW1lbnRzLiBNZW1vaXplciBjYW4gb25seSBjYWNoZSBsaXRlcmFsIGFyZ3VtZW50cy5cbiAgY29uc3QgY3JlYXRlQWN0aXZpdHlSZW5kZXJlcldpdGhMaXRlcmFsQXJncyA9IHVzZUNhbGxiYWNrKFxuICAgIChhY3Rpdml0eSwgbmV4dFZpc2libGVBY3Rpdml0eSkgPT4gY3JlYXRlQWN0aXZpdHlSZW5kZXJlcih7IGFjdGl2aXR5LCBuZXh0VmlzaWJsZUFjdGl2aXR5IH0pLFxuICAgIFtjcmVhdGVBY3Rpdml0eVJlbmRlcmVyXVxuICApO1xuXG4gIC8vIENyZWF0ZSBhIG1lbW9pemVkIGNvbnRleHQgb2YgdGhlIGNyZWF0ZUFjdGl2aXR5UmVuZGVyZXIgZnVuY3Rpb24uXG4gIGNvbnN0IGFjdGl2aXRpZXNXaXRoUmVuZGVyZXIgPSB1c2VNZW1vaXplKFxuICAgIGNyZWF0ZUFjdGl2aXR5UmVuZGVyZXJXaXRoTGl0ZXJhbEFyZ3MsXG4gICAgY3JlYXRlQWN0aXZpdHlSZW5kZXJlcldpdGhMaXRlcmFsQXJnc01lbW9pemVkID0+IHtcbiAgICAgIC8vIEFsbCBjYWxscyB0byBjcmVhdGVBY3Rpdml0eVJlbmRlcmVyV2l0aExpdGVyYWxBcmdzTWVtb2l6ZWQoKSBpbiB0aGlzIGZ1bmN0aW9uIHdpbGwgYmUgbWVtb2l6ZWQgKExSVSA9IDEpLlxuICAgICAgLy8gSW4gdGhlIG5leHQgcmVuZGVyIGN5Y2xlLCBjYWxscyB0byBjcmVhdGVBY3Rpdml0eVJlbmRlcmVyV2l0aExpdGVyYWxBcmdzTWVtb2l6ZWQoKSBtaWdodCByZXR1cm4gdGhlIG1lbW9pemVkIHJlc3VsdCBpbnN0ZWFkLlxuICAgICAgLy8gVGhpcyBpcyBhbiBpbXByb3ZlbWVudCB0byBSZWFjdCB1c2VNZW1vKCksIGJlY2F1c2UgaXQgb25seSBhbGxvd3MgMSBtZW1vaXphdGlvbi5cbiAgICAgIC8vIHVzZU1lbW9pemUoKSBhbGxvd3MgYW55IG51bWJlciBvZiBtZW1vaXphdGlvbi5cblxuICAgICAgY29uc3QgYWN0aXZpdGllc1dpdGhSZW5kZXJlciA9IFtdO1xuICAgICAgbGV0IG5leHRWaXNpYmxlQWN0aXZpdHk7XG5cbiAgICAgIGZvciAobGV0IGluZGV4ID0gYWN0aXZpdGllcy5sZW5ndGggLSAxOyBpbmRleCA+PSAwOyBpbmRleC0tKSB7XG4gICAgICAgIGNvbnN0IGFjdGl2aXR5ID0gYWN0aXZpdGllc1tpbmRleF07XG4gICAgICAgIGNvbnN0IHJlbmRlckFjdGl2aXR5ID0gY3JlYXRlQWN0aXZpdHlSZW5kZXJlcldpdGhMaXRlcmFsQXJnc01lbW9pemVkKGFjdGl2aXR5LCBuZXh0VmlzaWJsZUFjdGl2aXR5KTtcblxuICAgICAgICBpZiAocmVuZGVyQWN0aXZpdHkpIHtcbiAgICAgICAgICBhY3Rpdml0aWVzV2l0aFJlbmRlcmVyLnNwbGljZSgwLCAwLCB7XG4gICAgICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgICAgIHJlbmRlckFjdGl2aXR5XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBuZXh0VmlzaWJsZUFjdGl2aXR5ID0gYWN0aXZpdHk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFjdGl2aXRpZXNXaXRoUmVuZGVyZXI7XG4gICAgfSxcbiAgICBbYWN0aXZpdGllc11cbiAgKTtcblxuICBjb25zdCB2aXNpYmxlQWN0aXZpdGllcyA9IHVzZU1lbW8oKCkgPT4gYWN0aXZpdGllc1dpdGhSZW5kZXJlci5tYXAoKHsgYWN0aXZpdHkgfSkgPT4gYWN0aXZpdHkpLCBbXG4gICAgYWN0aXZpdGllc1dpdGhSZW5kZXJlclxuICBdKTtcblxuICAvLyBUYWcgYWN0aXZpdGllcyBiYXNlZCBvbiB0eXBlcy5cbiAgLy8gVGhlIGRlZmF1bHQgaW1wbGVtZW50YXRpb24gdGFnIGludG8gMiB0eXBlczogc2VuZGVyIGFuZCBzdGF0dXMuXG5cbiAgY29uc3QgeyBhY3Rpdml0aWVzR3JvdXBCeVNlbmRlciwgYWN0aXZpdGllc0dyb3VwQnlTdGF0dXMgfSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IHsgc2VuZGVyOiBhY3Rpdml0aWVzR3JvdXBCeVNlbmRlciwgc3RhdHVzOiBhY3Rpdml0aWVzR3JvdXBCeVN0YXR1cyB9ID0gZ3JvdXBBY3Rpdml0aWVzKHtcbiAgICAgIGFjdGl2aXRpZXM6IHZpc2libGVBY3Rpdml0aWVzXG4gICAgfSk7XG5cbiAgICBpZiAoIXZhbGlkYXRlQWxsQWN0aXZpdGllc1RhZ2dlZCh2aXNpYmxlQWN0aXZpdGllcywgYWN0aXZpdGllc0dyb3VwQnlTZW5kZXIpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdib3RmcmFtZXdvcmstd2ViY2hhdDogTm90IGV2ZXJ5IGFjdGl2aXRpZXMgYXJlIGdyb3VwZWQgaW4gdGhlIFwic2VuZGVyXCIgcHJvcGVydHkuIFBsZWFzZSBmaXggXCJncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlXCIgYW5kIGdyb3VwIGV2ZXJ5IGFjdGl2aXRpZXMuJ1xuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIXZhbGlkYXRlQWxsQWN0aXZpdGllc1RhZ2dlZCh2aXNpYmxlQWN0aXZpdGllcywgYWN0aXZpdGllc0dyb3VwQnlTdGF0dXMpKSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdib3RmcmFtZXdvcmstd2ViY2hhdDogTm90IGV2ZXJ5IGFjdGl2aXRpZXMgYXJlIGdyb3VwZWQgaW4gdGhlIFwic3RhdHVzXCIgcHJvcGVydHkuIFBsZWFzZSBmaXggXCJncm91cEFjdGl2aXRpZXNNaWRkbGV3YXJlXCIgYW5kIGdyb3VwIGV2ZXJ5IGFjdGl2aXRpZXMuJ1xuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgYWN0aXZpdGllc0dyb3VwQnlTZW5kZXIsXG4gICAgICBhY3Rpdml0aWVzR3JvdXBCeVN0YXR1c1xuICAgIH07XG4gIH0sIFtncm91cEFjdGl2aXRpZXMsIHZpc2libGVBY3Rpdml0aWVzXSk7XG5cbiAgLy8gQ3JlYXRlIGEgdHJlZSBvZiBhY3Rpdml0aWVzIHdpdGggMiBkaW1lbnNpb25zOiBzZW5kZXIsIGZvbGxvd2VkIGJ5IHN0YXR1cy5cblxuICBjb25zdCBhY3Rpdml0eVRyZWUgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCB2aXNpYmxlQWN0aXZpdGllc1BlbmRpbmdHcm91cGluZyA9IFsuLi52aXNpYmxlQWN0aXZpdGllc107XG4gICAgY29uc3QgYWN0aXZpdHlUcmVlID0gW107XG5cbiAgICB3aGlsZSAodmlzaWJsZUFjdGl2aXRpZXNQZW5kaW5nR3JvdXBpbmcubGVuZ3RoKSB7XG4gICAgICBjb25zdCBbYWN0aXZpdHldID0gdmlzaWJsZUFjdGl2aXRpZXNQZW5kaW5nR3JvdXBpbmc7XG4gICAgICBjb25zdCBzZW5kZXJUcmVlID0gW107XG4gICAgICBjb25zdCBhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXIgPSBhY3Rpdml0aWVzR3JvdXBCeVNlbmRlci5maW5kKGFjdGl2aXRpZXMgPT4gYWN0aXZpdGllcy5pbmNsdWRlcyhhY3Rpdml0eSkpO1xuXG4gICAgICBhY3Rpdml0eVRyZWUucHVzaChzZW5kZXJUcmVlKTtcblxuICAgICAgYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyLmZvckVhY2goYWN0aXZpdHkgPT4ge1xuICAgICAgICBjb25zdCBhY3Rpdml0aWVzV2l0aFNhbWVTdGF0dXMgPSBhY3Rpdml0aWVzR3JvdXBCeVN0YXR1cy5maW5kKGFjdGl2aXRpZXMgPT4gYWN0aXZpdGllcy5pbmNsdWRlcyhhY3Rpdml0eSkpO1xuXG4gICAgICAgIGNvbnN0IGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlckFuZFN0YXR1cyA9IGludGVyc2VjdGlvbk9mKFxuICAgICAgICAgIHZpc2libGVBY3Rpdml0aWVzUGVuZGluZ0dyb3VwaW5nLFxuICAgICAgICAgIGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlcixcbiAgICAgICAgICBhY3Rpdml0aWVzV2l0aFNhbWVTdGF0dXNcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyQW5kU3RhdHVzLmxlbmd0aCkge1xuICAgICAgICAgIHNlbmRlclRyZWUucHVzaChhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXJBbmRTdGF0dXMpO1xuICAgICAgICAgIHJlbW92ZUlubGluZSh2aXNpYmxlQWN0aXZpdGllc1BlbmRpbmdHcm91cGluZywgLi4uYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyQW5kU3RhdHVzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gQXNzZXJ0aW9uOiBBbGwgYWN0aXZpdGllcyBpbiB2aXNpYmxlQWN0aXZpdGllcywgbXVzdCBiZSBhc3NpZ25lZCB0byB0aGUgYWN0aXZpdHlUcmVlXG4gICAgaWYgKFxuICAgICAgIXZpc2libGVBY3Rpdml0aWVzLmV2ZXJ5KGFjdGl2aXR5ID0+XG4gICAgICAgIGFjdGl2aXR5VHJlZS5zb21lKGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlciA9PlxuICAgICAgICAgIGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlci5zb21lKGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlckFuZFN0YXR1cyA9PlxuICAgICAgICAgICAgYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyQW5kU3RhdHVzLmluY2x1ZGVzKGFjdGl2aXR5KVxuICAgICAgICAgIClcbiAgICAgICAgKVxuICAgICAgKVxuICAgICkge1xuICAgICAgY29uc29sZS53YXJuKCdib3RmcmFtZXdvcmstd2ViY2hhdCBpbnRlcm5hbDogTm90IGFsbCB2aXNpYmxlIGFjdGl2aXRpZXMgYXJlIGdyb3VwZWQgaW4gdGhlIGFjdGl2aXR5VHJlZS4nLCB7XG4gICAgICAgIHZpc2libGVBY3Rpdml0aWVzLFxuICAgICAgICBhY3Rpdml0eVRyZWVcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBhY3Rpdml0eVRyZWU7XG4gIH0sIFthY3Rpdml0aWVzR3JvdXBCeVNlbmRlciwgYWN0aXZpdGllc0dyb3VwQnlTdGF0dXMsIHZpc2libGVBY3Rpdml0aWVzXSk7XG5cbiAgLy8gRmxhdHRlbiB0aGUgdHJlZSBiYWNrIGludG8gYW4gYXJyYXkgd2l0aCBpbmZvcm1hdGlvbiByZWxhdGVkIHRvIHJlbmRlcmluZy5cblxuICBjb25zdCByZW5kZXJpbmdFbGVtZW50cyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IHJlbmRlcmluZ0VsZW1lbnRzID0gW107XG4gICAgY29uc3QgdG9wU2lkZUJvdE51YiA9IGlzWmVyb09yUG9zaXRpdmUoYnViYmxlTnViT2Zmc2V0KTtcbiAgICBjb25zdCB0b3BTaWRlVXNlck51YiA9IGlzWmVyb09yUG9zaXRpdmUoYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQpO1xuXG4gICAgYWN0aXZpdHlUcmVlLmZvckVhY2goYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyID0+IHtcbiAgICAgIGNvbnN0IFtbZmlyc3RBY3Rpdml0eV1dID0gYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyO1xuICAgICAgY29uc3QgcmVuZGVyQXZhdGFyID0gY3JlYXRlQXZhdGFyUmVuZGVyZXIoeyBhY3Rpdml0eTogZmlyc3RBY3Rpdml0eSB9KTtcblxuICAgICAgYWN0aXZpdGllc1dpdGhTYW1lU2VuZGVyLmZvckVhY2goKGFjdGl2aXRpZXNXaXRoU2FtZVNlbmRlckFuZFN0YXR1cywgaW5kZXhXaXRoaW5TZW5kZXJHcm91cCkgPT4ge1xuICAgICAgICBjb25zdCBmaXJzdEluU2VuZGVyR3JvdXAgPSAhaW5kZXhXaXRoaW5TZW5kZXJHcm91cDtcbiAgICAgICAgY29uc3QgbGFzdEluU2VuZGVyR3JvdXAgPSBpbmRleFdpdGhpblNlbmRlckdyb3VwID09PSBhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXIubGVuZ3RoIC0gMTtcblxuICAgICAgICBhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXJBbmRTdGF0dXMuZm9yRWFjaCgoYWN0aXZpdHksIGluZGV4V2l0aGluU2VuZGVyQW5kU3RhdHVzR3JvdXApID0+IHtcbiAgICAgICAgICAvLyBXZSBvbmx5IHNob3cgdGhlIHRpbWVzdGFtcCBhdCB0aGUgZW5kIG9mIHRoZSBzZW5kZXIgZ3JvdXAuIEJ1dCB3ZSBhbHdheXMgc2hvdyB0aGUgXCJTZW5kIGZhaWxlZCwgcmV0cnlcIiBwcm9tcHQuXG4gICAgICAgICAgY29uc3QgcmVuZGVyQWN0aXZpdHlTdGF0dXMgPSBjcmVhdGVBY3Rpdml0eVN0YXR1c1JlbmRlcmVyKHtcbiAgICAgICAgICAgIGFjdGl2aXR5XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBjb25zdCBmaXJzdEluU2VuZGVyQW5kU3RhdHVzR3JvdXAgPSAhaW5kZXhXaXRoaW5TZW5kZXJBbmRTdGF0dXNHcm91cDtcbiAgICAgICAgICBjb25zdCBsYXN0SW5TZW5kZXJBbmRTdGF0dXNHcm91cCA9XG4gICAgICAgICAgICBpbmRleFdpdGhpblNlbmRlckFuZFN0YXR1c0dyb3VwID09PSBhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXJBbmRTdGF0dXMubGVuZ3RoIC0gMTtcblxuICAgICAgICAgIGNvbnN0IHsgcmVuZGVyQWN0aXZpdHkgfSA9IGFjdGl2aXRpZXNXaXRoUmVuZGVyZXIuZmluZChlbnRyeSA9PiBlbnRyeS5hY3Rpdml0eSA9PT0gYWN0aXZpdHkpO1xuICAgICAgICAgIGNvbnN0IGtleSA9IGdldEFjdGl2aXR5VW5pcXVlSWQoYWN0aXZpdHkpIHx8IHJlbmRlcmluZ0VsZW1lbnRzLmxlbmd0aDtcbiAgICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBjaGFubmVsRGF0YTogeyBtZXNzYWdlQmFjazogeyBkaXNwbGF5VGV4dDogbWVzc2FnZUJhY2tEaXNwbGF5VGV4dCB9ID0ge30gfSA9IHt9LFxuICAgICAgICAgICAgZnJvbTogeyByb2xlIH0sXG4gICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgfSA9IGFjdGl2aXR5O1xuXG4gICAgICAgICAgY29uc3QgdG9wU2lkZU51YiA9IHJvbGUgPT09ICd1c2VyJyA/IHRvcFNpZGVVc2VyTnViIDogdG9wU2lkZUJvdE51YjtcblxuICAgICAgICAgIGxldCBzaG93Q2FsbG91dDtcblxuICAgICAgICAgIC8vIERlcGVuZGluZyBvbiB0aGUgXCJzaG93QXZhdGFySW5Hcm91cFwiIHNldHRpbmcsIHRoZSBhdmF0YXIgd2lsbCByZW5kZXIgaW4gZGlmZmVyZW50IHBvc2l0aW9ucy5cbiAgICAgICAgICBpZiAoc2hvd0F2YXRhckluR3JvdXAgPT09ICdzZW5kZXInKSB7XG4gICAgICAgICAgICBpZiAodG9wU2lkZU51Yikge1xuICAgICAgICAgICAgICBzaG93Q2FsbG91dCA9IGZpcnN0SW5TZW5kZXJHcm91cCAmJiBmaXJzdEluU2VuZGVyQW5kU3RhdHVzR3JvdXA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBzaG93Q2FsbG91dCA9IGxhc3RJblNlbmRlckdyb3VwICYmIGxhc3RJblNlbmRlckFuZFN0YXR1c0dyb3VwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSBpZiAoc2hvd0F2YXRhckluR3JvdXAgPT09ICdzdGF0dXMnKSB7XG4gICAgICAgICAgICBpZiAodG9wU2lkZU51Yikge1xuICAgICAgICAgICAgICBzaG93Q2FsbG91dCA9IGZpcnN0SW5TZW5kZXJBbmRTdGF0dXNHcm91cDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNob3dDYWxsb3V0ID0gbGFzdEluU2VuZGVyQW5kU3RhdHVzR3JvdXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNob3dDYWxsb3V0ID0gdHJ1ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBmb2N1c0FjdGl2aXR5ID0gKCkgPT4ge1xuICAgICAgICAgICAgc2V0Rm9jdXNlZEFjdGl2aXR5S2V5KGdldEFjdGl2aXR5VW5pcXVlSWQoYWN0aXZpdHkpKTtcblxuICAgICAgICAgICAgLy8gSUUxMSBuZWVkIHRvIG1hbnVhbGx5IGZvY3VzIG9uIHRoZSB0cmFuc2NyaXB0LlxuICAgICAgICAgICAgY29uc3QgeyBjdXJyZW50OiByb290RWxlbWVudCB9ID0gcm9vdEVsZW1lbnRSZWY7XG5cbiAgICAgICAgICAgIHJvb3RFbGVtZW50ICYmIHJvb3RFbGVtZW50LmZvY3VzKCk7XG4gICAgICAgICAgfTtcblxuICAgICAgICAgIHJlbmRlcmluZ0VsZW1lbnRzLnB1c2goe1xuICAgICAgICAgICAgYWN0aXZpdHksXG5cbiAgICAgICAgICAgIC8vIEFmdGVyIHRoZSBlbGVtZW50IGlzIG1vdW50ZWQsIHNldCBpdCB0byBhY3Rpdml0eUVsZW1lbnRzUmVmLlxuICAgICAgICAgICAgY2FsbGJhY2tSZWY6IGFjdGl2aXR5RWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYWN0aXZpdHlFbGVtZW50c1JlZi5jdXJyZW50LmZpbmQoKHsgYWN0aXZpdHlJRCB9KSA9PiBhY3Rpdml0eUlEID09PSBhY3Rpdml0eS5pZCk7XG5cbiAgICAgICAgICAgICAgaWYgKGVudHJ5KSB7XG4gICAgICAgICAgICAgICAgZW50cnkuZWxlbWVudCA9IGFjdGl2aXR5RWxlbWVudDtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gQ2FsbGluZyB0aGlzIGZ1bmN0aW9uIHdpbGwgcHV0IHRoZSBmb2N1cyBvbiB0aGUgdHJhbnNjcmlwdCBhbmQgdGhlIGFjdGl2aXR5LlxuICAgICAgICAgICAgZm9jdXNBY3Rpdml0eSxcblxuICAgICAgICAgICAgLy8gV2hlbiBhIGNoaWxkIG9mIHRoZSBhY3Rpdml0eSByZWNlaXZlcyBmb2N1cywgbm90aWZ5IHRoZSB0cmFuc2NyaXB0IHRvIHNldCB0aGUgYXJpYS1hY3RpdmVkZXNjZW5kYW50IHRvIHRoaXMgYWN0aXZpdHkuXG4gICAgICAgICAgICBoYW5kbGVGb2N1czogKCkgPT4ge1xuICAgICAgICAgICAgICBzZXRGb2N1c2VkQWN0aXZpdHlLZXkoZ2V0QWN0aXZpdHlVbmlxdWVJZChhY3Rpdml0eSkpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaGFuZGxlS2V5RG93bjogZXZlbnQgPT4ge1xuICAgICAgICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICBzZXRGb2N1c2VkQWN0aXZpdHlLZXkoZ2V0QWN0aXZpdHlVbmlxdWVJZChhY3Rpdml0eSkpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgeyBjdXJyZW50IH0gPSByb290RWxlbWVudFJlZjtcblxuICAgICAgICAgICAgICAgIGN1cnJlbnQgJiYgY3VycmVudC5mb2N1cygpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyBGb3IgYWNjZXNzaWJpbGl0eTogd2hlbiB0aGUgdXNlciBwcmVzcyB1cC9kb3duIGFycm93IGtleXMsIHdlIHB1dCBhIHZpc3VhbCBmb2N1cyBpbmRpY2F0b3IgYXJvdW5kIHRoZSBmb2N1c2VkIGFjdGl2aXR5LlxuICAgICAgICAgICAgLy8gV2Ugc2hvdWxkIGRvIHRoZSBzYW1lIGZvciBtb3VzZSwgdGhhdCBpcyB3aHkgd2UgaGF2ZSB0aGUgY2xpY2sgaGFuZGxlciBoZXJlLlxuICAgICAgICAgICAgLy8gV2UgYXJlIGRvaW5nIGl0IGluIGV2ZW50IGNhcHR1cmUgcGhhc2UgdG8gcHJldmVudCBvdGhlciBjb21wb25lbnRzIGZyb20gc3RvcHBpbmcgZXZlbnQgcHJvcGFnYXRpb24gdG8gdXMuXG4gICAgICAgICAgICBoYW5kbGVNb3VzZURvd25DYXB0dXJlOiAoeyB0YXJnZXQgfSkgPT4ge1xuICAgICAgICAgICAgICBjb25zdCB0YWJJbmRleCA9IGdldFRhYkluZGV4KHRhcmdldCk7XG5cbiAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0YWJJbmRleCAhPT0gJ251bWJlcicgfHwgdGFiSW5kZXggPCAwIHx8IHRhcmdldC5nZXRBdHRyaWJ1dGUoJ2FyaWEtZGlzYWJsZWQnKSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgZm9jdXNBY3Rpdml0eSgpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAvLyBcImhpZGVUaW1lc3RhbXBcIiBpcyBhIHJlbmRlci10aW1lIHBhcmFtZXRlciBmb3IgcmVuZGVyQWN0aXZpdHlTdGF0dXMoKS5cbiAgICAgICAgICAgIC8vIElmIHRydWUsIGl0IHdpbGwgaGlkZSB0aGUgdGltZXN0YW1wLCBidXQgaXQgd2lsbCBjb250aW51ZSB0byBzaG93IHRoZVxuICAgICAgICAgICAgLy8gcmV0cnkgcHJvbXB0LiBBbmQgc2hvdyB0aGUgc2NyZWVuIHJlYWRlciB2ZXJzaW9uIG9mIHRoZSB0aW1lc3RhbXAuXG4gICAgICAgICAgICBoaWRlVGltZXN0YW1wOlxuICAgICAgICAgICAgICBoaWRlQWxsVGltZXN0YW1wcyB8fCBpbmRleFdpdGhpblNlbmRlckFuZFN0YXR1c0dyb3VwICE9PSBhY3Rpdml0aWVzV2l0aFNhbWVTZW5kZXJBbmRTdGF0dXMubGVuZ3RoIC0gMSxcbiAgICAgICAgICAgIGtleSxcblxuICAgICAgICAgICAgLy8gV2hlbiBcImxpdmVSZWdpb25LZXlcIiBjaGFuZ2VzLCBpdCB3aWxsIHNob3cgdXAgaW4gdGhlIGxpdmUgcmVnaW9uIG1vbWVudGFyaWx5LlxuICAgICAgICAgICAgbGl2ZVJlZ2lvbktleToga2V5ICsgJ3wnICsgKG1lc3NhZ2VCYWNrRGlzcGxheVRleHQgfHwgdGV4dCksXG4gICAgICAgICAgICByZW5kZXJBY3Rpdml0eSxcbiAgICAgICAgICAgIHJlbmRlckFjdGl2aXR5U3RhdHVzLFxuICAgICAgICAgICAgcmVuZGVyQXZhdGFyLFxuICAgICAgICAgICAgcm9sZSxcblxuICAgICAgICAgICAgLy8gVE9ETzogW1AyXSAjMjg1OCBXZSBzaG91bGQgdXNlIGNvcmUvZGVmaW5pdGlvbnMvc3BlYWtpbmdBY3Rpdml0eSBmb3IgdGhpcyBwcmVkaWNhdGUgaW5zdGVhZFxuICAgICAgICAgICAgc2hvdWxkU3BlYWs6IGFjdGl2aXR5LmNoYW5uZWxEYXRhICYmIGFjdGl2aXR5LmNoYW5uZWxEYXRhLnNwZWFrLFxuICAgICAgICAgICAgc2hvd0NhbGxvdXRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHsgY3VycmVudDogYWN0aXZpdHlFbGVtZW50cyB9ID0gYWN0aXZpdHlFbGVtZW50c1JlZjtcblxuICAgIC8vIFVwZGF0ZSBhY3Rpdml0eUVsZW1lbnRSZWYgd2l0aCBuZXcgc2V0cyBvZiBhY3Rpdml0eSwgd2hpbGUgcmV0YWluaW5nIHRoZSBleGlzdGluZyByZWZlcmVuY2luZyBlbGVtZW50IGlmIGV4aXN0cy5cbiAgICBhY3Rpdml0eUVsZW1lbnRzUmVmLmN1cnJlbnQgPSByZW5kZXJpbmdFbGVtZW50cy5tYXAoKHsgYWN0aXZpdHksIGFjdGl2aXR5OiB7IGlkIH0sIGVsZW1lbnRJZCwga2V5IH0pID0+IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRW50cnkgPSBhY3Rpdml0eUVsZW1lbnRzLmZpbmQoZW50cnkgPT4gZW50cnkua2V5ID09PSBrZXkpO1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgYWN0aXZpdHlJRDogaWQsXG4gICAgICAgIGFyaWFMYWJlbElEOiBleGlzdGluZ0VudHJ5XG4gICAgICAgICAgPyBleGlzdGluZ0VudHJ5LmFyaWFMYWJlbElEXG4gICAgICAgICAgOiBgd2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fYWN0aXZpdHktbGFiZWwtJHtyYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDUpfWAsXG4gICAgICAgIGVsZW1lbnQ6IGV4aXN0aW5nRW50cnkgJiYgZXhpc3RpbmdFbnRyeS5lbGVtZW50LFxuICAgICAgICBlbGVtZW50SWQsXG4gICAgICAgIGtleVxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIC8vIFRoZXJlIG11c3QgYmUgb25lIGZvY3VzZWQgKGEuay5hLiBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQpIGRlc2lnbmF0ZWQuIFdlIGRlZmF1bHQgaXQgdG8gdGhlIGxhc3Qgb25lLlxuICAgIGlmICghcmVuZGVyaW5nRWxlbWVudHMuZmluZCgoeyBmb2N1c2VkIH0pID0+IGZvY3VzZWQpKSB7XG4gICAgICBjb25zdCBsYXN0RWxlbWVudCA9IHJlbmRlcmluZ0VsZW1lbnRzW3JlbmRlcmluZ0VsZW1lbnRzLmxlbmd0aCAtIDFdO1xuXG4gICAgICBpZiAobGFzdEVsZW1lbnQpIHtcbiAgICAgICAgbGFzdEVsZW1lbnQuZm9jdXNlZCA9IHRydWU7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlbmRlcmluZ0VsZW1lbnRzO1xuICB9LCBbXG4gICAgYWN0aXZpdGllc1dpdGhSZW5kZXJlcixcbiAgICBhY3Rpdml0eUVsZW1lbnRzUmVmLFxuICAgIGFjdGl2aXR5VHJlZSxcbiAgICBidWJibGVGcm9tVXNlck51Yk9mZnNldCxcbiAgICBidWJibGVOdWJPZmZzZXQsXG4gICAgY3JlYXRlQWN0aXZpdHlTdGF0dXNSZW5kZXJlcixcbiAgICBjcmVhdGVBdmF0YXJSZW5kZXJlcixcbiAgICBoaWRlQWxsVGltZXN0YW1wcyxcbiAgICByb290RWxlbWVudFJlZixcbiAgICBzaG93QXZhdGFySW5Hcm91cFxuICBdKTtcblxuICBjb25zdCByZW5kZXJpbmdBY3Rpdml0aWVzID0gdXNlTWVtbygoKSA9PiByZW5kZXJpbmdFbGVtZW50cy5tYXAoKHsgYWN0aXZpdHkgfSkgPT4gYWN0aXZpdHkpLCBbcmVuZGVyaW5nRWxlbWVudHNdKTtcblxuICBjb25zdCBzY3JvbGxUb0JvdHRvbVNjcm9sbFRvID0gdXNlU2Nyb2xsVG8oKTtcbiAgY29uc3Qgc2Nyb2xsVG9Cb3R0b21TY3JvbGxUb0VuZCA9IHVzZVNjcm9sbFRvRW5kKCk7XG5cbiAgY29uc3Qgc2Nyb2xsVG8gPSB1c2VDYWxsYmFjayhcbiAgICAocG9zaXRpb24sIHsgYmVoYXZpb3IgPSAnYXV0bycgfSA9IHt9KSA9PiB7XG4gICAgICBpZiAoIXBvc2l0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICAnYm90ZnJhbWV3b3JrLXdlYmNoYXQ6IEZpcnN0IGFyZ3VtZW50IHBhc3NlZCB0byBcInVzZVNjcm9sbFRvXCIgbXVzdCBiZSBhIFNjcm9sbFBvc2l0aW9uIG9iamVjdC4nXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHsgYWN0aXZpdHlJRCwgc2Nyb2xsVG9wIH0gPSBwb3NpdGlvbjtcblxuICAgICAgaWYgKHR5cGVvZiBzY3JvbGxUb3AgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHNjcm9sbFRvQm90dG9tU2Nyb2xsVG8oc2Nyb2xsVG9wLCB7IGJlaGF2aW9yIH0pO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYWN0aXZpdHlJRCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgY29uc3QgeyBjdXJyZW50OiByb290RWxlbWVudCB9ID0gcm9vdEVsZW1lbnRSZWY7XG4gICAgICAgIGNvbnN0IHsgZWxlbWVudDogYWN0aXZpdHlFbGVtZW50IH0gPVxuICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHNSZWYuY3VycmVudC5maW5kKGVudHJ5ID0+IGVudHJ5LmFjdGl2aXR5SUQgPT09IGFjdGl2aXR5SUQpIHx8IHt9O1xuXG4gICAgICAgIGNvbnN0IHNjcm9sbGFibGVFbGVtZW50ID0gcm9vdEVsZW1lbnQucXVlcnlTZWxlY3RvcignLndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX3Njcm9sbGFibGUnKTtcblxuICAgICAgICBpZiAoc2Nyb2xsYWJsZUVsZW1lbnQgJiYgYWN0aXZpdHlFbGVtZW50KSB7XG4gICAgICAgICAgY29uc3QgW3sgaGVpZ2h0OiBhY3Rpdml0eUVsZW1lbnRIZWlnaHQsIHk6IGFjdGl2aXR5RWxlbWVudFkgfV0gPSBhY3Rpdml0eUVsZW1lbnQuZ2V0Q2xpZW50UmVjdHMoKTtcbiAgICAgICAgICBjb25zdCBbeyBoZWlnaHQ6IHNjcm9sbGFibGVIZWlnaHQgfV0gPSBzY3JvbGxhYmxlRWxlbWVudC5nZXRDbGllbnRSZWN0cygpO1xuXG4gICAgICAgICAgY29uc3QgYWN0aXZpdHlFbGVtZW50T2Zmc2V0VG9wID0gYWN0aXZpdHlFbGVtZW50WSArIHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFRvcDtcblxuICAgICAgICAgIGNvbnN0IHNjcm9sbFRvcCA9IE1hdGgubWluKFxuICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50T2Zmc2V0VG9wLFxuICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50T2Zmc2V0VG9wIC0gc2Nyb2xsYWJsZUhlaWdodCArIGFjdGl2aXR5RWxlbWVudEhlaWdodFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBzY3JvbGxUb0JvdHRvbVNjcm9sbFRvKHNjcm9sbFRvcCwgeyBiZWhhdmlvciB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW2FjdGl2aXR5RWxlbWVudHNSZWYsIHJvb3RFbGVtZW50UmVmLCBzY3JvbGxUb0JvdHRvbVNjcm9sbFRvXVxuICApO1xuXG4gIGNvbnN0IHNjcm9sbFJlbGF0aXZlID0gdXNlQ2FsbGJhY2soXG4gICAgKGRpcmVjdGlvbiwgeyBkaXNwbGFjZW1lbnQgfSA9IHt9KSA9PiB7XG4gICAgICBjb25zdCB7IGN1cnJlbnQ6IHJvb3RFbGVtZW50IH0gPSByb290RWxlbWVudFJlZjtcblxuICAgICAgaWYgKCFyb290RWxlbWVudCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHNjcm9sbGFibGUgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcud2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fc2Nyb2xsYWJsZScpO1xuICAgICAgbGV0IG5leHRTY3JvbGxUb3A7XG5cbiAgICAgIGlmICh0eXBlb2YgZGlzcGxhY2VtZW50ID09PSAnbnVtYmVyJykge1xuICAgICAgICBuZXh0U2Nyb2xsVG9wID0gc2Nyb2xsYWJsZS5zY3JvbGxUb3AgKyAoZGlyZWN0aW9uID09PSAnZG93bicgPyAxIDogLTEpICogZGlzcGxhY2VtZW50O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dFNjcm9sbFRvcCA9IHNjcm9sbGFibGUuc2Nyb2xsVG9wICsgKGRpcmVjdGlvbiA9PT0gJ2Rvd24nID8gMSA6IC0xKSAqIHNjcm9sbGFibGUub2Zmc2V0SGVpZ2h0O1xuICAgICAgfVxuXG4gICAgICBzY3JvbGxUbyhcbiAgICAgICAge1xuICAgICAgICAgIHNjcm9sbFRvcDogTWF0aC5tYXgoMCwgTWF0aC5taW4oc2Nyb2xsYWJsZS5zY3JvbGxIZWlnaHQgLSBzY3JvbGxhYmxlLm9mZnNldEhlaWdodCwgbmV4dFNjcm9sbFRvcCkpXG4gICAgICAgIH0sXG4gICAgICAgIHsgYmVoYXZpb3I6ICdzbW9vdGgnIH1cbiAgICAgICk7XG4gICAgfSxcbiAgICBbcm9vdEVsZW1lbnRSZWYsIHNjcm9sbFRvXVxuICApO1xuXG4gIC8vIFNpbmNlIHRoZXJlIGNvdWxkIGJlIG11bHRpcGxlIGluc3RhbmNlcyBvZiA8QmFzaWNUcmFuc2NyaXB0PiBpbnNpZGUgdGhlIDxDb21wb3Nlcj4sIHdoZW4gdGhlIGRldmVsb3BlciBjYWxscyBgc2Nyb2xsWFhYYCwgd2UgbmVlZCB0byBjYWxsIGl0IG9uIGFsbCBpbnN0YW5jZXMuXG4gIC8vIFdlIGNhbGwgYHVzZVJlZ2lzdGVyU2Nyb2xsWFhYYCB0byByZWdpc3RlciBhIGNhbGxiYWNrIGZ1bmN0aW9uLCB0aGUgYHVzZVNjcm9sbFhYWGAgd2lsbCBtdWx0aXBsZXggdGhlIGNhbGwgaW50byBlYWNoIGluc3RhbmNlIG9mIDxCYXNpY1RyYW5zY3JpcHQ+LlxuICB1c2VSZWdpc3RlclNjcm9sbFRvKHNjcm9sbFRvKTtcbiAgdXNlUmVnaXN0ZXJTY3JvbGxUb0VuZChzY3JvbGxUb0JvdHRvbVNjcm9sbFRvRW5kKTtcbiAgdXNlUmVnaXN0ZXJTY3JvbGxSZWxhdGl2ZShzY3JvbGxSZWxhdGl2ZSk7XG5cbiAgY29uc3QgZGlzcGF0Y2hTY3JvbGxQb3NpdGlvbiA9IHVzZURpc3BhdGNoU2Nyb2xsUG9zaXRpb24oKTtcbiAgY29uc3QgcGF0Y2hlZERpc3BhdGNoU2Nyb2xsUG9zaXRpb24gPSB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoIWRpc3BhdGNoU2Nyb2xsUG9zaXRpb24pIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICByZXR1cm4gKHsgc2Nyb2xsVG9wIH0pID0+IHtcbiAgICAgIGNvbnN0IHsgY3VycmVudDogcm9vdEVsZW1lbnQgfSA9IHJvb3RFbGVtZW50UmVmO1xuXG4gICAgICBpZiAoIXJvb3RFbGVtZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2Nyb2xsYWJsZUVsZW1lbnQgPSByb290RWxlbWVudC5xdWVyeVNlbGVjdG9yKCcud2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fc2Nyb2xsYWJsZScpO1xuXG4gICAgICBjb25zdCBbeyBoZWlnaHQ6IG9mZnNldEhlaWdodCB9ID0ge31dID0gc2Nyb2xsYWJsZUVsZW1lbnQuZ2V0Q2xpZW50UmVjdHMoKTtcblxuICAgICAgLy8gRmluZCB0aGUgYWN0aXZpdHkganVzdCBhYm92ZSBzY3JvbGwgdmlldyBib3R0b20uXG4gICAgICAvLyBJZiB0aGUgc2Nyb2xsIHZpZXcgaXMgYWxyZWFkeSBvbiB0b3AsIGdldCB0aGUgZmlyc3QgYWN0aXZpdHkuXG4gICAgICBjb25zdCBlbnRyeSA9IHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFRvcFxuICAgICAgICA/IFsuLi5hY3Rpdml0eUVsZW1lbnRzUmVmLmN1cnJlbnRdLnJldmVyc2UoKS5maW5kKCh7IGVsZW1lbnQgfSkgPT4ge1xuICAgICAgICAgICAgaWYgKCFlbGVtZW50KSB7XG4gICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgW3sgeSB9ID0ge31dID0gZWxlbWVudC5nZXRDbGllbnRSZWN0cygpO1xuXG4gICAgICAgICAgICByZXR1cm4geSA8IG9mZnNldEhlaWdodDtcbiAgICAgICAgICB9KVxuICAgICAgICA6IGFjdGl2aXR5RWxlbWVudHNSZWYuY3VycmVudFswXTtcblxuICAgICAgY29uc3QgeyBhY3Rpdml0eUlEIH0gPSBlbnRyeSB8fCB7fTtcblxuICAgICAgZGlzcGF0Y2hTY3JvbGxQb3NpdGlvbih7IC4uLihhY3Rpdml0eUlEID8geyBhY3Rpdml0eUlEIH0gOiB7fSksIHNjcm9sbFRvcCB9KTtcbiAgICB9O1xuICB9LCBbYWN0aXZpdHlFbGVtZW50c1JlZiwgZGlzcGF0Y2hTY3JvbGxQb3NpdGlvbiwgcm9vdEVsZW1lbnRSZWZdKTtcblxuICB1c2VPYnNlcnZlU2Nyb2xsUG9zaXRpb24ocGF0Y2hlZERpc3BhdGNoU2Nyb2xsUG9zaXRpb24pO1xuXG4gIGNvbnN0IFtsYXN0SW50ZXJhY3RlZEFjdGl2aXR5XSA9IHVzZUFja25vd2xlZGdlZEFjdGl2aXR5KCk7XG5cbiAgY29uc3QgaW5kZXhPZkxhc3RJbnRlcmFjdGVkQWN0aXZpdHkgPSBhY3Rpdml0aWVzLmluZGV4T2YobGFzdEludGVyYWN0ZWRBY3Rpdml0eSk7XG5cbiAgLy8gQ3JlYXRlIGEgbmV3IElEIGZvciBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQgZXZlcnkgdGltZSB0aGUgYWN0aXZlIGRlc2NlbmRhbnQgY2hhbmdlLlxuICAvLyBJbiBvdXIgZGVzaWduLCB0aGUgdHJhbnNjcmlwdCB3aWxsIG9ubHkgaGF2ZSAxIGZvY3VzZWQgYWN0aXZpdHkgYW5kIGl0IGhhcyBhbiBJRC4gT3RoZXIgYmx1cnJlZCBhY3Rpdml0aWVzIHdpbGwgbm90IGhhdmUgSUQgYXNzaWduZWQuXG4gIC8vIFRoaXMgaGVscCB3aXRoIHBlcmZvcm1hbmNlLlxuICAvLyBCdXQgYnJvd3NlciB1c3VhbGx5IGRvIG5vb3AgaWYgdGhlIHZhbHVlIG9mIGFyaWEtYWN0aXZlZGVzY2VuZGFudCBkb2Vzbid0IGNoYW5nZS5cbiAgLy8gVGhhdCBtZWFucywgaWYgd2UgYXNzaWduIHRoZSBzYW1lIElEIHRvIGFub3RoZXIgZWxlbWVudCwgYnJvd3NlciB3aWxsIGRvIG5vb3AuXG4gIC8vIFdlIG5lZWQgdG8gZ2VuZXJhdGUgYSBuZXcgSUQgc28gdGhlIGJyb3dzZXIgc2VlIHRoZXJlIGlzIGEgY2hhbmdlIGluIGFyaWEtYWN0aXZlZGVzY2VuZGFudCB2YWx1ZSBhbmQgcGVyZm9ybSBhY2NvcmRpbmdseS5cbiAgY29uc3QgYWN0aXZlRGVzY2VuZGFudEVsZW1lbnRJZCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gZm9jdXNlZEFjdGl2aXR5S2V5ICYmIGB3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19hY3RpdmUtZGVzY2VuZGFudC0ke3JhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgNSl9YCxcbiAgICBbZm9jdXNlZEFjdGl2aXR5S2V5XVxuICApO1xuXG4gIGNvbnN0IHNjcm9sbEFjdGl2ZURlc2NlbmRhbnRJbnRvVmlldyA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBjb25zdCBhY3RpdmVEZXNjZW5kYW50ID0gYWN0aXZlRGVzY2VuZGFudEVsZW1lbnRJZCAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChhY3RpdmVEZXNjZW5kYW50RWxlbWVudElkKTtcblxuICAgIC8vIERvbid0IHNjcm9sbCBhY3RpdmUgZGVzY2VuZGFudCBpbnRvIHZpZXcgaWYgdGhlIGZvY3VzIGlzIGFscmVhZHkgaW5zaWRlIGl0LlxuICAgIC8vIE90aGVyd2lzZSwgZ2l2ZW4gdGhlIGZvY3VzIGlzIG9uIHRoZSBzZW5kIGJveCwgY2xpY2tpbmcgb24gYW55IDxpbnB1dD4gaW5zaWRlIHRoZSBBZGFwdGl2ZSBDYXJkcyBtYXkgY2F1c2UgdGhlIHZpZXcgdG8gbW92ZS5cbiAgICAvLyBUaGlzIFVYIGlzIG5vdCBkZXNpcmFibGUgYmVjYXVzZSBjbGljayBzaG91bGQgbm90IGNhdXNlIHNjcm9sbC5cbiAgICBpZiAoYWN0aXZlRGVzY2VuZGFudCAmJiAhYWN0aXZlRGVzY2VuZGFudC5jb250YWlucyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgLy8gQ2hlY2tzIGlmIHNjcm9sbEludG9WaWV3IHN1cHBvcnQgb3B0aW9ucyBvciBub3QuXG4gICAgICAvLyAtIGh0dHBzOi8vZ2l0aHViLmNvbS9Nb2Rlcm5penIvTW9kZXJuaXpyL2lzc3Vlcy8xNTY4I2lzc3VlY29tbWVudC00MTk0NTc5NzJcbiAgICAgIC8vIC0gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNDY5MTk2MjcvaXMtaXQtcG9zc2libGUtdG8tdGVzdC1mb3Itc2Nyb2xsaW50b3ZpZXctYnJvd3Nlci1jb21wYXRpYmlsaXR5XG4gICAgICBpZiAoJ3Njcm9sbEJlaGF2aW9yJyBpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUpIHtcbiAgICAgICAgYWN0aXZlRGVzY2VuZGFudC5zY3JvbGxJbnRvVmlldyh7IGJsb2NrOiAnbmVhcmVzdCcgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBUaGlzIGlzIGZvciBicm93c2VyIHRoYXQgZG9lcyBub3Qgc3VwcG9ydCBvcHRpb25zIHBhc3NlZCB0byBzY3JvbGxJbnRvVmlldygpLCBwb3NzaWJseSBJRTExLlxuICAgICAgICBjb25zdCBzY3JvbGxhYmxlRWxlbWVudCA9IHJvb3RFbGVtZW50UmVmLmN1cnJlbnQucXVlcnlTZWxlY3RvcignLndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX3Njcm9sbGFibGUnKTtcbiAgICAgICAgY29uc3Qgc2Nyb2xsVG9wQXRUb3BTaWRlID0gYWN0aXZlRGVzY2VuZGFudC5vZmZzZXRUb3A7XG4gICAgICAgIGNvbnN0IHNjcm9sbFRvcEF0Qm90dG9tU2lkZSA9IGFjdGl2ZURlc2NlbmRhbnQub2Zmc2V0VG9wICsgYWN0aXZlRGVzY2VuZGFudC5vZmZzZXRIZWlnaHQ7XG5cbiAgICAgICAgaWYgKHNjcm9sbFRvcEF0VG9wU2lkZSA8IHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFRvcCkge1xuICAgICAgICAgIHNjcm9sbGFibGVFbGVtZW50LnNjcm9sbFRvcCA9IHNjcm9sbFRvcEF0VG9wU2lkZTtcbiAgICAgICAgfSBlbHNlIGlmIChzY3JvbGxUb3BBdEJvdHRvbVNpZGUgPiBzY3JvbGxhYmxlRWxlbWVudC5zY3JvbGxUb3AgKyBzY3JvbGxhYmxlRWxlbWVudC5vZmZzZXRIZWlnaHQpIHtcbiAgICAgICAgICBzY3JvbGxhYmxlRWxlbWVudC5zY3JvbGxUb3AgPSBzY3JvbGxUb3BBdEJvdHRvbVNpZGUgLSBzY3JvbGxhYmxlRWxlbWVudC5vZmZzZXRIZWlnaHQ7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIFthY3RpdmVEZXNjZW5kYW50RWxlbWVudElkLCByb290RWxlbWVudFJlZl0pO1xuXG4gIGNvbnN0IGhhbmRsZVRyYW5zY3JpcHRGb2N1cyA9IHVzZUNhbGxiYWNrKFxuICAgIGV2ZW50ID0+IHtcbiAgICAgIGNvbnN0IHsgY3VycmVudFRhcmdldCwgdGFyZ2V0IH0gPSBldmVudDtcblxuICAgICAgLy8gV2hlbiBmb2N1cyBpcyBwbGFjZWQgb24gdGhlIHRyYW5zY3JpcHQsIHNjcm9sbCBhY3RpdmUgZGVzY2VuZGFudCBpbnRvIHRoZSB2aWV3LlxuICAgICAgY3VycmVudFRhcmdldCA9PT0gdGFyZ2V0ICYmIHNjcm9sbEFjdGl2ZURlc2NlbmRhbnRJbnRvVmlldygpO1xuICAgIH0sXG4gICAgW3Njcm9sbEFjdGl2ZURlc2NlbmRhbnRJbnRvVmlld11cbiAgKTtcblxuICAvLyBBZnRlciBuZXcgYXJpYS1hY3RpdmVkZXNjZW5kYW50IGlzIGFzc2lnbmVkLCB3ZSB3aWxsIG5lZWQgdG8gc2Nyb2xsIGl0IGludG8gdmlldy5cbiAgLy8gVXNlciBhZ2VudCB3aWxsIHNjcm9sbCBhdXRvbWF0aWNhbGx5IGZvciBmb2N1c2luZyBlbGVtZW50LCBidXQgbm90IGZvciBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQuXG4gIC8vIFdlIG5lZWQgdG8gZG8gdGhlIHNjcm9sbGluZyBtYW51YWxseS5cbiAgdXNlRWZmZWN0KCgpID0+IHNjcm9sbEFjdGl2ZURlc2NlbmRhbnRJbnRvVmlldygpLCBbc2Nyb2xsQWN0aXZlRGVzY2VuZGFudEludG9WaWV3XSk7XG5cbiAgLy8gSWYgYW55IGFjdGl2aXRpZXMgaGFzIGNoYW5nZWQsIHJlc2V0IHRoZSBhY3RpdmUgZGVzY2VuZGFudC5cbiAgdXNlRWZmZWN0KCgpID0+IHNldEZvY3VzZWRBY3Rpdml0eUtleSh1bmRlZmluZWQpLCBbYWN0aXZpdGllcywgc2V0Rm9jdXNlZEFjdGl2aXR5S2V5XSk7XG5cbiAgY29uc3QgZm9jdXNSZWxhdGl2ZUFjdGl2aXR5ID0gdXNlQ2FsbGJhY2soXG4gICAgZGVsdGEgPT4ge1xuICAgICAgaWYgKGlzTmFOKGRlbHRhKSB8fCAhcmVuZGVyaW5nRWxlbWVudHMubGVuZ3RoKSB7XG4gICAgICAgIHJldHVybiBzZXRGb2N1c2VkQWN0aXZpdHlLZXkodW5kZWZpbmVkKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaW5kZXggPSByZW5kZXJpbmdFbGVtZW50cy5maW5kSW5kZXgoKHsga2V5IH0pID0+IGtleSA9PT0gZm9jdXNlZEFjdGl2aXR5S2V5KTtcbiAgICAgIGNvbnN0IG5leHRJbmRleCA9IH5pbmRleFxuICAgICAgICA/IE1hdGgubWF4KDAsIE1hdGgubWluKHJlbmRlcmluZ0VsZW1lbnRzLmxlbmd0aCAtIDEsIGluZGV4ICsgZGVsdGEpKVxuICAgICAgICA6IHJlbmRlcmluZ0VsZW1lbnRzLmxlbmd0aCAtIDE7XG4gICAgICBjb25zdCBuZXh0Rm9jdXNlZEFjdGl2aXR5ID0gcmVuZGVyaW5nRWxlbWVudHNbbmV4dEluZGV4XTtcblxuICAgICAgc2V0Rm9jdXNlZEFjdGl2aXR5S2V5KG5leHRGb2N1c2VkQWN0aXZpdHkua2V5KTtcbiAgICAgIHJvb3RFbGVtZW50UmVmLmN1cnJlbnQgJiYgcm9vdEVsZW1lbnRSZWYuY3VycmVudC5mb2N1cygpO1xuICAgIH0sXG4gICAgW2ZvY3VzZWRBY3Rpdml0eUtleSwgcmVuZGVyaW5nRWxlbWVudHMsIHJvb3RFbGVtZW50UmVmLCBzZXRGb2N1c2VkQWN0aXZpdHlLZXldXG4gICk7XG5cbiAgY29uc3QgaGFuZGxlVHJhbnNjcmlwdEtleURvd24gPSB1c2VDYWxsYmFjayhcbiAgICBldmVudCA9PiB7XG4gICAgICBjb25zdCB7IHRhcmdldCB9ID0gZXZlbnQ7XG5cbiAgICAgIGNvbnN0IGZyb21FbmRPZlRyYW5zY3JpcHRJbmRpY2F0b3IgPSB0YXJnZXQgPT09IHRlcm1pbmF0b3JSZWYuY3VycmVudDtcbiAgICAgIGNvbnN0IGZyb21UcmFuc2NyaXB0ID0gdGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0O1xuXG4gICAgICBpZiAoIWZyb21FbmRPZlRyYW5zY3JpcHRJbmRpY2F0b3IgJiYgIWZyb21UcmFuc2NyaXB0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgbGV0IGhhbmRsZWQgPSB0cnVlO1xuXG4gICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICBjYXNlICdBcnJvd0Rvd24nOlxuICAgICAgICAgIGZvY3VzUmVsYXRpdmVBY3Rpdml0eShmcm9tRW5kT2ZUcmFuc2NyaXB0SW5kaWNhdG9yID8gMCA6IDEpO1xuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ0Fycm93VXAnOlxuICAgICAgICAgIGZvY3VzUmVsYXRpdmVBY3Rpdml0eShmcm9tRW5kT2ZUcmFuc2NyaXB0SW5kaWNhdG9yID8gMCA6IC0xKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdFbmQnOlxuICAgICAgICAgIGZvY3VzUmVsYXRpdmVBY3Rpdml0eShJbmZpbml0eSk7XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnRW50ZXInOlxuICAgICAgICAgIGlmICghZnJvbUVuZE9mVHJhbnNjcmlwdEluZGljYXRvcikge1xuICAgICAgICAgICAgY29uc3QgZm9jdXNlZEFjdGl2aXR5RW50cnkgPSByZW5kZXJpbmdFbGVtZW50cy5maW5kKCh7IGtleSB9KSA9PiBrZXkgPT09IGZvY3VzZWRBY3Rpdml0eUtleSk7XG5cbiAgICAgICAgICAgIGlmIChmb2N1c2VkQWN0aXZpdHlFbnRyeSkge1xuICAgICAgICAgICAgICBjb25zdCB7IGVsZW1lbnQ6IGZvY3VzZWRBY3Rpdml0eUVsZW1lbnQgfSA9XG4gICAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50c1JlZi5jdXJyZW50LmZpbmQoKHsgYWN0aXZpdHkgfSkgPT4gYWN0aXZpdHkgPT09IGZvY3VzZWRBY3Rpdml0eUVudHJ5LmFjdGl2aXR5KSB8fCB7fTtcblxuICAgICAgICAgICAgICBpZiAoZm9jdXNlZEFjdGl2aXR5RWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFtmaXJzdFRhYmJhYmxlRWxlbWVudF0gPSB0YWJiYWJsZUVsZW1lbnRzKGZvY3VzZWRBY3Rpdml0eUVsZW1lbnQpLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICh7IGNsYXNzTmFtZSB9KSA9PiBjbGFzc05hbWUgIT09ICd3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19hY3Rpdml0eS1zZW50aW5lbCdcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgZmlyc3RUYWJiYWJsZUVsZW1lbnQgJiYgZmlyc3RUYWJiYWJsZUVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ0VzY2FwZSc6XG4gICAgICAgICAgZm9jdXMoJ3NlbmRCb3hXaXRob3V0S2V5Ym9hcmQnKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdIb21lJzpcbiAgICAgICAgICBmb2N1c1JlbGF0aXZlQWN0aXZpdHkoLUluZmluaXR5KTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGhhbmRsZWQgPSBmYWxzZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cblxuICAgICAgaWYgKGhhbmRsZWQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAvLyBJZiBhIGN1c3RvbSBIVE1MIGNvbnRyb2wgd2FudHMgdG8gaGFuZGxlIHVwL2Rvd24gYXJyb3csIHdlIHdpbGwgcHJldmVudCB0aGVtIGZyb20gbGlzdGVuaW5nIHRvIHRoaXMgZXZlbnQgdG8gcHJldmVudCBidWdzIGR1ZSB0byBoYW5kbGluZyBhcnJvdyBrZXlzIHR3aWNlLlxuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtmb2N1c2VkQWN0aXZpdHlLZXksIGFjdGl2aXR5RWxlbWVudHNSZWYsIGZvY3VzUmVsYXRpdmVBY3Rpdml0eSwgZm9jdXMsIHRlcm1pbmF0b3JSZWYsIHJlbmRlcmluZ0VsZW1lbnRzXVxuICApO1xuXG4gIGNvbnN0IGxhYmVsSWQgPSB1c2VVbmlxdWVJZCgnd2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fbGFiZWwnKTtcblxuICAvLyBJZiBTSElGVC1UQUIgZnJvbSBcIkVuZCBvZiB0cmFuc2NyaXB0XCIgaW5kaWNhdG9yLCBpZiBmb2N1c2VkQWN0aXZpdHlLZXkgaXMgbm90IHNldCAob3Igbm8gbG9uZ2VyIGV4aXN0cyksIHNldCBpdCB0aGUgdGhlIGJvdHRvbW1vc3QgYWN0aXZpdHkuXG4gIGNvbnN0IHNldEJvdHRvbW1vc3RGb2N1c2VkQWN0aXZpdHlLZXlJZk5lZWRlZCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBpZiAoIX5yZW5kZXJpbmdFbGVtZW50cy5maW5kSW5kZXgoKHsga2V5IH0pID0+IGtleSA9PT0gZm9jdXNlZEFjdGl2aXR5S2V5KSkge1xuICAgICAgY29uc3QgeyBrZXk6IGxhc3RBY3Rpdml0eUtleSB9ID0gcmVuZGVyaW5nRWxlbWVudHNbcmVuZGVyaW5nRWxlbWVudHMubGVuZ3RoIC0gMV0gfHwge307XG5cbiAgICAgIHNldEZvY3VzZWRBY3Rpdml0eUtleShsYXN0QWN0aXZpdHlLZXkpO1xuICAgIH1cbiAgfSwgW2ZvY3VzZWRBY3Rpdml0eUtleSwgcmVuZGVyaW5nRWxlbWVudHMsIHNldEZvY3VzZWRBY3Rpdml0eUtleV0pO1xuXG4gIGNvbnN0IGhhbmRsZVRyYW5zY3JpcHRLZXlEb3duQ2FwdHVyZSA9IHVzZUNhbGxiYWNrKFxuICAgIGV2ZW50ID0+IHtcbiAgICAgIGNvbnN0IHsgYWx0S2V5LCBjdHJsS2V5LCBrZXksIG1ldGFLZXksIHRhcmdldCB9ID0gZXZlbnQ7XG5cbiAgICAgIGlmIChhbHRLZXkgfHwgKGN0cmxLZXkgJiYga2V5ICE9PSAndicpIHx8IG1ldGFLZXkgfHwgKCFpbnB1dHRhYmxlS2V5KGtleSkgJiYga2V5ICE9PSAnQmFja3NwYWNlJykpIHtcbiAgICAgICAgLy8gSWdub3JlIGlmIG9uZSBvZiB0aGUgdXRpbGl0eSBrZXkgKGV4Y2VwdCBTSElGVCkgaXMgcHJlc3NlZFxuICAgICAgICAvLyBFLmcuIENUUkwtQyBvbiBhIGxpbmsgaW4gb25lIG9mIHRoZSBtZXNzYWdlIHNob3VsZCBub3QganVtcCB0byBjaGF0IGJveFxuICAgICAgICAvLyBFLmcuIFwiQVwiIG9yIFwiQmFja3NwYWNlXCIgc2hvdWxkIGp1bXAgdG8gY2hhdCBib3hcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBTZW5kIGtleXN0cm9rZXMgdG8gc2VuZCBib3ggaWYgd2UgYXJlIGZvY3VzaW5nIG9uIHRoZSB0cmFuc2NyaXB0IG9yIHRlcm1pbmF0b3IuXG4gICAgICBpZiAodGFyZ2V0ID09PSBldmVudC5jdXJyZW50VGFyZ2V0IHx8IHRhcmdldCA9PT0gdGVybWluYXRvclJlZi5jdXJyZW50KSB7XG4gICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGZvY3VzKCdzZW5kQm94Jyk7XG4gICAgICB9XG4gICAgfSxcbiAgICBbZm9jdXNdXG4gICk7XG5cbiAgY29uc3QgZm9jdXNUcmFuc2NyaXB0Q2FsbGJhY2sgPSB1c2VDYWxsYmFjaygoKSA9PiByb290RWxlbWVudFJlZi5jdXJyZW50ICYmIHJvb3RFbGVtZW50UmVmLmN1cnJlbnQuZm9jdXMoKSwgW1xuICAgIHJvb3RFbGVtZW50UmVmXG4gIF0pO1xuXG4gIHVzZVJlZ2lzdGVyRm9jdXNUcmFuc2NyaXB0KGZvY3VzVHJhbnNjcmlwdENhbGxiYWNrKTtcblxuICBjb25zdCBoYW5kbGVGb2N1c0FjdGl2aXR5ID0gdXNlQ2FsbGJhY2soXG4gICAga2V5ID0+IHtcbiAgICAgIHNldEZvY3VzZWRBY3Rpdml0eUtleShrZXkpO1xuICAgICAgcm9vdEVsZW1lbnRSZWYuY3VycmVudCAmJiByb290RWxlbWVudFJlZi5jdXJyZW50LmZvY3VzKCk7XG4gICAgfSxcbiAgICBbc2V0Rm9jdXNlZEFjdGl2aXR5S2V5XVxuICApO1xuXG4gIC8vIFdoZW4gdGhlIGZvY3VzaW5nIGFjdGl2aXR5IGhhcyBjaGFuZ2VkLCBkaXNwYXRjaCBhbiBldmVudCB0byBvYnNlcnZlcnMgb2YgXCJ1c2VPYnNlcnZlVHJhbnNjcmlwdEZvY3VzXCIuXG4gIGNvbnN0IGRpc3BhdGNoVHJhbnNjcmlwdEZvY3VzID0gdXNlRGlzcGF0Y2hUcmFuc2NyaXB0Rm9jdXMoKTtcbiAgY29uc3QgZm9jdXNlZEFjdGl2aXR5ID0gdXNlTWVtbygoKSA9PiB7XG4gICAgY29uc3QgeyBhY3Rpdml0eSB9ID0gcmVuZGVyaW5nRWxlbWVudHMuZmluZCgoeyBrZXkgfSkgPT4ga2V5ID09PSBmb2N1c2VkQWN0aXZpdHlLZXkpIHx8IHt9O1xuXG4gICAgcmV0dXJuIGFjdGl2aXR5O1xuICB9LCBbZm9jdXNlZEFjdGl2aXR5S2V5LCByZW5kZXJpbmdFbGVtZW50c10pO1xuXG4gIHVzZU1lbW8oKCkgPT4gZGlzcGF0Y2hUcmFuc2NyaXB0Rm9jdXMgJiYgZGlzcGF0Y2hUcmFuc2NyaXB0Rm9jdXMoeyBhY3Rpdml0eTogZm9jdXNlZEFjdGl2aXR5IH0pLCBbXG4gICAgZGlzcGF0Y2hUcmFuc2NyaXB0Rm9jdXMsXG4gICAgZm9jdXNlZEFjdGl2aXR5XG4gIF0pO1xuXG4gIC8vIFRoaXMgaXMgcmVxdWlyZWQgYnkgSUUxMS5cbiAgLy8gV2hlbiB0aGUgdXNlciBjbGlja3Mgb24gYW5kIGVtcHR5IHNwYWNlIChhLmsuYS4gZmlsbGVyKSBpbiBhbiBlbXB0eSB0cmFuc2NyaXB0LCBJRTExIHNheXMgdGhlIGZvY3VzIGlzIG9uIHRoZSA8ZGl2IGNsYXNzTmFtZT1cImZpbGxlclwiPixcbiAgLy8gZGVzcGl0ZSB0aGUgZmFjdCB0aGVyZSBhcmUgbm8gXCJ0YWJJbmRleFwiIGF0dHJpYnV0ZXMgc2V0IG9uIHRoZSBmaWxsZXIuXG4gIC8vIFdlIG5lZWQgdG8gYXJ0aWZpY2lhbGx5IHNlbmQgdGhlIGZvY3VzIGJhY2sgdG8gdGhlIHRyYW5zY3JpcHQuXG4gIGNvbnN0IGhhbmRsZUZvY3VzRmlsbGVyID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIGNvbnN0IHsgY3VycmVudCB9ID0gcm9vdEVsZW1lbnRSZWY7XG5cbiAgICBjdXJyZW50ICYmIGN1cnJlbnQuZm9jdXMoKTtcbiAgfSwgW3Jvb3RFbGVtZW50UmVmXSk7XG5cbiAgcmV0dXJuIChcbiAgICA8ZGl2XG4gICAgICBhcmlhLWFjdGl2ZWRlc2NlbmRhbnQ9e2ZvY3VzZWRBY3Rpdml0eUtleSA/IGFjdGl2ZURlc2NlbmRhbnRFbGVtZW50SWQgOiB1bmRlZmluZWR9XG4gICAgICBhcmlhLWxhYmVsbGVkYnk9e2xhYmVsSWR9XG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoXG4gICAgICAgICd3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0JyxcbiAgICAgICAgYmFzaWNUcmFuc2NyaXB0U3R5bGVTZXQgKyAnJyxcbiAgICAgICAgcm9vdENsYXNzTmFtZSxcbiAgICAgICAgKGNsYXNzTmFtZSB8fCAnJykgKyAnJ1xuICAgICAgKX1cbiAgICAgIGRpcj17ZGlyZWN0aW9ufVxuICAgICAgb25Gb2N1cz17aGFuZGxlVHJhbnNjcmlwdEZvY3VzfVxuICAgICAgb25LZXlEb3duPXtoYW5kbGVUcmFuc2NyaXB0S2V5RG93bn1cbiAgICAgIG9uS2V5RG93bkNhcHR1cmU9e2hhbmRsZVRyYW5zY3JpcHRLZXlEb3duQ2FwdHVyZX1cbiAgICAgIHJlZj17cm9vdEVsZW1lbnRSZWZ9XG4gICAgICAvLyBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiIHdpbGwgb25seSB3b3JrcyB3aXRoIGEgbnVtYmVyIG9mIHJvbGVzIGFuZCBpdCBtdXN0IGJlIGV4cGxpY2l0bHkgc2V0LlxuICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLyNhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcbiAgICAgIHJvbGU9XCJncm91cFwiXG4gICAgICAvLyBGb3IgdXAvZG93biBhcnJvdyBrZXkgbmF2aWdhdGlvbiBhY3Jvc3MgYWN0aXZpdGllcywgdGhpcyBjb21wb25lbnQgbXVzdCBiZSBpbmNsdWRlZCBpbiB0aGUgdGFiIHNlcXVlbmNlLlxuICAgICAgLy8gT3RoZXJ3aXNlLCBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiIHdpbGwgbm90IGJlIG5hcnJhdGVkIHdoZW4gdGhlIHVzZXIgcHJlc3MgdXAvZG93biBhcnJvdyBrZXlzLlxuICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLXByYWN0aWNlcy0xLjEvI2tiZF9mb2N1c19hY3RpdmVkZXNjZW5kYW50XG4gICAgICB0YWJJbmRleD17MH1cbiAgICA+XG4gICAgICA8U2NyZWVuUmVhZGVyVGV4dCBpZD17bGFiZWxJZH0gdGV4dD17dHJhbnNjcmlwdEFyaWFMYWJlbH0gLz5cbiAgICAgIHsvKiBUaGlzIDxzZWN0aW9uPiBpcyBmb3IgbGl2ZSByZWdpb24gb25seS4gQ29udGVudCBpcyBtYWRlIGludmlzaWJsZSB0aHJvdWdoIENTUy4gKi99XG4gICAgICA8c2VjdGlvblxuICAgICAgICBhcmlhLWF0b21pYz17ZmFsc2V9XG4gICAgICAgIGFyaWEtbGl2ZT1cInBvbGl0ZVwiXG4gICAgICAgIGFyaWEtcmVsZXZhbnQ9XCJhZGRpdGlvbnNcIlxuICAgICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj17dHJhbnNjcmlwdFJvbGVEZXNjcmlwdGlvbn1cbiAgICAgICAgcm9sZT1cImxvZ1wiXG4gICAgICA+XG4gICAgICAgIHtyZW5kZXJpbmdFbGVtZW50cy5tYXAoKHsgYWN0aXZpdHksIGxpdmVSZWdpb25LZXkgfSkgPT4gKFxuICAgICAgICAgIDxGYWRlIGZhZGVBZnRlcj17aW50ZXJuYWxMaXZlUmVnaW9uRmFkZUFmdGVyfSBrZXk9e2xpdmVSZWdpb25LZXl9PlxuICAgICAgICAgICAgeygpID0+IDxTY3JlZW5SZWFkZXJBY3Rpdml0eSBhY3Rpdml0eT17YWN0aXZpdHl9IC8+fVxuICAgICAgICAgIDwvRmFkZT5cbiAgICAgICAgKSl9XG4gICAgICA8L3NlY3Rpb24+XG4gICAgICB7LyogVE9ETzogW1AyXSBGaXggRVNMaW50IGVycm9yIGBuby11c2UtYmVmb3JlLWRlZmluZWAgKi99XG4gICAgICB7LyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11c2UtYmVmb3JlLWRlZmluZSAqL31cbiAgICAgIDxJbnRlcm5hbFRyYW5zY3JpcHRTY3JvbGxhYmxlXG4gICAgICAgIGFjdGl2aXRpZXM9e3JlbmRlcmluZ0FjdGl2aXRpZXN9XG4gICAgICAgIG9uRm9jdXNBY3Rpdml0eT17aGFuZGxlRm9jdXNBY3Rpdml0eX1cbiAgICAgICAgb25Gb2N1c0ZpbGxlcj17aGFuZGxlRm9jdXNGaWxsZXJ9XG4gICAgICAgIHRlcm1pbmF0b3JSZWY9e3Rlcm1pbmF0b3JSZWZ9XG4gICAgICA+XG4gICAgICAgIHtyZW5kZXJpbmdFbGVtZW50cy5tYXAoXG4gICAgICAgICAgKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgY2FsbGJhY2tSZWYsXG4gICAgICAgICAgICAgIGZvY3VzQWN0aXZpdHksXG4gICAgICAgICAgICAgIGhhbmRsZUZvY3VzLFxuICAgICAgICAgICAgICBoYW5kbGVLZXlEb3duLFxuICAgICAgICAgICAgICBoYW5kbGVNb3VzZURvd25DYXB0dXJlLFxuICAgICAgICAgICAgICBoaWRlVGltZXN0YW1wLFxuICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgIHJlbmRlckFjdGl2aXR5LFxuICAgICAgICAgICAgICByZW5kZXJBY3Rpdml0eVN0YXR1cyxcbiAgICAgICAgICAgICAgcmVuZGVyQXZhdGFyLFxuICAgICAgICAgICAgICByb2xlLFxuICAgICAgICAgICAgICBzaG91bGRTcGVhayxcbiAgICAgICAgICAgICAgc2hvd0NhbGxvdXRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmRleFxuICAgICAgICAgICkgPT4ge1xuICAgICAgICAgICAgY29uc3QgeyBhcmlhTGFiZWxJRCwgZWxlbWVudCB9ID1cbiAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50c1JlZi5jdXJyZW50LmZpbmQoZW50cnkgPT4gZW50cnkuYWN0aXZpdHkgPT09IGFjdGl2aXR5KSB8fCB7fTtcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZURlc2NlbmRhbnQgPSBmb2N1c2VkQWN0aXZpdHlLZXkgPT09IGtleTtcbiAgICAgICAgICAgIGNvbnN0IGlzQ29udGVudEludGVyYWN0aXZlID0gISEoZWxlbWVudFxuICAgICAgICAgICAgICA/IHRhYmJhYmxlRWxlbWVudHMoZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcud2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fYWN0aXZpdHktYm94JykpLmxlbmd0aFxuICAgICAgICAgICAgICA6IDApO1xuXG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICA8bGlcbiAgICAgICAgICAgICAgICBhcmlhLWxhYmVsbGVkYnk9e2FyaWFMYWJlbElEfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcygnd2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fYWN0aXZpdHknLCB7XG4gICAgICAgICAgICAgICAgICAnd2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fYWN0aXZpdHktLWFja25vd2xlZGdlZCc6IGluZGV4IDw9IGluZGV4T2ZMYXN0SW50ZXJhY3RlZEFjdGl2aXR5LFxuICAgICAgICAgICAgICAgICAgJ3dlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LS1mcm9tLWJvdCc6IHJvbGUgIT09ICd1c2VyJyxcbiAgICAgICAgICAgICAgICAgICd3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19hY3Rpdml0eS0tZnJvbS11c2VyJzogcm9sZSA9PT0gJ3VzZXInXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgLy8gU2V0IFwiaWRcIiBmb3IgdmFsaWQgZm9yIGFjY2Vzc2liaWxpdHkuXG4gICAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2ZvcmJpZC1kb20tcHJvcHMgKi9cbiAgICAgICAgICAgICAgICBpZD17YWN0aXZlRGVzY2VuZGFudCA/IGFjdGl2ZURlc2NlbmRhbnRFbGVtZW50SWQgOiB1bmRlZmluZWR9XG4gICAgICAgICAgICAgICAga2V5PXtrZXl9XG4gICAgICAgICAgICAgICAgb25Gb2N1cz17aGFuZGxlRm9jdXN9XG4gICAgICAgICAgICAgICAgb25LZXlEb3duPXtoYW5kbGVLZXlEb3dufVxuICAgICAgICAgICAgICAgIG9uTW91c2VEb3duQ2FwdHVyZT17aGFuZGxlTW91c2VEb3duQ2FwdHVyZX1cbiAgICAgICAgICAgICAgICByZWY9e2NhbGxiYWNrUmVmfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgPFNjcmVlblJlYWRlckFjdGl2aXR5IGFjdGl2aXR5PXthY3Rpdml0eX0gaWQ9e2FyaWFMYWJlbElEfSByZW5kZXJBdHRhY2htZW50cz17ZmFsc2V9PlxuICAgICAgICAgICAgICAgICAgeyEhaXNDb250ZW50SW50ZXJhY3RpdmUgJiYgPHA+e2FjdGl2aXR5SW50ZXJhY3RpdmVBbHR9PC9wPn1cbiAgICAgICAgICAgICAgICA8L1NjcmVlblJlYWRlckFjdGl2aXR5PlxuICAgICAgICAgICAgICAgIDxGb2N1c1JlZGlyZWN0b3JcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LXNlbnRpbmVsXCJcbiAgICAgICAgICAgICAgICAgIG9uRm9jdXM9e2ZvY3VzQWN0aXZpdHl9XG4gICAgICAgICAgICAgICAgICByZWRpcmVjdFJlZj17cm9vdEVsZW1lbnRSZWZ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LWJveFwiPlxuICAgICAgICAgICAgICAgICAge3JlbmRlckFjdGl2aXR5KHtcbiAgICAgICAgICAgICAgICAgICAgaGlkZVRpbWVzdGFtcCxcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyQWN0aXZpdHlTdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlckF2YXRhcixcbiAgICAgICAgICAgICAgICAgICAgc2hvd0NhbGxvdXRcbiAgICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIHtzaG91bGRTcGVhayAmJiA8U3BlYWtBY3Rpdml0eSBhY3Rpdml0eT17YWN0aXZpdHl9IC8+fVxuICAgICAgICAgICAgICAgIDxGb2N1c1JlZGlyZWN0b3JcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LXNlbnRpbmVsXCJcbiAgICAgICAgICAgICAgICAgIG9uRm9jdXM9e2ZvY3VzQWN0aXZpdHl9XG4gICAgICAgICAgICAgICAgICByZWRpcmVjdFJlZj17cm9vdEVsZW1lbnRSZWZ9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoJ3dlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LWluZGljYXRvcicsIHtcbiAgICAgICAgICAgICAgICAgICAgJ3dlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2FjdGl2aXR5LWluZGljYXRvci0tZmlyc3QnOiAhaW5kZXgsXG4gICAgICAgICAgICAgICAgICAgICd3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19hY3Rpdml0eS1pbmRpY2F0b3ItLWZvY3VzJzogYWN0aXZlRGVzY2VuZGFudFxuICAgICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICApfVxuICAgICAgPC9JbnRlcm5hbFRyYW5zY3JpcHRTY3JvbGxhYmxlPlxuICAgICAgeyEhcmVuZGVyaW5nRWxlbWVudHMubGVuZ3RoICYmIChcbiAgICAgICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAgICAgIDxGb2N1c1JlZGlyZWN0b3JcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX3NlbnRpbmVsXCJcbiAgICAgICAgICAgIG9uRm9jdXM9e3NldEJvdHRvbW1vc3RGb2N1c2VkQWN0aXZpdHlLZXlJZk5lZWRlZH1cbiAgICAgICAgICAgIHJlZGlyZWN0UmVmPXtyb290RWxlbWVudFJlZn1cbiAgICAgICAgICAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fdGVybWluYXRvclwiIHJlZj17dGVybWluYXRvclJlZn0gdGFiSW5kZXg9ezB9PlxuICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X190ZXJtaW5hdG9yLWJvZHlcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X190ZXJtaW5hdG9yLXRleHRcIj57dGVybWluYXRvclRleHR9PC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9SZWFjdC5GcmFnbWVudD5cbiAgICAgICl9XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2Jhc2ljLXRyYW5zY3JpcHRfX2ZvY3VzLWluZGljYXRvclwiIC8+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5JbnRlcm5hbFRyYW5zY3JpcHQuZGVmYXVsdFByb3BzID0ge1xuICBjbGFzc05hbWU6ICcnXG59O1xuXG5JbnRlcm5hbFRyYW5zY3JpcHQucHJvcFR5cGVzID0ge1xuICBhY3Rpdml0eUVsZW1lbnRzUmVmOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgIGN1cnJlbnQ6IFByb3BUeXBlcy5hcnJheS5pc1JlcXVpcmVkXG4gIH0pLmlzUmVxdWlyZWQsXG4gIGNsYXNzTmFtZTogUHJvcFR5cGVzLnN0cmluZ1xufTtcblxuY29uc3QgSW50ZXJuYWxTY3JlZW5SZWFkZXJUcmFuc2NyaXB0ID0gKHsgcmVuZGVyaW5nRWxlbWVudHMgfSkgPT4ge1xuICBjb25zdCBsb2NhbGl6ZSA9IHVzZUxvY2FsaXplcigpO1xuICBjb25zdCBbaW50ZXJuYWxMaXZlUmVnaW9uRmFkZUFmdGVyXSA9IHVzZVN0eWxlT3B0aW9ucygpO1xuXG4gIGNvbnN0IHRyYW5zY3JpcHRSb2xlRGVzY3JpcHRpb24gPSBsb2NhbGl6ZSgnVFJBTlNDUklQVF9BUklBX1JPTEVfQUxUJyk7XG5cbiAgcmV0dXJuIChcbiAgICA8c2VjdGlvblxuICAgICAgYXJpYS1hdG9taWM9e2ZhbHNlfVxuICAgICAgYXJpYS1saXZlPVwicG9saXRlXCJcbiAgICAgIGFyaWEtcmVsZXZhbnQ9XCJhZGRpdGlvbnNcIlxuICAgICAgYXJpYS1yb2xlZGVzY3JpcHRpb249e3RyYW5zY3JpcHRSb2xlRGVzY3JpcHRpb259XG4gICAgICByb2xlPVwibG9nXCJcbiAgICA+XG4gICAgICB7cmVuZGVyaW5nRWxlbWVudHMubWFwKCh7IGFjdGl2aXR5LCBsaXZlUmVnaW9uS2V5IH0pID0+IChcbiAgICAgICAgPEZhZGUgZmFkZUFmdGVyPXtpbnRlcm5hbExpdmVSZWdpb25GYWRlQWZ0ZXJ9IGtleT17bGl2ZVJlZ2lvbktleX0+XG4gICAgICAgICAgeygpID0+IDxTY3JlZW5SZWFkZXJBY3Rpdml0eSBhY3Rpdml0eT17YWN0aXZpdHl9IC8+fVxuICAgICAgICA8L0ZhZGU+XG4gICAgICApKX1cbiAgICA8L3NlY3Rpb24+XG4gICk7XG59O1xuXG5JbnRlcm5hbFNjcmVlblJlYWRlclRyYW5zY3JpcHQucHJvcFR5cGVzID0ge1xuICByZW5kZXJpbmdFbGVtZW50czogUHJvcFR5cGVzLmFycmF5T2YoXG4gICAgUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIGFjdGl2aXR5OiBQcm9wVHlwZXMuYW55LFxuICAgICAgbGl2ZVJlZ2lvbktleTogUHJvcFR5cGVzLnN0cmluZ1xuICAgIH0pXG4gICkuaXNSZXF1aXJlZFxufTtcblxuLy8gU2VwYXJhdGluZyBoaWdoLWZyZXF1ZW5jeSBob29rcyB0byBpbXByb3ZlIHBlcmZvcm1hbmNlLlxuY29uc3QgSW50ZXJuYWxUcmFuc2NyaXB0U2Nyb2xsYWJsZSA9ICh7IGFjdGl2aXRpZXMsIGNoaWxkcmVuLCBvbkZvY3VzQWN0aXZpdHksIG9uRm9jdXNGaWxsZXIsIHRlcm1pbmF0b3JSZWYgfSkgPT4ge1xuICBjb25zdCBbeyBhY3Rpdml0aWVzOiBhY3Rpdml0aWVzU3R5bGVTZXQgfV0gPSB1c2VTdHlsZVNldCgpO1xuICBjb25zdCBbeyBoaWRlU2Nyb2xsVG9FbmRCdXR0b24gfV0gPSB1c2VTdHlsZU9wdGlvbnMoKTtcbiAgY29uc3QgW2FuaW1hdGluZ1RvRW5kXSA9IHVzZUFuaW1hdGluZ1RvRW5kKCk7XG4gIGNvbnN0IFtzdGlja3ldID0gdXNlU3RpY2t5KCk7XG4gIGNvbnN0IGxhc3RWaXNpYmxlQWN0aXZpdHlJZCA9IGdldEFjdGl2aXR5VW5pcXVlSWQoYWN0aXZpdGllc1thY3Rpdml0aWVzLmxlbmd0aCAtIDFdIHx8IHt9KTsgLy8gQWN0aXZpdHkgSUQgb2YgdGhlIGxhc3QgdmlzaWJsZSBhY3Rpdml0eSBpbiB0aGUgbGlzdC5cbiAgY29uc3QgbG9jYWxpemUgPSB1c2VMb2NhbGl6ZXIoKTtcbiAgY29uc3Qgc2Nyb2xsVG9FbmRCdXR0b25SZWYgPSB1c2VSZWYoKTtcblxuICBjb25zdCBsYXN0UmVhZEFjdGl2aXR5SWRSZWYgPSB1c2VSZWYobGFzdFZpc2libGVBY3Rpdml0eUlkKTtcbiAgY29uc3QgdHJhbnNjcmlwdFJvbGVEZXNjcmlwdGlvbiA9IGxvY2FsaXplKCdUUkFOU0NSSVBUX0FSSUFfUk9MRV9BTFQnKTtcblxuICBjb25zdCBhbGxBY3Rpdml0aWVzUmVhZCA9IGxhc3RWaXNpYmxlQWN0aXZpdHlJZCA9PT0gbGFzdFJlYWRBY3Rpdml0eUlkUmVmLmN1cnJlbnQ7XG5cbiAgY29uc3QgaGFuZGxlU2Nyb2xsVG9FbmRCdXR0b25DbGljayA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAvLyBBZnRlciB0aGUgXCJOZXcgbWVzc2FnZVwiIGJ1dHRvbiBpcyBjbGlja2VkLCBmb2N1cyBvbiB0aGUgZmlyc3QgdW5yZWFkIGFjdGl2aXR5LlxuICAgIGNvbnN0IGluZGV4ID0gYWN0aXZpdGllcy5maW5kSW5kZXgoKHsgaWQgfSkgPT4gaWQgPT09IGxhc3RSZWFkQWN0aXZpdHlJZFJlZi5jdXJyZW50KTtcblxuICAgIGlmICh+aW5kZXgpIHtcbiAgICAgIGNvbnN0IGZpcnN0VW5yZWFkQWN0aXZpdHkgPSBhY3Rpdml0aWVzW2luZGV4ICsgMV07XG5cbiAgICAgIGlmIChmaXJzdFVucmVhZEFjdGl2aXR5KSB7XG4gICAgICAgIHJldHVybiBvbkZvY3VzQWN0aXZpdHkoZ2V0QWN0aXZpdHlVbmlxdWVJZChmaXJzdFVucmVhZEFjdGl2aXR5KSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgeyBjdXJyZW50IH0gPSB0ZXJtaW5hdG9yUmVmO1xuXG4gICAgY3VycmVudCAmJiBjdXJyZW50LmZvY3VzKCk7XG4gIH0sIFthY3Rpdml0aWVzLCBsYXN0UmVhZEFjdGl2aXR5SWRSZWYsIG9uRm9jdXNBY3Rpdml0eSwgdGVybWluYXRvclJlZl0pO1xuXG4gIGlmIChzdGlja3kpIHtcbiAgICAvLyBJZiBpdCBpcyBzdGlja3ksIHRoZSB1c2VyIGlzIGF0IHRoZSBib3R0b20gb2YgdGhlIHRyYW5zY3JpcHQsIGV2ZXJ5dGhpbmcgaXMgcmVhZC5cbiAgICAvLyBTbyBtYXJrIHRoZSBhY3Rpdml0eSBJRCBhcyByZWFkLlxuICAgIGxhc3RSZWFkQWN0aXZpdHlJZFJlZi5jdXJyZW50ID0gbGFzdFZpc2libGVBY3Rpdml0eUlkO1xuICB9XG5cbiAgLy8gRmluZHMgd2hlcmUgd2Ugc2hvdWxkIHJlbmRlciB0aGUgXCJOZXcgbWVzc2FnZXNcIiBidXR0b24sIGluIGluZGV4LiBSZXR1cm5zIC0xIHRvIGhpZGUgdGhlIGJ1dHRvbi5cbiAgY29uc3QgcmVuZGVyU2VwYXJhdG9yQWZ0ZXJJbmRleCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIC8vIERvbid0IHNob3cgdGhlIGJ1dHRvbiBpZjpcbiAgICAvLyAtIEFsbCBhY3Rpdml0aWVzIGhhdmUgYmVlbiByZWFkXG4gICAgLy8gLSBDdXJyZW50bHkgYW5pbWF0aW5nIHRvd2FyZHMgYm90dG9tXG4gICAgLy8gICAtIFwiTmV3IG1lc3NhZ2VzXCIgYnV0dG9uIG11c3Qgbm90IGZsYXNoIHdoZW46IDEuIFR5cGUgXCJoZWxwXCIsIDIuIFNjcm9sbCB0byB0b3AsIDMuIFR5cGUgXCJoZWxwXCIgYWdhaW4sIDQuIEV4cGVjdCB0aGUgXCJOZXcgbWVzc2FnZXNcIiBidXR0b24gbm90IGZsYXNoeVxuICAgIC8vIC0gSGlkZGVuIGJ5IHN0eWxlIG9wdGlvbnNcbiAgICAvLyAtIEl0IGlzIGFscmVhZHkgYXQgdGhlIGJvdHRvbSAoc3RpY2t5KVxuXG4gICAgLy8gQW55IGNoYW5nZXMgdG8gdGhpcyBsb2dpYywgdmVyaWZ5OlxuICAgIC8vIC0gXCJOZXcgbWVzc2FnZXNcIiBidXR0b24gc2hvdWxkIHBlcnNpc3Qgd2hpbGUgcHJvZ3JhbW1hdGljYWxseSBzY3JvbGxpbmcgdG8gbWlkLXBvaW50IG9mIHRoZSB0cmFuc2NyaXB0OlxuICAgIC8vICAgMS4gVHlwZSBcImhlbHBcIlxuICAgIC8vICAgMi4gVHlwZSBcInByb2FjdGl2ZVwiLCB0aGVuIGltbWVkaWF0ZWx5IHNjcm9sbCB0byB0b3BcbiAgICAvLyAgICAgIEV4cGVjdDogdGhlIFwiTmV3IG1lc3NhZ2VzXCIgYnV0dG9uIHNob3VsZCBhcHBlYXJcbiAgICAvLyAgIDMuIFJ1biBob29rIFwidXNlU2Nyb2xsVG8oeyBzY3JvbGxUb3A6IDUwMCB9KVwiXG4gICAgLy8gICAgICBFeHBlY3Q6IHdoZW4gdGhlIHNjcm9sbCBpcyBhbmltYXRpbmcgdG8gNTAwcHgsIHRoZSBcIk5ldyBtZXNzYWdlc1wiIGJ1dHRvbiBzaG91bGQga2VwdCBvbiB0aGUgc2NyZWVuXG4gICAgLy8gLSBcIk5ldyBtZXNzYWdlc1wiIGJ1dHRvbiBtdXN0IG5vdCBmbGFzaHk6XG4gICAgLy8gICAxLiBUeXBlIFwiaGVscFwiXG4gICAgLy8gICAyLiBTY3JvbGwgdG8gdG9wXG4gICAgLy8gICAgICBFeHBlY3Q6IG5vIFwiTmV3IG1lc3NhZ2VzXCIgYnV0dG9uIGlzIHNob3duXG4gICAgLy8gICAzLiBUeXBlIFwiaGVscFwiIGFnYWluXG4gICAgLy8gICAgICBFeHBlY3Q6IFwiTmV3IG1lc3NhZ2VzXCIgYnV0dG9uIG11c3Qgbm90IGZsYXNoLWFwcGVhclxuXG4gICAgaWYgKGFsbEFjdGl2aXRpZXNSZWFkIHx8IGFuaW1hdGluZ1RvRW5kIHx8IGhpZGVTY3JvbGxUb0VuZEJ1dHRvbiB8fCBzdGlja3kpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG5cbiAgICByZXR1cm4gYWN0aXZpdGllcy5maW5kSW5kZXgoYWN0aXZpdHkgPT4gZ2V0QWN0aXZpdHlVbmlxdWVJZChhY3Rpdml0eSkgPT09IGxhc3RSZWFkQWN0aXZpdHlJZFJlZi5jdXJyZW50KTtcbiAgfSwgW2FjdGl2aXRpZXMsIGFsbEFjdGl2aXRpZXNSZWFkLCBhbmltYXRpbmdUb0VuZCwgaGlkZVNjcm9sbFRvRW5kQnV0dG9uLCBsYXN0UmVhZEFjdGl2aXR5SWRSZWYsIHN0aWNreV0pO1xuXG4gIHJldHVybiAoXG4gICAgPFJlYWN0LkZyYWdtZW50PlxuICAgICAge3JlbmRlclNlcGFyYXRvckFmdGVySW5kZXggIT09IC0xICYmIChcbiAgICAgICAgPFNjcm9sbFRvRW5kQnV0dG9uIG9uQ2xpY2s9e2hhbmRsZVNjcm9sbFRvRW5kQnV0dG9uQ2xpY2t9IHJlZj17c2Nyb2xsVG9FbmRCdXR0b25SZWZ9IC8+XG4gICAgICApfVxuICAgICAgeyEhUmVhY3QuQ2hpbGRyZW4uY291bnQoY2hpbGRyZW4pICYmIChcbiAgICAgICAgPEZvY3VzUmVkaXJlY3RvciBjbGFzc05hbWU9XCJ3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19zZW50aW5lbFwiIHJlZGlyZWN0UmVmPXt0ZXJtaW5hdG9yUmVmfSAvPlxuICAgICAgKX1cbiAgICAgIDxSZWFjdFNjcm9sbFRvQm90dG9tUGFuZWwgY2xhc3NOYW1lPVwid2ViY2hhdF9fYmFzaWMtdHJhbnNjcmlwdF9fc2Nyb2xsYWJsZVwiPlxuICAgICAgICA8ZGl2IGFyaWEtaGlkZGVuPXt0cnVlfSBjbGFzc05hbWU9XCJ3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19maWxsZXJcIiBvbkZvY3VzPXtvbkZvY3VzRmlsbGVyfSAvPlxuICAgICAgICA8dWxcbiAgICAgICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj17dHJhbnNjcmlwdFJvbGVEZXNjcmlwdGlvbn1cbiAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoYWN0aXZpdGllc1N0eWxlU2V0ICsgJycsICd3ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X190cmFuc2NyaXB0Jyl9XG4gICAgICAgICAgcm9sZT1cImxpc3RcIlxuICAgICAgICA+XG4gICAgICAgICAge2NoaWxkcmVufVxuICAgICAgICA8L3VsPlxuICAgICAgICA8QmFzaWNUeXBpbmdJbmRpY2F0b3IgLz5cbiAgICAgIDwvUmVhY3RTY3JvbGxUb0JvdHRvbVBhbmVsPlxuICAgIDwvUmVhY3QuRnJhZ21lbnQ+XG4gICk7XG59O1xuXG5JbnRlcm5hbFRyYW5zY3JpcHRTY3JvbGxhYmxlLnByb3BUeXBlcyA9IHtcbiAgYWN0aXZpdGllczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LmlzUmVxdWlyZWQsXG4gIG9uRm9jdXNBY3Rpdml0eTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgb25Gb2N1c0ZpbGxlcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgdGVybWluYXRvclJlZjogUHJvcFR5cGVzLmFueS5pc1JlcXVpcmVkXG59O1xuXG5jb25zdCBTZXRTY3JvbGxlciA9ICh7IGFjdGl2aXR5RWxlbWVudHNSZWYsIHNjcm9sbGVyUmVmIH0pID0+IHtcbiAgY29uc3QgW1xuICAgIHsgYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5LCBhdXRvU2Nyb2xsU25hcE9uQWN0aXZpdHlPZmZzZXQsIGF1dG9TY3JvbGxTbmFwT25QYWdlLCBhdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCB9XG4gIF0gPSB1c2VTdHlsZU9wdGlvbnMoKTtcbiAgY29uc3QgW2xhc3RBY2tub3dsZWRnZWRBY3Rpdml0eV0gPSB1c2VBY2tub3dsZWRnZWRBY3Rpdml0eSgpO1xuXG4gIGNvbnN0IGxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eVJlZiA9IHVzZVJlZihsYXN0QWNrbm93bGVkZ2VkQWN0aXZpdHkpO1xuXG4gIGxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eVJlZi5jdXJyZW50ID0gbGFzdEFja25vd2xlZGdlZEFjdGl2aXR5O1xuXG4gIHNjcm9sbGVyUmVmLmN1cnJlbnQgPSB1c2VDYWxsYmFjayhcbiAgICAoeyBvZmZzZXRIZWlnaHQsIHNjcm9sbFRvcCB9KSA9PiB7XG4gICAgICBjb25zdCBwYXRjaGVkQXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5ID1cbiAgICAgICAgdHlwZW9mIGF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eSA9PT0gJ251bWJlcidcbiAgICAgICAgICA/IE1hdGgubWF4KDAsIGF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eSlcbiAgICAgICAgICA6IGF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eVxuICAgICAgICAgID8gMVxuICAgICAgICAgIDogMDtcbiAgICAgIGNvbnN0IHBhdGNoZWRBdXRvU2Nyb2xsU25hcE9uUGFnZSA9XG4gICAgICAgIHR5cGVvZiBhdXRvU2Nyb2xsU25hcE9uUGFnZSA9PT0gJ251bWJlcidcbiAgICAgICAgICA/IE1hdGgubWF4KDAsIE1hdGgubWluKDEsIGF1dG9TY3JvbGxTbmFwT25QYWdlKSlcbiAgICAgICAgICA6IGF1dG9TY3JvbGxTbmFwT25QYWdlXG4gICAgICAgICAgPyAxXG4gICAgICAgICAgOiAwO1xuICAgICAgY29uc3QgcGF0Y2hlZEF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eU9mZnNldCA9XG4gICAgICAgIHR5cGVvZiBhdXRvU2Nyb2xsU25hcE9uQWN0aXZpdHlPZmZzZXQgPT09ICdudW1iZXInID8gYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5T2Zmc2V0IDogMDtcbiAgICAgIGNvbnN0IHBhdGNoZWRBdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCA9XG4gICAgICAgIHR5cGVvZiBhdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCA9PT0gJ251bWJlcicgPyBhdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCA6IDA7XG5cbiAgICAgIGlmIChwYXRjaGVkQXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5IHx8IHBhdGNoZWRBdXRvU2Nyb2xsU25hcE9uUGFnZSkge1xuICAgICAgICBjb25zdCB7IGN1cnJlbnQ6IGxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eSB9ID0gbGFzdEFja25vd2xlZGdlZEFjdGl2aXR5UmVmO1xuXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IFtdO1xuXG4gICAgICAgIGlmIChwYXRjaGVkQXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5KSB7XG4gICAgICAgICAgY29uc3QgeyBlbGVtZW50OiBudGhVbmFja25vd2xlZGdlZEFjdGl2aXR5RWxlbWVudCB9ID1cbiAgICAgICAgICAgIGFjdGl2aXR5RWxlbWVudHNSZWYuY3VycmVudFtcbiAgICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50c1JlZi5jdXJyZW50LmZpbmRJbmRleCgoeyBhY3Rpdml0eSB9KSA9PiBhY3Rpdml0eSA9PT0gbGFzdEFja25vd2xlZGdlZEFjdGl2aXR5KSArXG4gICAgICAgICAgICAgICAgcGF0Y2hlZEF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eVxuICAgICAgICAgICAgXSB8fCB7fTtcblxuICAgICAgICAgIGlmIChudGhVbmFja25vd2xlZGdlZEFjdGl2aXR5RWxlbWVudCkge1xuICAgICAgICAgICAgdmFsdWVzLnB1c2goXG4gICAgICAgICAgICAgIG50aFVuYWNrbm93bGVkZ2VkQWN0aXZpdHlFbGVtZW50Lm9mZnNldFRvcCArXG4gICAgICAgICAgICAgICAgbnRoVW5hY2tub3dsZWRnZWRBY3Rpdml0eUVsZW1lbnQub2Zmc2V0SGVpZ2h0IC1cbiAgICAgICAgICAgICAgICBvZmZzZXRIZWlnaHQgLVxuICAgICAgICAgICAgICAgIHNjcm9sbFRvcCArXG4gICAgICAgICAgICAgICAgcGF0Y2hlZEF1dG9TY3JvbGxTbmFwT25BY3Rpdml0eU9mZnNldFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAocGF0Y2hlZEF1dG9TY3JvbGxTbmFwT25QYWdlKSB7XG4gICAgICAgICAgY29uc3QgeyBlbGVtZW50OiBmaXJzdFVuYWNrbm93bGVkZ2VkQWN0aXZpdHlFbGVtZW50IH0gPVxuICAgICAgICAgICAgYWN0aXZpdHlFbGVtZW50c1JlZi5jdXJyZW50W1xuICAgICAgICAgICAgICBhY3Rpdml0eUVsZW1lbnRzUmVmLmN1cnJlbnQuZmluZEluZGV4KCh7IGFjdGl2aXR5IH0pID0+IGFjdGl2aXR5ID09PSBsYXN0QWNrbm93bGVkZ2VkQWN0aXZpdHkpICsgMVxuICAgICAgICAgICAgXSB8fCB7fTtcblxuICAgICAgICAgIGlmIChmaXJzdFVuYWNrbm93bGVkZ2VkQWN0aXZpdHlFbGVtZW50KSB7XG4gICAgICAgICAgICB2YWx1ZXMucHVzaChcbiAgICAgICAgICAgICAgZmlyc3RVbmFja25vd2xlZGdlZEFjdGl2aXR5RWxlbWVudC5vZmZzZXRUb3AgLVxuICAgICAgICAgICAgICAgIHNjcm9sbFRvcCAtXG4gICAgICAgICAgICAgICAgb2Zmc2V0SGVpZ2h0ICogKDEgLSBwYXRjaGVkQXV0b1Njcm9sbFNuYXBPblBhZ2UpICtcbiAgICAgICAgICAgICAgICBwYXRjaGVkQXV0b1Njcm9sbFNuYXBPblBhZ2VPZmZzZXRcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHZhbHVlcy5yZWR1Y2UoKG1pblZhbHVlLCB2YWx1ZSkgPT4gTWF0aC5taW4obWluVmFsdWUsIHZhbHVlKSwgSW5maW5pdHkpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gSW5maW5pdHk7XG4gICAgfSxcbiAgICBbXG4gICAgICBhY3Rpdml0eUVsZW1lbnRzUmVmLFxuICAgICAgYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5LFxuICAgICAgYXV0b1Njcm9sbFNuYXBPbkFjdGl2aXR5T2Zmc2V0LFxuICAgICAgYXV0b1Njcm9sbFNuYXBPblBhZ2UsXG4gICAgICBhdXRvU2Nyb2xsU25hcE9uUGFnZU9mZnNldCxcbiAgICAgIGxhc3RBY2tub3dsZWRnZWRBY3Rpdml0eVJlZlxuICAgIF1cbiAgKTtcblxuICByZXR1cm4gZmFsc2U7XG59O1xuXG5jb25zdCBCYXNpY1RyYW5zY3JpcHQgPSAoeyBjbGFzc05hbWUgfSkgPT4ge1xuICBjb25zdCBhY3Rpdml0eUVsZW1lbnRzUmVmID0gdXNlUmVmKFtdKTtcbiAgY29uc3Qgc2Nyb2xsZXJSZWYgPSB1c2VSZWYoKCkgPT4gSW5maW5pdHkpO1xuXG4gIGNvbnN0IHNjcm9sbGVyID0gdXNlQ2FsbGJhY2soKC4uLmFyZ3MpID0+IHNjcm9sbGVyUmVmLmN1cnJlbnQoLi4uYXJncyksIFtzY3JvbGxlclJlZl0pO1xuXG4gIHJldHVybiAoXG4gICAgPFJlYWN0U2Nyb2xsVG9Cb3R0b21Db21wb3NlciBzY3JvbGxlcj17c2Nyb2xsZXJ9PlxuICAgICAgPFNldFNjcm9sbGVyIGFjdGl2aXR5RWxlbWVudHNSZWY9e2FjdGl2aXR5RWxlbWVudHNSZWZ9IHNjcm9sbGVyUmVmPXtzY3JvbGxlclJlZn0gLz5cbiAgICAgIDxJbnRlcm5hbFRyYW5zY3JpcHQgYWN0aXZpdHlFbGVtZW50c1JlZj17YWN0aXZpdHlFbGVtZW50c1JlZn0gY2xhc3NOYW1lPXtjbGFzc05hbWV9IC8+XG4gICAgPC9SZWFjdFNjcm9sbFRvQm90dG9tQ29tcG9zZXI+XG4gICk7XG59O1xuXG5CYXNpY1RyYW5zY3JpcHQuZGVmYXVsdFByb3BzID0ge1xuICBjbGFzc05hbWU6ICcnXG59O1xuXG5CYXNpY1RyYW5zY3JpcHQucHJvcFR5cGVzID0ge1xuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmdcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEJhc2ljVHJhbnNjcmlwdDtcbiJdfQ==