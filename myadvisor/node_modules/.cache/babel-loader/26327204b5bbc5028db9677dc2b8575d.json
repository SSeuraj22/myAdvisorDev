{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UUID = exports.SizeAndUnit = exports.PaddingDefinition = exports.SpacingDefinition = exports.StringWithSubstitutions = exports.ContentTypes = exports.GlobalSettings = void 0; // Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n\nvar Enums = require(\"./enums\");\n\nvar GlobalSettings =\n/** @class */\nfunction () {\n  function GlobalSettings() {}\n\n  GlobalSettings.useAdvancedTextBlockTruncation = true;\n  GlobalSettings.useAdvancedCardBottomTruncation = false;\n  GlobalSettings.useMarkdownInRadioButtonAndCheckbox = true;\n  GlobalSettings.allowMarkForTextHighlighting = false;\n  GlobalSettings.alwaysBleedSeparators = false;\n  GlobalSettings.enableFullJsonRoundTrip = false;\n  GlobalSettings.displayInputValidationErrors = true;\n  GlobalSettings.allowPreProcessingPropertyValues = false;\n  GlobalSettings.setTabIndexAtCardRoot = true;\n  GlobalSettings.enableFallback = true;\n  return GlobalSettings;\n}();\n\nexports.GlobalSettings = GlobalSettings;\nexports.ContentTypes = {\n  applicationJson: \"application/json\",\n  applicationXWwwFormUrlencoded: \"application/x-www-form-urlencoded\"\n};\n\nvar StringWithSubstitutions =\n/** @class */\nfunction () {\n  function StringWithSubstitutions() {\n    this._isProcessed = false;\n  }\n\n  StringWithSubstitutions.prototype.getReferencedInputs = function (inputs, referencedInputs) {\n    if (!referencedInputs) {\n      throw new Error(\"The referencedInputs parameter cannot be null.\");\n    }\n\n    for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n      var input = inputs_1[_i];\n      var matches = new RegExp(\"\\\\{{2}(\" + input.id + \").value\\\\}{2}\", \"gi\").exec(this._original);\n\n      if (matches != null && input.id) {\n        referencedInputs[input.id] = input;\n      }\n    }\n  };\n\n  StringWithSubstitutions.prototype.substituteInputValues = function (inputs, contentType) {\n    this._processed = this._original;\n\n    if (this._original) {\n      var regEx = /\\{{2}([a-z0-9_$@]+).value\\}{2}/gi;\n      var matches = void 0;\n\n      while ((matches = regEx.exec(this._original)) !== null) {\n        for (var _i = 0, _a = Object.keys(inputs); _i < _a.length; _i++) {\n          var key = _a[_i];\n\n          if (key.toLowerCase() == matches[1].toLowerCase()) {\n            var matchedInput = inputs[key];\n            var valueForReplace = \"\";\n\n            if (matchedInput.value) {\n              valueForReplace = matchedInput.value;\n            }\n\n            if (contentType === exports.ContentTypes.applicationJson) {\n              valueForReplace = JSON.stringify(valueForReplace);\n              valueForReplace = valueForReplace.slice(1, -1);\n            } else if (contentType === exports.ContentTypes.applicationXWwwFormUrlencoded) {\n              valueForReplace = encodeURIComponent(valueForReplace);\n            }\n\n            this._processed = this._processed.replace(matches[0], valueForReplace);\n            break;\n          }\n        }\n      }\n    }\n\n    this._isProcessed = true;\n  };\n\n  StringWithSubstitutions.prototype.getOriginal = function () {\n    return this._original;\n  };\n\n  StringWithSubstitutions.prototype.get = function () {\n    if (!this._isProcessed) {\n      return this._original;\n    } else {\n      return this._processed;\n    }\n  };\n\n  StringWithSubstitutions.prototype.set = function (value) {\n    this._original = value;\n    this._isProcessed = false;\n  };\n\n  return StringWithSubstitutions;\n}();\n\nexports.StringWithSubstitutions = StringWithSubstitutions;\n\nvar SpacingDefinition =\n/** @class */\nfunction () {\n  function SpacingDefinition(top, right, bottom, left) {\n    if (top === void 0) {\n      top = 0;\n    }\n\n    if (right === void 0) {\n      right = 0;\n    }\n\n    if (bottom === void 0) {\n      bottom = 0;\n    }\n\n    if (left === void 0) {\n      left = 0;\n    }\n\n    this.left = 0;\n    this.top = 0;\n    this.right = 0;\n    this.bottom = 0;\n    this.top = top;\n    this.right = right;\n    this.bottom = bottom;\n    this.left = left;\n  }\n\n  return SpacingDefinition;\n}();\n\nexports.SpacingDefinition = SpacingDefinition;\n\nvar PaddingDefinition =\n/** @class */\nfunction () {\n  function PaddingDefinition(top, right, bottom, left) {\n    if (top === void 0) {\n      top = Enums.Spacing.None;\n    }\n\n    if (right === void 0) {\n      right = Enums.Spacing.None;\n    }\n\n    if (bottom === void 0) {\n      bottom = Enums.Spacing.None;\n    }\n\n    if (left === void 0) {\n      left = Enums.Spacing.None;\n    }\n\n    this.top = Enums.Spacing.None;\n    this.right = Enums.Spacing.None;\n    this.bottom = Enums.Spacing.None;\n    this.left = Enums.Spacing.None;\n    this.top = top;\n    this.right = right;\n    this.bottom = bottom;\n    this.left = left;\n  }\n\n  return PaddingDefinition;\n}();\n\nexports.PaddingDefinition = PaddingDefinition;\n\nvar SizeAndUnit =\n/** @class */\nfunction () {\n  function SizeAndUnit(physicalSize, unit) {\n    this.physicalSize = physicalSize;\n    this.unit = unit;\n  }\n\n  SizeAndUnit.parse = function (input, requireUnitSpecifier) {\n    if (requireUnitSpecifier === void 0) {\n      requireUnitSpecifier = false;\n    }\n\n    var result = new SizeAndUnit(0, Enums.SizeUnit.Weight);\n\n    if (typeof input === \"number\") {\n      result.physicalSize = input;\n      return result;\n    } else if (typeof input === \"string\") {\n      var regExp = /^([0-9]+)(px|\\*)?$/g;\n      var matches = regExp.exec(input);\n      var expectedMatchCount = requireUnitSpecifier ? 3 : 2;\n\n      if (matches && matches.length >= expectedMatchCount) {\n        result.physicalSize = parseInt(matches[1]);\n\n        if (matches.length == 3) {\n          if (matches[2] == \"px\") {\n            result.unit = Enums.SizeUnit.Pixel;\n          }\n        }\n\n        return result;\n      }\n    }\n\n    throw new Error(\"Invalid size: \" + input);\n  };\n\n  return SizeAndUnit;\n}();\n\nexports.SizeAndUnit = SizeAndUnit;\n/**\r\n * Fast UUID generator, RFC4122 version 4 compliant.\r\n * @author Jeff Ward (jcward.com).\r\n * @license MIT license\r\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n **/\n\nvar UUID =\n/** @class */\nfunction () {\n  function UUID() {}\n\n  UUID.generate = function () {\n    var d0 = Math.random() * 0xffffffff | 0;\n    var d1 = Math.random() * 0xffffffff | 0;\n    var d2 = Math.random() * 0xffffffff | 0;\n    var d3 = Math.random() * 0xffffffff | 0;\n    return UUID.lut[d0 & 0xff] + UUID.lut[d0 >> 8 & 0xff] + UUID.lut[d0 >> 16 & 0xff] + UUID.lut[d0 >> 24 & 0xff] + '-' + UUID.lut[d1 & 0xff] + UUID.lut[d1 >> 8 & 0xff] + '-' + UUID.lut[d1 >> 16 & 0x0f | 0x40] + UUID.lut[d1 >> 24 & 0xff] + '-' + UUID.lut[d2 & 0x3f | 0x80] + UUID.lut[d2 >> 8 & 0xff] + '-' + UUID.lut[d2 >> 16 & 0xff] + UUID.lut[d2 >> 24 & 0xff] + UUID.lut[d3 & 0xff] + UUID.lut[d3 >> 8 & 0xff] + UUID.lut[d3 >> 16 & 0xff] + UUID.lut[d3 >> 24 & 0xff];\n  };\n\n  UUID.initialize = function () {\n    for (var i = 0; i < 256; i++) {\n      UUID.lut[i] = (i < 16 ? '0' : '') + i.toString(16);\n    }\n  };\n\n  UUID.lut = [];\n  return UUID;\n}();\n\nexports.UUID = UUID;\nUUID.initialize();","map":{"version":3,"sources":["../src/shared.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.UUID = exports.SizeAndUnit = exports.PaddingDefinition = exports.SpacingDefinition = exports.StringWithSubstitutions = exports.ContentTypes = exports.GlobalSettings = void 0;\r\n// Copyright (c) Microsoft Corporation. All rights reserved.\r\n// Licensed under the MIT License.\r\nvar Enums = require(\"./enums\");\r\nvar GlobalSettings = /** @class */ (function () {\r\n    function GlobalSettings() {\r\n    }\r\n    GlobalSettings.useAdvancedTextBlockTruncation = true;\r\n    GlobalSettings.useAdvancedCardBottomTruncation = false;\r\n    GlobalSettings.useMarkdownInRadioButtonAndCheckbox = true;\r\n    GlobalSettings.allowMarkForTextHighlighting = false;\r\n    GlobalSettings.alwaysBleedSeparators = false;\r\n    GlobalSettings.enableFullJsonRoundTrip = false;\r\n    GlobalSettings.displayInputValidationErrors = true;\r\n    GlobalSettings.allowPreProcessingPropertyValues = false;\r\n    GlobalSettings.setTabIndexAtCardRoot = true;\r\n    GlobalSettings.enableFallback = true;\r\n    return GlobalSettings;\r\n}());\r\nexports.GlobalSettings = GlobalSettings;\r\nexports.ContentTypes = {\r\n    applicationJson: \"application/json\",\r\n    applicationXWwwFormUrlencoded: \"application/x-www-form-urlencoded\"\r\n};\r\nvar StringWithSubstitutions = /** @class */ (function () {\r\n    function StringWithSubstitutions() {\r\n        this._isProcessed = false;\r\n    }\r\n    StringWithSubstitutions.prototype.getReferencedInputs = function (inputs, referencedInputs) {\r\n        if (!referencedInputs) {\r\n            throw new Error(\"The referencedInputs parameter cannot be null.\");\r\n        }\r\n        for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\r\n            var input = inputs_1[_i];\r\n            var matches = new RegExp(\"\\\\{{2}(\" + input.id + \").value\\\\}{2}\", \"gi\").exec(this._original);\r\n            if (matches != null && input.id) {\r\n                referencedInputs[input.id] = input;\r\n            }\r\n        }\r\n    };\r\n    StringWithSubstitutions.prototype.substituteInputValues = function (inputs, contentType) {\r\n        this._processed = this._original;\r\n        if (this._original) {\r\n            var regEx = /\\{{2}([a-z0-9_$@]+).value\\}{2}/gi;\r\n            var matches = void 0;\r\n            while ((matches = regEx.exec(this._original)) !== null) {\r\n                for (var _i = 0, _a = Object.keys(inputs); _i < _a.length; _i++) {\r\n                    var key = _a[_i];\r\n                    if (key.toLowerCase() == matches[1].toLowerCase()) {\r\n                        var matchedInput = inputs[key];\r\n                        var valueForReplace = \"\";\r\n                        if (matchedInput.value) {\r\n                            valueForReplace = matchedInput.value;\r\n                        }\r\n                        if (contentType === exports.ContentTypes.applicationJson) {\r\n                            valueForReplace = JSON.stringify(valueForReplace);\r\n                            valueForReplace = valueForReplace.slice(1, -1);\r\n                        }\r\n                        else if (contentType === exports.ContentTypes.applicationXWwwFormUrlencoded) {\r\n                            valueForReplace = encodeURIComponent(valueForReplace);\r\n                        }\r\n                        this._processed = this._processed.replace(matches[0], valueForReplace);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this._isProcessed = true;\r\n    };\r\n    StringWithSubstitutions.prototype.getOriginal = function () {\r\n        return this._original;\r\n    };\r\n    StringWithSubstitutions.prototype.get = function () {\r\n        if (!this._isProcessed) {\r\n            return this._original;\r\n        }\r\n        else {\r\n            return this._processed;\r\n        }\r\n    };\r\n    StringWithSubstitutions.prototype.set = function (value) {\r\n        this._original = value;\r\n        this._isProcessed = false;\r\n    };\r\n    return StringWithSubstitutions;\r\n}());\r\nexports.StringWithSubstitutions = StringWithSubstitutions;\r\nvar SpacingDefinition = /** @class */ (function () {\r\n    function SpacingDefinition(top, right, bottom, left) {\r\n        if (top === void 0) { top = 0; }\r\n        if (right === void 0) { right = 0; }\r\n        if (bottom === void 0) { bottom = 0; }\r\n        if (left === void 0) { left = 0; }\r\n        this.left = 0;\r\n        this.top = 0;\r\n        this.right = 0;\r\n        this.bottom = 0;\r\n        this.top = top;\r\n        this.right = right;\r\n        this.bottom = bottom;\r\n        this.left = left;\r\n    }\r\n    return SpacingDefinition;\r\n}());\r\nexports.SpacingDefinition = SpacingDefinition;\r\nvar PaddingDefinition = /** @class */ (function () {\r\n    function PaddingDefinition(top, right, bottom, left) {\r\n        if (top === void 0) { top = Enums.Spacing.None; }\r\n        if (right === void 0) { right = Enums.Spacing.None; }\r\n        if (bottom === void 0) { bottom = Enums.Spacing.None; }\r\n        if (left === void 0) { left = Enums.Spacing.None; }\r\n        this.top = Enums.Spacing.None;\r\n        this.right = Enums.Spacing.None;\r\n        this.bottom = Enums.Spacing.None;\r\n        this.left = Enums.Spacing.None;\r\n        this.top = top;\r\n        this.right = right;\r\n        this.bottom = bottom;\r\n        this.left = left;\r\n    }\r\n    return PaddingDefinition;\r\n}());\r\nexports.PaddingDefinition = PaddingDefinition;\r\nvar SizeAndUnit = /** @class */ (function () {\r\n    function SizeAndUnit(physicalSize, unit) {\r\n        this.physicalSize = physicalSize;\r\n        this.unit = unit;\r\n    }\r\n    SizeAndUnit.parse = function (input, requireUnitSpecifier) {\r\n        if (requireUnitSpecifier === void 0) { requireUnitSpecifier = false; }\r\n        var result = new SizeAndUnit(0, Enums.SizeUnit.Weight);\r\n        if (typeof input === \"number\") {\r\n            result.physicalSize = input;\r\n            return result;\r\n        }\r\n        else if (typeof input === \"string\") {\r\n            var regExp = /^([0-9]+)(px|\\*)?$/g;\r\n            var matches = regExp.exec(input);\r\n            var expectedMatchCount = requireUnitSpecifier ? 3 : 2;\r\n            if (matches && matches.length >= expectedMatchCount) {\r\n                result.physicalSize = parseInt(matches[1]);\r\n                if (matches.length == 3) {\r\n                    if (matches[2] == \"px\") {\r\n                        result.unit = Enums.SizeUnit.Pixel;\r\n                    }\r\n                }\r\n                return result;\r\n            }\r\n        }\r\n        throw new Error(\"Invalid size: \" + input);\r\n    };\r\n    return SizeAndUnit;\r\n}());\r\nexports.SizeAndUnit = SizeAndUnit;\r\n/**\r\n * Fast UUID generator, RFC4122 version 4 compliant.\r\n * @author Jeff Ward (jcward.com).\r\n * @license MIT license\r\n * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136\r\n **/\r\nvar UUID = /** @class */ (function () {\r\n    function UUID() {\r\n    }\r\n    UUID.generate = function () {\r\n        var d0 = Math.random() * 0xffffffff | 0;\r\n        var d1 = Math.random() * 0xffffffff | 0;\r\n        var d2 = Math.random() * 0xffffffff | 0;\r\n        var d3 = Math.random() * 0xffffffff | 0;\r\n        return UUID.lut[d0 & 0xff] + UUID.lut[d0 >> 8 & 0xff] + UUID.lut[d0 >> 16 & 0xff] + UUID.lut[d0 >> 24 & 0xff] + '-' +\r\n            UUID.lut[d1 & 0xff] + UUID.lut[d1 >> 8 & 0xff] + '-' + UUID.lut[d1 >> 16 & 0x0f | 0x40] + UUID.lut[d1 >> 24 & 0xff] + '-' +\r\n            UUID.lut[d2 & 0x3f | 0x80] + UUID.lut[d2 >> 8 & 0xff] + '-' + UUID.lut[d2 >> 16 & 0xff] + UUID.lut[d2 >> 24 & 0xff] +\r\n            UUID.lut[d3 & 0xff] + UUID.lut[d3 >> 8 & 0xff] + UUID.lut[d3 >> 16 & 0xff] + UUID.lut[d3 >> 24 & 0xff];\r\n    };\r\n    UUID.initialize = function () {\r\n        for (var i = 0; i < 256; i++) {\r\n            UUID.lut[i] = (i < 16 ? '0' : '') + i.toString(16);\r\n        }\r\n    };\r\n    UUID.lut = [];\r\n    return UUID;\r\n}());\r\nexports.UUID = UUID;\r\nUUID.initialize();\r\n//# sourceMappingURL=shared.js.map"]},"metadata":{},"sourceType":"script"}