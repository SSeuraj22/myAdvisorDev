{"ast":null,"code":"\"use strict\";\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _botframeworkWebchatApi = require(\"botframework-webchat-api\");\n\nvar _reactSay = require(\"react-say\");\n\nvar _createEmotion = _interopRequireDefault(require(\"create-emotion\"));\n\nvar _createStyleSet = _interopRequireDefault(require(\"./Styles/createStyleSet\"));\n\nvar _markdownIt = _interopRequireDefault(require(\"markdown-it\"));\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _BypassSpeechSynthesisPonyfill = require(\"./hooks/internal/BypassSpeechSynthesisPonyfill\");\n\nvar _addTargetBlankToHyperlinksMarkdown = _interopRequireDefault(require(\"./Utils/addTargetBlankToHyperlinksMarkdown\"));\n\nvar _createCSSKey = _interopRequireDefault(require(\"./Utils/createCSSKey\"));\n\nvar _createCoreMiddleware = _interopRequireDefault(require(\"./Middleware/Activity/createCoreMiddleware\"));\n\nvar _createCoreMiddleware2 = _interopRequireDefault(require(\"./Middleware/ActivityStatus/createCoreMiddleware\"));\n\nvar _createCoreMiddleware3 = _interopRequireDefault(require(\"./Middleware/AttachmentForScreenReader/createCoreMiddleware\"));\n\nvar _createCoreMiddleware4 = _interopRequireDefault(require(\"./Middleware/Attachment/createCoreMiddleware\"));\n\nvar _createCoreMiddleware5 = _interopRequireDefault(require(\"./Middleware/Avatar/createCoreMiddleware\"));\n\nvar _createCoreMiddleware6 = _interopRequireDefault(require(\"./Middleware/CardAction/createCoreMiddleware\"));\n\nvar _createCoreMiddleware7 = _interopRequireDefault(require(\"./Middleware/Toast/createCoreMiddleware\"));\n\nvar _createCoreMiddleware8 = _interopRequireDefault(require(\"./Middleware/TypingIndicator/createCoreMiddleware\"));\n\nvar _Dictation = _interopRequireDefault(require(\"./Dictation\"));\n\nvar _downscaleImageToDataURL = _interopRequireDefault(require(\"./Utils/downscaleImageToDataURL\"));\n\nvar _ErrorBox = _interopRequireDefault(require(\"./ErrorBox\"));\n\nvar _mapMap = _interopRequireDefault(require(\"./Utils/mapMap\"));\n\nvar _singleToArray = _interopRequireDefault(require(\"./Utils/singleToArray\"));\n\nvar _UITracker = _interopRequireDefault(require(\"./hooks/internal/UITracker\"));\n\nvar _WebChatUIContext = _interopRequireDefault(require(\"./hooks/internal/WebChatUIContext\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nvar useReferenceGrammarID = _botframeworkWebchatApi.hooks.useReferenceGrammarID,\n    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions; // eslint-disable-next-line no-undef\n\nvar node_env = undefined || \"production\";\nvar emotionPool = {};\n\nfunction styleSetToEmotionObjects(styleToEmotionObject, styleSet) {\n  return (0, _mapMap.default)(styleSet, function (style, key) {\n    return key === 'options' ? style : styleToEmotionObject(style);\n  });\n}\n\nvar ComposerCore = function ComposerCore(_ref) {\n  var children = _ref.children,\n      extraStyleSet = _ref.extraStyleSet,\n      nonce = _ref.nonce,\n      renderMarkdown = _ref.renderMarkdown,\n      styleSet = _ref.styleSet,\n      suggestedActionsAccessKey = _ref.suggestedActionsAccessKey,\n      webSpeechPonyfillFactory = _ref.webSpeechPonyfillFactory;\n\n  var _useState = (0, _react.useState)(),\n      _useState2 = _slicedToArray(_useState, 2),\n      dictateAbortable = _useState2[0],\n      setDictateAbortable = _useState2[1];\n\n  var _useReferenceGrammarI = useReferenceGrammarID(),\n      _useReferenceGrammarI2 = _slicedToArray(_useReferenceGrammarI, 1),\n      referenceGrammarID = _useReferenceGrammarI2[0];\n\n  var _useStyleOptions = useStyleOptions(),\n      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),\n      styleOptions = _useStyleOptions2[0];\n\n  var focusSendBoxCallbacksRef = (0, _react.useRef)([]);\n  var focusTranscriptCallbacksRef = (0, _react.useRef)([]);\n  var internalMarkdownIt = (0, _react.useMemo)(function () {\n    return new _markdownIt.default();\n  }, []);\n  var scrollToCallbacksRef = (0, _react.useRef)([]);\n  var scrollToEndCallbacksRef = (0, _react.useRef)([]); // Instead of having a `scrollUpCallbacksRef` and `scrollDownCallbacksRef`, they are combined into a single `scrollRelativeCallbacksRef`.\n  // The first argument tells whether it should go \"up\" or \"down\".\n\n  var scrollRelativeCallbacksRef = (0, _react.useRef)([]);\n  var dictationOnError = (0, _react.useCallback)(function (err) {\n    console.error(err);\n  }, []);\n  var internalRenderMarkdownInline = (0, _react.useMemo)(function () {\n    return function (markdown) {\n      var tree = internalMarkdownIt.parseInline(markdown); // We should add rel=\"noopener noreferrer\" and target=\"_blank\"\n\n      var patchedTree = (0, _addTargetBlankToHyperlinksMarkdown.default)(tree);\n      return internalMarkdownIt.renderer.render(patchedTree);\n    };\n  }, [internalMarkdownIt]);\n  var styleToEmotionObject = (0, _react.useMemo)(function () {\n    // Emotion doesn't hash with nonce. We need to provide the pooling mechanism.\n    // 1. If 2 instances use different nonce, they should result in different hash;\n    // 2. If 2 instances are being mounted, pooling will make sure we render only 1 set of <style> tags, instead of 2.\n    var emotion = emotionPool[nonce] || (emotionPool[nonce] = (0, _createEmotion.default)({\n      key: \"webchat--css-\".concat((0, _createCSSKey.default)()),\n      nonce: nonce\n    }));\n    return function (style) {\n      return emotion.css(style);\n    };\n  }, [nonce]);\n  var patchedStyleSet = (0, _react.useMemo)(function () {\n    return styleSetToEmotionObjects(styleToEmotionObject, _objectSpread(_objectSpread({}, styleSet || (0, _createStyleSet.default)(styleOptions)), extraStyleSet));\n  }, [extraStyleSet, styleOptions, styleSet, styleToEmotionObject]);\n  var webSpeechPonyfill = (0, _react.useMemo)(function () {\n    var ponyfill = webSpeechPonyfillFactory && webSpeechPonyfillFactory({\n      referenceGrammarID: referenceGrammarID\n    });\n\n    var _ref2 = ponyfill || {},\n        speechSynthesis = _ref2.speechSynthesis,\n        SpeechSynthesisUtterance = _ref2.SpeechSynthesisUtterance;\n\n    return _objectSpread(_objectSpread({}, ponyfill), {}, {\n      speechSynthesis: speechSynthesis || _BypassSpeechSynthesisPonyfill.speechSynthesis,\n      SpeechSynthesisUtterance: SpeechSynthesisUtterance || _BypassSpeechSynthesisPonyfill.SpeechSynthesisUtterance\n    });\n  }, [referenceGrammarID, webSpeechPonyfillFactory]);\n  var scrollPositionObserversRef = (0, _react.useRef)([]);\n\n  var _useState3 = (0, _react.useState)(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      numScrollPositionObservers = _useState4[0],\n      setNumScrollPositionObservers = _useState4[1];\n\n  var dispatchScrollPosition = (0, _react.useCallback)(function (event) {\n    return scrollPositionObserversRef.current.forEach(function (observer) {\n      return observer(event);\n    });\n  }, [scrollPositionObserversRef]);\n  var observeScrollPosition = (0, _react.useCallback)(function (observer) {\n    scrollPositionObserversRef.current = [].concat(_toConsumableArray(scrollPositionObserversRef.current), [observer]);\n    setNumScrollPositionObservers(scrollPositionObserversRef.current.length);\n    return function () {\n      scrollPositionObserversRef.current = scrollPositionObserversRef.current.filter(function (target) {\n        return target !== observer;\n      });\n      setNumScrollPositionObservers(scrollPositionObserversRef.current.length);\n    };\n  }, [scrollPositionObserversRef, setNumScrollPositionObservers]);\n  var transcriptFocusObserversRef = (0, _react.useRef)([]);\n\n  var _useState5 = (0, _react.useState)(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      numTranscriptFocusObservers = _useState6[0],\n      setNumTranscriptFocusObservers = _useState6[1];\n\n  var dispatchTranscriptFocus = (0, _react.useCallback)(function (event) {\n    return transcriptFocusObserversRef.current.forEach(function (observer) {\n      return observer(event);\n    });\n  }, [transcriptFocusObserversRef]);\n  var observeTranscriptFocus = (0, _react.useCallback)(function (observer) {\n    transcriptFocusObserversRef.current = [].concat(_toConsumableArray(transcriptFocusObserversRef.current), [observer]);\n    setNumTranscriptFocusObservers(transcriptFocusObserversRef.current.length);\n    return function () {\n      transcriptFocusObserversRef.current = transcriptFocusObserversRef.current.filter(function (target) {\n        return target !== observer;\n      });\n      setNumTranscriptFocusObservers(transcriptFocusObserversRef.current.length);\n    };\n  }, [transcriptFocusObserversRef, setNumTranscriptFocusObservers]);\n  var context = (0, _react.useMemo)(function () {\n    return {\n      dictateAbortable: dictateAbortable,\n      dispatchScrollPosition: dispatchScrollPosition,\n      dispatchTranscriptFocus: dispatchTranscriptFocus,\n      focusSendBoxCallbacksRef: focusSendBoxCallbacksRef,\n      focusTranscriptCallbacksRef: focusTranscriptCallbacksRef,\n      internalMarkdownItState: [internalMarkdownIt],\n      internalRenderMarkdownInline: internalRenderMarkdownInline,\n      nonce: nonce,\n      numScrollPositionObservers: numScrollPositionObservers,\n      numTranscriptFocusObservers: numTranscriptFocusObservers,\n      observeScrollPosition: observeScrollPosition,\n      observeTranscriptFocus: observeTranscriptFocus,\n      renderMarkdown: renderMarkdown,\n      scrollRelativeCallbacksRef: scrollRelativeCallbacksRef,\n      scrollToCallbacksRef: scrollToCallbacksRef,\n      scrollToEndCallbacksRef: scrollToEndCallbacksRef,\n      setDictateAbortable: setDictateAbortable,\n      styleSet: patchedStyleSet,\n      styleToEmotionObject: styleToEmotionObject,\n      suggestedActionsAccessKey: suggestedActionsAccessKey,\n      webSpeechPonyfill: webSpeechPonyfill\n    };\n  }, [dictateAbortable, dispatchScrollPosition, dispatchTranscriptFocus, focusSendBoxCallbacksRef, focusTranscriptCallbacksRef, internalMarkdownIt, internalRenderMarkdownInline, nonce, numScrollPositionObservers, numTranscriptFocusObservers, observeScrollPosition, observeTranscriptFocus, patchedStyleSet, renderMarkdown, scrollRelativeCallbacksRef, scrollToCallbacksRef, scrollToEndCallbacksRef, setDictateAbortable, styleToEmotionObject, suggestedActionsAccessKey, webSpeechPonyfill]);\n  return /*#__PURE__*/_react.default.createElement(_reactSay.Composer, {\n    ponyfill: webSpeechPonyfill\n  }, /*#__PURE__*/_react.default.createElement(_WebChatUIContext.default.Provider, {\n    value: context\n  }, children, /*#__PURE__*/_react.default.createElement(_Dictation.default, {\n    onError: dictationOnError\n  })));\n};\n\nComposerCore.defaultProps = {\n  extraStyleSet: undefined,\n  nonce: undefined,\n  renderMarkdown: undefined,\n  styleSet: undefined,\n  suggestedActionsAccessKey: 'A a Å å',\n  webSpeechPonyfillFactory: undefined\n};\nComposerCore.propTypes = {\n  extraStyleSet: _propTypes.default.any,\n  nonce: _propTypes.default.string,\n  renderMarkdown: _propTypes.default.func,\n  styleSet: _propTypes.default.any,\n  suggestedActionsAccessKey: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.string]),\n  webSpeechPonyfillFactory: _propTypes.default.func\n};\n\nvar Composer = function Composer(_ref3) {\n  var activityMiddleware = _ref3.activityMiddleware,\n      activityStatusMiddleware = _ref3.activityStatusMiddleware,\n      attachmentForScreenReaderMiddleware = _ref3.attachmentForScreenReaderMiddleware,\n      attachmentMiddleware = _ref3.attachmentMiddleware,\n      avatarMiddleware = _ref3.avatarMiddleware,\n      cardActionMiddleware = _ref3.cardActionMiddleware,\n      children = _ref3.children,\n      extraStyleSet = _ref3.extraStyleSet,\n      renderMarkdown = _ref3.renderMarkdown,\n      styleSet = _ref3.styleSet,\n      suggestedActionsAccessKey = _ref3.suggestedActionsAccessKey,\n      toastMiddleware = _ref3.toastMiddleware,\n      typingIndicatorMiddleware = _ref3.typingIndicatorMiddleware,\n      webSpeechPonyfillFactory = _ref3.webSpeechPonyfillFactory,\n      composerProps = _objectWithoutProperties(_ref3, [\"activityMiddleware\", \"activityStatusMiddleware\", \"attachmentForScreenReaderMiddleware\", \"attachmentMiddleware\", \"avatarMiddleware\", \"cardActionMiddleware\", \"children\", \"extraStyleSet\", \"renderMarkdown\", \"styleSet\", \"suggestedActionsAccessKey\", \"toastMiddleware\", \"typingIndicatorMiddleware\", \"webSpeechPonyfillFactory\"]);\n\n  var nonce = composerProps.nonce,\n      onTelemetry = composerProps.onTelemetry;\n  var patchedActivityMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(activityMiddleware)), _toConsumableArray((0, _createCoreMiddleware.default)()));\n  }, [activityMiddleware]);\n  var patchedActivityStatusMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(activityStatusMiddleware)), _toConsumableArray((0, _createCoreMiddleware2.default)()));\n  }, [activityStatusMiddleware]);\n  var patchedAttachmentForScreenReaderMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(attachmentForScreenReaderMiddleware)), _toConsumableArray((0, _createCoreMiddleware3.default)()));\n  }, [attachmentForScreenReaderMiddleware]);\n  var patchedAttachmentMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(attachmentMiddleware)), _toConsumableArray((0, _createCoreMiddleware4.default)()));\n  }, [attachmentMiddleware]);\n  var patchedAvatarMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(avatarMiddleware)), _toConsumableArray((0, _createCoreMiddleware5.default)()));\n  }, [avatarMiddleware]);\n  var patchedCardActionMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(cardActionMiddleware)), _toConsumableArray((0, _createCoreMiddleware6.default)()));\n  }, [cardActionMiddleware]);\n  var patchedToastMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(toastMiddleware)), _toConsumableArray((0, _createCoreMiddleware7.default)()));\n  }, [toastMiddleware]);\n  var patchedTypingIndicatorMiddleware = (0, _react.useMemo)(function () {\n    return [].concat(_toConsumableArray((0, _singleToArray.default)(typingIndicatorMiddleware)), _toConsumableArray((0, _createCoreMiddleware8.default)()));\n  }, [typingIndicatorMiddleware]);\n  return /*#__PURE__*/_react.default.createElement(_react.default.Fragment, null, /*#__PURE__*/_react.default.createElement(_botframeworkWebchatApi.Composer, _extends({\n    activityMiddleware: patchedActivityMiddleware,\n    activityStatusMiddleware: patchedActivityStatusMiddleware,\n    attachmentForScreenReaderMiddleware: patchedAttachmentForScreenReaderMiddleware,\n    attachmentMiddleware: patchedAttachmentMiddleware,\n    avatarMiddleware: patchedAvatarMiddleware,\n    cardActionMiddleware: patchedCardActionMiddleware,\n    downscaleImageToDataURL: _downscaleImageToDataURL.default // Under dev server of create-react-app, \"NODE_ENV\" will be set to \"development\".\n    ,\n    internalErrorBoxClass: node_env === 'development' ? _ErrorBox.default : undefined,\n    nonce: nonce,\n    toastMiddleware: patchedToastMiddleware,\n    typingIndicatorMiddleware: patchedTypingIndicatorMiddleware\n  }, composerProps), /*#__PURE__*/_react.default.createElement(ComposerCore, {\n    extraStyleSet: extraStyleSet,\n    nonce: nonce,\n    renderMarkdown: renderMarkdown,\n    styleSet: styleSet,\n    suggestedActionsAccessKey: suggestedActionsAccessKey,\n    webSpeechPonyfillFactory: webSpeechPonyfillFactory\n  }, children, onTelemetry && /*#__PURE__*/_react.default.createElement(_UITracker.default, null))));\n};\n\nComposer.defaultProps = _objectSpread(_objectSpread(_objectSpread({}, _botframeworkWebchatApi.Composer.defaultProps), ComposerCore.defaultProps), {}, {\n  activityMiddleware: undefined,\n  activityRenderer: undefined,\n  activityStatusMiddleware: undefined,\n  activityStatusRenderer: undefined,\n  attachmentForScreenReaderMiddleware: undefined,\n  attachmentMiddleware: undefined,\n  attachmentRenderer: undefined,\n  avatarMiddleware: undefined,\n  avatarRenderer: undefined,\n  cardActionMiddleware: undefined,\n  children: undefined,\n  nonce: undefined,\n  renderMarkdown: undefined,\n  toastMiddleware: undefined,\n  toastRenderer: undefined,\n  typingIndicatorMiddleware: undefined,\n  typingIndicatorRenderer: undefined,\n  webSpeechPonyfillFactory: undefined\n});\nComposer.propTypes = _objectSpread(_objectSpread(_objectSpread({}, _botframeworkWebchatApi.Composer.propTypes), ComposerCore.propTypes), {}, {\n  activityMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  activityRenderer: _propTypes.default.func,\n  activityStatusMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  activityStatusRenderer: _propTypes.default.func,\n  attachmentForScreenReaderMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  attachmentMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  attachmentRenderer: _propTypes.default.func,\n  avatarMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  avatarRenderer: _propTypes.default.func,\n  cardActionMiddleware: _propTypes.default.func,\n  children: _propTypes.default.any,\n  nonce: _propTypes.default.string,\n  renderMarkdown: _propTypes.default.func,\n  toastMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  toastRenderer: _propTypes.default.func,\n  typingIndicatorMiddleware: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.func), _propTypes.default.func]),\n  typingIndicatorRenderer: _propTypes.default.func,\n  webSpeechPonyfillFactory: _propTypes.default.func\n});\nvar _default = Composer;\nexports.default = _default;","map":{"version":3,"sources":["../src/Composer.js"],"names":["useReferenceGrammarID","useStyleOptions","hooks","node_env","emotionPool","key","styleToEmotionObject","ComposerCore","children","extraStyleSet","nonce","renderMarkdown","styleSet","suggestedActionsAccessKey","webSpeechPonyfillFactory","dictateAbortable","setDictateAbortable","referenceGrammarID","styleOptions","focusSendBoxCallbacksRef","focusTranscriptCallbacksRef","internalMarkdownIt","MarkdownIt","scrollToCallbacksRef","scrollToEndCallbacksRef","scrollRelativeCallbacksRef","dictationOnError","console","internalRenderMarkdownInline","tree","patchedTree","emotion","patchedStyleSet","styleSetToEmotionObjects","webSpeechPonyfill","ponyfill","speechSynthesis","SpeechSynthesisUtterance","bypassSpeechSynthesis","BypassSpeechSynthesisUtterance","scrollPositionObserversRef","numScrollPositionObservers","setNumScrollPositionObservers","dispatchScrollPosition","observer","observeScrollPosition","target","transcriptFocusObserversRef","numTranscriptFocusObservers","setNumTranscriptFocusObservers","dispatchTranscriptFocus","observeTranscriptFocus","context","internalMarkdownItState","undefined","PropTypes","func","Composer","activityMiddleware","activityStatusMiddleware","attachmentForScreenReaderMiddleware","attachmentMiddleware","avatarMiddleware","cardActionMiddleware","toastMiddleware","typingIndicatorMiddleware","composerProps","onTelemetry","patchedActivityMiddleware","patchedActivityStatusMiddleware","patchedAttachmentForScreenReaderMiddleware","patchedAttachmentMiddleware","patchedAvatarMiddleware","patchedCardActionMiddleware","patchedToastMiddleware","patchedTypingIndicatorMiddleware","downscaleImageToDataURL","ErrorBox","APIComposer","activityRenderer","activityStatusRenderer","attachmentRenderer","avatarRenderer","toastRenderer","typingIndicatorRenderer"],"mappings":"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","sourcesContent":["import { Composer as APIComposer, hooks } from 'botframework-webchat-api';\nimport { Composer as SayComposer } from 'react-say';\nimport createEmotion from 'create-emotion';\nimport createStyleSet from './Styles/createStyleSet';\nimport MarkdownIt from 'markdown-it';\nimport PropTypes from 'prop-types';\nimport React, { useCallback, useMemo, useRef, useState } from 'react';\n\nimport {\n  speechSynthesis as bypassSpeechSynthesis,\n  SpeechSynthesisUtterance as BypassSpeechSynthesisUtterance\n} from './hooks/internal/BypassSpeechSynthesisPonyfill';\nimport addTargetBlankToHyperlinksMarkdown from './Utils/addTargetBlankToHyperlinksMarkdown';\nimport createCSSKey from './Utils/createCSSKey';\nimport createDefaultActivityMiddleware from './Middleware/Activity/createCoreMiddleware';\nimport createDefaultActivityStatusMiddleware from './Middleware/ActivityStatus/createCoreMiddleware';\nimport createDefaultAttachmentForScreenReaderMiddleware from './Middleware/AttachmentForScreenReader/createCoreMiddleware';\nimport createDefaultAttachmentMiddleware from './Middleware/Attachment/createCoreMiddleware';\nimport createDefaultAvatarMiddleware from './Middleware/Avatar/createCoreMiddleware';\nimport createDefaultCardActionMiddleware from './Middleware/CardAction/createCoreMiddleware';\nimport createDefaultToastMiddleware from './Middleware/Toast/createCoreMiddleware';\nimport createDefaultTypingIndicatorMiddleware from './Middleware/TypingIndicator/createCoreMiddleware';\nimport Dictation from './Dictation';\nimport downscaleImageToDataURL from './Utils/downscaleImageToDataURL';\nimport ErrorBox from './ErrorBox';\nimport mapMap from './Utils/mapMap';\nimport singleToArray from './Utils/singleToArray';\nimport UITracker from './hooks/internal/UITracker';\nimport WebChatUIContext from './hooks/internal/WebChatUIContext';\n\nconst { useReferenceGrammarID, useStyleOptions } = hooks;\n\n// eslint-disable-next-line no-undef\nconst node_env = process.env.node_env || process.env.NODE_ENV;\n\nconst emotionPool = {};\n\nfunction styleSetToEmotionObjects(styleToEmotionObject, styleSet) {\n  return mapMap(styleSet, (style, key) => (key === 'options' ? style : styleToEmotionObject(style)));\n}\n\nconst ComposerCore = ({\n  children,\n  extraStyleSet,\n  nonce,\n  renderMarkdown,\n  styleSet,\n  suggestedActionsAccessKey,\n  webSpeechPonyfillFactory\n}) => {\n  const [dictateAbortable, setDictateAbortable] = useState();\n  const [referenceGrammarID] = useReferenceGrammarID();\n  const [styleOptions] = useStyleOptions();\n  const focusSendBoxCallbacksRef = useRef([]);\n  const focusTranscriptCallbacksRef = useRef([]);\n  const internalMarkdownIt = useMemo(() => new MarkdownIt(), []);\n  const scrollToCallbacksRef = useRef([]);\n  const scrollToEndCallbacksRef = useRef([]);\n\n  // Instead of having a `scrollUpCallbacksRef` and `scrollDownCallbacksRef`, they are combined into a single `scrollRelativeCallbacksRef`.\n  // The first argument tells whether it should go \"up\" or \"down\".\n  const scrollRelativeCallbacksRef = useRef([]);\n\n  const dictationOnError = useCallback(err => {\n    console.error(err);\n  }, []);\n\n  const internalRenderMarkdownInline = useMemo(\n    () => markdown => {\n      const tree = internalMarkdownIt.parseInline(markdown);\n\n      // We should add rel=\"noopener noreferrer\" and target=\"_blank\"\n      const patchedTree = addTargetBlankToHyperlinksMarkdown(tree);\n\n      return internalMarkdownIt.renderer.render(patchedTree);\n    },\n    [internalMarkdownIt]\n  );\n\n  const styleToEmotionObject = useMemo(() => {\n    // Emotion doesn't hash with nonce. We need to provide the pooling mechanism.\n    // 1. If 2 instances use different nonce, they should result in different hash;\n    // 2. If 2 instances are being mounted, pooling will make sure we render only 1 set of <style> tags, instead of 2.\n    const emotion =\n      emotionPool[nonce] || (emotionPool[nonce] = createEmotion({ key: `webchat--css-${createCSSKey()}`, nonce }));\n\n    return style => emotion.css(style);\n  }, [nonce]);\n\n  const patchedStyleSet = useMemo(\n    () =>\n      styleSetToEmotionObjects(styleToEmotionObject, {\n        ...(styleSet || createStyleSet(styleOptions)),\n        ...extraStyleSet\n      }),\n    [extraStyleSet, styleOptions, styleSet, styleToEmotionObject]\n  );\n\n  const webSpeechPonyfill = useMemo(() => {\n    const ponyfill = webSpeechPonyfillFactory && webSpeechPonyfillFactory({ referenceGrammarID });\n    const { speechSynthesis, SpeechSynthesisUtterance } = ponyfill || {};\n\n    return {\n      ...ponyfill,\n      speechSynthesis: speechSynthesis || bypassSpeechSynthesis,\n      SpeechSynthesisUtterance: SpeechSynthesisUtterance || BypassSpeechSynthesisUtterance\n    };\n  }, [referenceGrammarID, webSpeechPonyfillFactory]);\n\n  const scrollPositionObserversRef = useRef([]);\n  const [numScrollPositionObservers, setNumScrollPositionObservers] = useState(0);\n\n  const dispatchScrollPosition = useCallback(\n    event => scrollPositionObserversRef.current.forEach(observer => observer(event)),\n    [scrollPositionObserversRef]\n  );\n\n  const observeScrollPosition = useCallback(\n    observer => {\n      scrollPositionObserversRef.current = [...scrollPositionObserversRef.current, observer];\n      setNumScrollPositionObservers(scrollPositionObserversRef.current.length);\n\n      return () => {\n        scrollPositionObserversRef.current = scrollPositionObserversRef.current.filter(target => target !== observer);\n        setNumScrollPositionObservers(scrollPositionObserversRef.current.length);\n      };\n    },\n    [scrollPositionObserversRef, setNumScrollPositionObservers]\n  );\n\n  const transcriptFocusObserversRef = useRef([]);\n  const [numTranscriptFocusObservers, setNumTranscriptFocusObservers] = useState(0);\n\n  const dispatchTranscriptFocus = useCallback(\n    event => transcriptFocusObserversRef.current.forEach(observer => observer(event)),\n    [transcriptFocusObserversRef]\n  );\n\n  const observeTranscriptFocus = useCallback(\n    observer => {\n      transcriptFocusObserversRef.current = [...transcriptFocusObserversRef.current, observer];\n      setNumTranscriptFocusObservers(transcriptFocusObserversRef.current.length);\n\n      return () => {\n        transcriptFocusObserversRef.current = transcriptFocusObserversRef.current.filter(target => target !== observer);\n        setNumTranscriptFocusObservers(transcriptFocusObserversRef.current.length);\n      };\n    },\n    [transcriptFocusObserversRef, setNumTranscriptFocusObservers]\n  );\n\n  const context = useMemo(\n    () => ({\n      dictateAbortable,\n      dispatchScrollPosition,\n      dispatchTranscriptFocus,\n      focusSendBoxCallbacksRef,\n      focusTranscriptCallbacksRef,\n      internalMarkdownItState: [internalMarkdownIt],\n      internalRenderMarkdownInline,\n      nonce,\n      numScrollPositionObservers,\n      numTranscriptFocusObservers,\n      observeScrollPosition,\n      observeTranscriptFocus,\n      renderMarkdown,\n      scrollRelativeCallbacksRef,\n      scrollToCallbacksRef,\n      scrollToEndCallbacksRef,\n      setDictateAbortable,\n      styleSet: patchedStyleSet,\n      styleToEmotionObject,\n      suggestedActionsAccessKey,\n      webSpeechPonyfill\n    }),\n    [\n      dictateAbortable,\n      dispatchScrollPosition,\n      dispatchTranscriptFocus,\n      focusSendBoxCallbacksRef,\n      focusTranscriptCallbacksRef,\n      internalMarkdownIt,\n      internalRenderMarkdownInline,\n      nonce,\n      numScrollPositionObservers,\n      numTranscriptFocusObservers,\n      observeScrollPosition,\n      observeTranscriptFocus,\n      patchedStyleSet,\n      renderMarkdown,\n      scrollRelativeCallbacksRef,\n      scrollToCallbacksRef,\n      scrollToEndCallbacksRef,\n      setDictateAbortable,\n      styleToEmotionObject,\n      suggestedActionsAccessKey,\n      webSpeechPonyfill\n    ]\n  );\n\n  return (\n    <SayComposer ponyfill={webSpeechPonyfill}>\n      <WebChatUIContext.Provider value={context}>\n        {children}\n        <Dictation onError={dictationOnError} />\n      </WebChatUIContext.Provider>\n    </SayComposer>\n  );\n};\n\nComposerCore.defaultProps = {\n  extraStyleSet: undefined,\n  nonce: undefined,\n  renderMarkdown: undefined,\n  styleSet: undefined,\n  suggestedActionsAccessKey: 'A a Å å',\n  webSpeechPonyfillFactory: undefined\n};\n\nComposerCore.propTypes = {\n  extraStyleSet: PropTypes.any,\n  nonce: PropTypes.string,\n  renderMarkdown: PropTypes.func,\n  styleSet: PropTypes.any,\n  suggestedActionsAccessKey: PropTypes.oneOfType([PropTypes.oneOf([false]), PropTypes.string]),\n  webSpeechPonyfillFactory: PropTypes.func\n};\n\nconst Composer = ({\n  activityMiddleware,\n  activityStatusMiddleware,\n  attachmentForScreenReaderMiddleware,\n  attachmentMiddleware,\n  avatarMiddleware,\n  cardActionMiddleware,\n  children,\n  extraStyleSet,\n  renderMarkdown,\n  styleSet,\n  suggestedActionsAccessKey,\n  toastMiddleware,\n  typingIndicatorMiddleware,\n  webSpeechPonyfillFactory,\n  ...composerProps\n}) => {\n  const { nonce, onTelemetry } = composerProps;\n\n  const patchedActivityMiddleware = useMemo(\n    () => [...singleToArray(activityMiddleware), ...createDefaultActivityMiddleware()],\n    [activityMiddleware]\n  );\n\n  const patchedActivityStatusMiddleware = useMemo(\n    () => [...singleToArray(activityStatusMiddleware), ...createDefaultActivityStatusMiddleware()],\n    [activityStatusMiddleware]\n  );\n\n  const patchedAttachmentForScreenReaderMiddleware = useMemo(\n    () => [\n      ...singleToArray(attachmentForScreenReaderMiddleware),\n      ...createDefaultAttachmentForScreenReaderMiddleware()\n    ],\n    [attachmentForScreenReaderMiddleware]\n  );\n\n  const patchedAttachmentMiddleware = useMemo(\n    () => [...singleToArray(attachmentMiddleware), ...createDefaultAttachmentMiddleware()],\n    [attachmentMiddleware]\n  );\n\n  const patchedAvatarMiddleware = useMemo(\n    () => [...singleToArray(avatarMiddleware), ...createDefaultAvatarMiddleware()],\n    [avatarMiddleware]\n  );\n\n  const patchedCardActionMiddleware = useMemo(\n    () => [...singleToArray(cardActionMiddleware), ...createDefaultCardActionMiddleware()],\n    [cardActionMiddleware]\n  );\n\n  const patchedToastMiddleware = useMemo(() => [...singleToArray(toastMiddleware), ...createDefaultToastMiddleware()], [\n    toastMiddleware\n  ]);\n\n  const patchedTypingIndicatorMiddleware = useMemo(\n    () => [...singleToArray(typingIndicatorMiddleware), ...createDefaultTypingIndicatorMiddleware()],\n    [typingIndicatorMiddleware]\n  );\n\n  return (\n    <React.Fragment>\n      <APIComposer\n        activityMiddleware={patchedActivityMiddleware}\n        activityStatusMiddleware={patchedActivityStatusMiddleware}\n        attachmentForScreenReaderMiddleware={patchedAttachmentForScreenReaderMiddleware}\n        attachmentMiddleware={patchedAttachmentMiddleware}\n        avatarMiddleware={patchedAvatarMiddleware}\n        cardActionMiddleware={patchedCardActionMiddleware}\n        downscaleImageToDataURL={downscaleImageToDataURL}\n        // Under dev server of create-react-app, \"NODE_ENV\" will be set to \"development\".\n        internalErrorBoxClass={node_env === 'development' ? ErrorBox : undefined}\n        nonce={nonce}\n        toastMiddleware={patchedToastMiddleware}\n        typingIndicatorMiddleware={patchedTypingIndicatorMiddleware}\n        {...composerProps}\n      >\n        <ComposerCore\n          extraStyleSet={extraStyleSet}\n          nonce={nonce}\n          renderMarkdown={renderMarkdown}\n          styleSet={styleSet}\n          suggestedActionsAccessKey={suggestedActionsAccessKey}\n          webSpeechPonyfillFactory={webSpeechPonyfillFactory}\n        >\n          {children}\n          {onTelemetry && <UITracker />}\n        </ComposerCore>\n      </APIComposer>\n    </React.Fragment>\n  );\n};\n\nComposer.defaultProps = {\n  ...APIComposer.defaultProps,\n  ...ComposerCore.defaultProps,\n  activityMiddleware: undefined,\n  activityRenderer: undefined,\n  activityStatusMiddleware: undefined,\n  activityStatusRenderer: undefined,\n  attachmentForScreenReaderMiddleware: undefined,\n  attachmentMiddleware: undefined,\n  attachmentRenderer: undefined,\n  avatarMiddleware: undefined,\n  avatarRenderer: undefined,\n  cardActionMiddleware: undefined,\n  children: undefined,\n  nonce: undefined,\n  renderMarkdown: undefined,\n  toastMiddleware: undefined,\n  toastRenderer: undefined,\n  typingIndicatorMiddleware: undefined,\n  typingIndicatorRenderer: undefined,\n  webSpeechPonyfillFactory: undefined\n};\n\nComposer.propTypes = {\n  ...APIComposer.propTypes,\n  ...ComposerCore.propTypes,\n  activityMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  activityRenderer: PropTypes.func,\n  activityStatusMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  activityStatusRenderer: PropTypes.func,\n  attachmentForScreenReaderMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  attachmentMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  attachmentRenderer: PropTypes.func,\n  avatarMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  avatarRenderer: PropTypes.func,\n  cardActionMiddleware: PropTypes.func,\n  children: PropTypes.any,\n  nonce: PropTypes.string,\n  renderMarkdown: PropTypes.func,\n  toastMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  toastRenderer: PropTypes.func,\n  typingIndicatorMiddleware: PropTypes.oneOfType([PropTypes.arrayOf(PropTypes.func), PropTypes.func]),\n  typingIndicatorRenderer: PropTypes.func,\n  webSpeechPonyfillFactory: PropTypes.func\n};\n\nexport default Composer;\n"],"sourceRoot":"component:///"},"metadata":{},"sourceType":"script"}